	auth-service/docs		coverage: 0.0% of statements
=== RUN   TestMain_LoadConfig_Success
--- PASS: TestMain_LoadConfig_Success (0.00s)
=== RUN   TestMain_LoadConfig_FileNotFound
--- PASS: TestMain_LoadConfig_FileNotFound (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_AllowedIP
--- PASS: TestMain_IPAllowlistMiddleware_AllowedIP (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_BlockedIP
--- PASS: TestMain_IPAllowlistMiddleware_BlockedIP (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_IPv6Allowed
--- PASS: TestMain_IPAllowlistMiddleware_IPv6Allowed (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_EmptyAllowedIPs
--- PASS: TestMain_IPAllowlistMiddleware_EmptyAllowedIPs (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_ProxyHeaders
--- PASS: TestMain_IPAllowlistMiddleware_ProxyHeaders (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_RealIPHeader
--- PASS: TestMain_IPAllowlistMiddleware_RealIPHeader (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_MultipleForwardedIPs
--- PASS: TestMain_IPAllowlistMiddleware_MultipleForwardedIPs (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_InvalidIP
--- PASS: TestMain_IPAllowlistMiddleware_InvalidIP (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_SubnetMatching
--- PASS: TestMain_IPAllowlistMiddleware_SubnetMatching (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_SubnetBlocked
--- PASS: TestMain_IPAllowlistMiddleware_SubnetBlocked (0.00s)
=== RUN   TestMain_ConfigurationValidation
--- PASS: TestMain_ConfigurationValidation (0.00s)
=== RUN   TestMain_DatabaseDSN_Generation
--- PASS: TestMain_DatabaseDSN_Generation (0.00s)
=== RUN   TestMain_RedisAddr_Generation
--- PASS: TestMain_RedisAddr_Generation (0.00s)
=== RUN   TestMain_EnvironmentVariableOverride
--- PASS: TestMain_EnvironmentVariableOverride (0.00s)
=== RUN   TestIPAllowlistMiddleware_AllowedIP
--- PASS: TestIPAllowlistMiddleware_AllowedIP (0.00s)
=== RUN   TestIPAllowlistMiddleware_AllowedIPWithPort
--- PASS: TestIPAllowlistMiddleware_AllowedIPWithPort (0.00s)
=== RUN   TestIPAllowlistMiddleware_AllowedIPSubnet
--- PASS: TestIPAllowlistMiddleware_AllowedIPSubnet (0.00s)
=== RUN   TestIPAllowlistMiddleware_DisallowedIP
--- PASS: TestIPAllowlistMiddleware_DisallowedIP (0.00s)
=== RUN   TestIPAllowlistMiddleware_EmptyAllowedIPs
--- PASS: TestIPAllowlistMiddleware_EmptyAllowedIPs (0.00s)
=== RUN   TestIPAllowlistMiddleware_NoRemoteAddr
--- PASS: TestIPAllowlistMiddleware_NoRemoteAddr (0.00s)
=== RUN   TestIPAllowlistMiddleware_IPv6Allowed
--- PASS: TestIPAllowlistMiddleware_IPv6Allowed (0.00s)
=== RUN   TestIPAllowlistMiddleware_IPv6Disallowed
--- PASS: TestIPAllowlistMiddleware_IPv6Disallowed (0.00s)
=== RUN   TestIPAllowlistMiddleware_MultipleAllowedIPs
--- PASS: TestIPAllowlistMiddleware_MultipleAllowedIPs (0.00s)
=== RUN   TestIPAllowlistMiddleware_InvalidIPFormat
--- PASS: TestIPAllowlistMiddleware_InvalidIPFormat (0.00s)
=== RUN   TestIPAllowlistMiddleware_EmptyRemoteAddr
--- PASS: TestIPAllowlistMiddleware_EmptyRemoteAddr (0.00s)
=== RUN   TestIPAllowlistMiddleware_Integration
=== RUN   TestIPAllowlistMiddleware_Integration/Allowed_IPv4
=== RUN   TestIPAllowlistMiddleware_Integration/Allowed_IPv4_Subnet
=== RUN   TestIPAllowlistMiddleware_Integration/Allowed_IPv6
=== RUN   TestIPAllowlistMiddleware_Integration/Disallowed_IPv4
=== RUN   TestIPAllowlistMiddleware_Integration/Disallowed_IPv6
=== RUN   TestIPAllowlistMiddleware_Integration/Empty_Remote_Addr
=== RUN   TestIPAllowlistMiddleware_Integration/Invalid_Format
--- PASS: TestIPAllowlistMiddleware_Integration (0.00s)
    --- PASS: TestIPAllowlistMiddleware_Integration/Allowed_IPv4 (0.00s)
    --- PASS: TestIPAllowlistMiddleware_Integration/Allowed_IPv4_Subnet (0.00s)
    --- PASS: TestIPAllowlistMiddleware_Integration/Allowed_IPv6 (0.00s)
    --- PASS: TestIPAllowlistMiddleware_Integration/Disallowed_IPv4 (0.00s)
    --- PASS: TestIPAllowlistMiddleware_Integration/Disallowed_IPv6 (0.00s)
    --- PASS: TestIPAllowlistMiddleware_Integration/Empty_Remote_Addr (0.00s)
    --- PASS: TestIPAllowlistMiddleware_Integration/Invalid_Format (0.00s)
=== RUN   TestMain_ServerSetup
{"level":"INFO","timestamp":"2025-06-25T23:44:03.755+0530","caller":"server/main_test.go:945","message":"Health check registered","name":"memory"}
{"level":"INFO","timestamp":"2025-06-25T23:44:03.755+0530","caller":"server/main_test.go:946","message":"Health check registered","name":"goroutines"}
{"level":"INFO","timestamp":"2025-06-25T23:44:03.755+0530","caller":"server/main_test.go:947","message":"Health check registered","name":"disk"}
{"level":"INFO","timestamp":"2025-06-25T23:44:03.755+0530","caller":"server/main_test.go:955","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestMain_ServerSetup (0.00s)
=== RUN   TestMain_ActuatorSetup
{"level":"INFO","timestamp":"2025-06-25T23:44:03.756+0530","caller":"server/main_test.go:1018","message":"Health check registered","name":"memory"}
{"level":"INFO","timestamp":"2025-06-25T23:44:03.756+0530","caller":"server/main_test.go:1019","message":"Health check registered","name":"goroutines"}
{"level":"INFO","timestamp":"2025-06-25T23:44:03.756+0530","caller":"server/main_test.go:1020","message":"Health check registered","name":"disk"}
{"level":"INFO","timestamp":"2025-06-25T23:44:03.756+0530","caller":"server/main_test.go:1028","message":"Actuator routes registered","base_path":"/actuator"}
{"level":"INFO","timestamp":"2025-06-25T23:44:03.756+0530","caller":"actuator/actuator.go:194","message":"Application info request received","request_id":"27e910f5d6cbdd8160aa4c829dbb7642","trace_id":"27e910f5d6cbdd8160aa4c829dbb7642","span_id":"bbe3c6cdb6cf5d58","method":"GET","path":"/actuator/info","client_ip":""}
--- PASS: TestMain_ActuatorSetup (0.00s)
=== RUN   TestMain_HandlerSetup
{"level":"INFO","timestamp":"2025-06-25T23:44:03.756+0530","caller":"rest/auth_handler.go:93","message":"Login attempt started","request_id":"36a16a868fdb1cf052b9529843b2d880","trace_id":"36a16a868fdb1cf052b9529843b2d880","span_id":"4399bc4d9ae6bbed","method":"POST","path":"/api/v1/auth/login","client_ip":"","endpoint":"/auth/login","method":"POST"}
{"level":"INFO","timestamp":"2025-06-25T23:44:03.756+0530","caller":"rest/auth_handler.go:110","message":"Login validation passed","request_id":"36a16a868fdb1cf052b9529843b2d880","trace_id":"36a16a868fdb1cf052b9529843b2d880","span_id":"4399bc4d9ae6bbed","method":"POST","path":"/api/v1/auth/login","client_ip":"","email":"test@example.com","tenant_id":"test"}
{"level":"INFO","timestamp":"2025-06-25T23:44:03.773+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"36a16a868fdb1cf052b9529843b2d880","trace_id":"36a16a868fdb1cf052b9529843b2d880","span_id":"4399bc4d9ae6bbed","method":"POST","path":"/api/v1/auth/login","client_ip":"","request_id":"36a16a868fdb1cf052b9529843b2d880","trace_id":"36a16a868fdb1cf052b9529843b2d880","span_id":"4399bc4d9ae6bbed","user_id":"user-123","tenant_id":"test","auth_method":"password","client_ip":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:03.773+0530","caller":"rest/auth_handler.go:147","message":"Business event","request_id":"36a16a868fdb1cf052b9529843b2d880","trace_id":"36a16a868fdb1cf052b9529843b2d880","span_id":"4399bc4d9ae6bbed","event_type":"user_login","user_id":"user-123","tenant_id":"test","client_ip":"","roles":["user"],"duration_ms":17,"login_method":"password"}
--- PASS: TestMain_HandlerSetup (0.02s)
=== RUN   TestMain_SwaggerSetup
--- PASS: TestMain_SwaggerSetup (0.00s)
=== RUN   TestMain_ErrorHandling
--- PASS: TestMain_ErrorHandling (0.00s)
=== RUN   TestMain_AddressGeneration
--- PASS: TestMain_AddressGeneration (0.00s)
=== RUN   TestMain_PrintfStatements
--- PASS: TestMain_PrintfStatements (0.00s)
PASS
coverage: 12.7% of statements
ok  	auth-service/cmd/server	0.352s	coverage: 12.7% of statements
=== RUN   TestNewActuator
--- PASS: TestNewActuator (0.00s)
=== RUN   TestActuator_Info
{"level":"INFO","timestamp":"2025-06-25T23:44:04.399+0530","caller":"actuator/actuator_test.go:47","message":"Actuator routes registered","base_path":"/actuator"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.399+0530","caller":"actuator/actuator.go:194","message":"Application info request received","request_id":"09937f2711a968f6be10cdaefec942dd","trace_id":"09937f2711a968f6be10cdaefec942dd","span_id":"df4e1b636df17d50","method":"GET","path":"/actuator/info","client_ip":""}
--- PASS: TestActuator_Info (0.00s)
=== RUN   TestActuator_Health
{"level":"INFO","timestamp":"2025-06-25T23:44:04.399+0530","caller":"actuator/actuator_test.go:70","message":"Actuator routes registered","base_path":"/actuator"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.399+0530","caller":"actuator/actuator.go:157","message":"Health check request received","request_id":"65084f0a9cbb4072fc4c58e994c63d6e","trace_id":"65084f0a9cbb4072fc4c58e994c63d6e","span_id":"3dadeebaa779fe04","method":"GET","path":"/actuator/health","client_ip":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.399+0530","caller":"actuator/actuator.go:162","message":"Business event","request_id":"65084f0a9cbb4072fc4c58e994c63d6e","trace_id":"65084f0a9cbb4072fc4c58e994c63d6e","span_id":"3dadeebaa779fe04","event_type":"health_check","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/health"}
--- PASS: TestActuator_Health (0.00s)
=== RUN   TestActuator_Liveness
{"level":"INFO","timestamp":"2025-06-25T23:44:04.399+0530","caller":"actuator/actuator_test.go:84","message":"Actuator routes registered","base_path":"/actuator"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.399+0530","caller":"actuator/actuator.go:170","message":"Liveness check request received","request_id":"b1409194673a4d2c1115b26e84662c7d","trace_id":"b1409194673a4d2c1115b26e84662c7d","span_id":"717f84aba44ff5f9","method":"GET","path":"/actuator/health/live","client_ip":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.399+0530","caller":"actuator/actuator.go:174","message":"Business event","request_id":"b1409194673a4d2c1115b26e84662c7d","trace_id":"b1409194673a4d2c1115b26e84662c7d","span_id":"717f84aba44ff5f9","event_type":"liveness_check","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/health/live"}
--- PASS: TestActuator_Liveness (0.00s)
=== RUN   TestActuator_Readiness
{"level":"INFO","timestamp":"2025-06-25T23:44:04.400+0530","caller":"actuator/actuator_test.go:98","message":"Actuator routes registered","base_path":"/actuator"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.400+0530","caller":"actuator/actuator.go:182","message":"Readiness check request received","request_id":"ce1312f1c43f79e7638c8e20f089f55e","trace_id":"ce1312f1c43f79e7638c8e20f089f55e","span_id":"6af3ccb808a05ede","method":"GET","path":"/actuator/health/ready","client_ip":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.400+0530","caller":"actuator/actuator.go:186","message":"Business event","request_id":"ce1312f1c43f79e7638c8e20f089f55e","trace_id":"ce1312f1c43f79e7638c8e20f089f55e","span_id":"6af3ccb808a05ede","event_type":"readiness_check","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/health/ready"}
--- PASS: TestActuator_Readiness (0.00s)
=== RUN   TestActuator_Environment
{"level":"INFO","timestamp":"2025-06-25T23:44:04.400+0530","caller":"actuator/actuator_test.go:112","message":"Actuator routes registered","base_path":"/actuator"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.400+0530","caller":"actuator/actuator.go:202","message":"Environment info request received","request_id":"1b0aefd6fbfb752466e3432ad3e8287d","trace_id":"1b0aefd6fbfb752466e3432ad3e8287d","span_id":"59a7ca2021af86a1","method":"GET","path":"/actuator/env","client_ip":""}
--- PASS: TestActuator_Environment (0.00s)
=== RUN   TestActuator_Metrics
{"level":"INFO","timestamp":"2025-06-25T23:44:04.400+0530","caller":"actuator/actuator_test.go:136","message":"Actuator routes registered","base_path":"/actuator"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.400+0530","caller":"actuator/actuator.go:220","message":"Metrics request received","request_id":"a208ad3dc68d6a5f2b7238585781370e","trace_id":"a208ad3dc68d6a5f2b7238585781370e","span_id":"be01aaa07c39b9b0","method":"GET","path":"/actuator/metrics","client_ip":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.400+0530","caller":"actuator/actuator.go:230","message":"Business event","request_id":"a208ad3dc68d6a5f2b7238585781370e","trace_id":"a208ad3dc68d6a5f2b7238585781370e","span_id":"be01aaa07c39b9b0","event_type":"metrics_request","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/metrics"}
--- PASS: TestActuator_Metrics (0.00s)
=== RUN   TestActuator_PrometheusMetrics
{"level":"INFO","timestamp":"2025-06-25T23:44:04.400+0530","caller":"actuator/actuator_test.go:160","message":"Actuator routes registered","base_path":"/actuator"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.400+0530","caller":"actuator/actuator.go:240","message":"Prometheus metrics request received","request_id":"c1a329bf0507b63b54b74d96d8393901","trace_id":"c1a329bf0507b63b54b74d96d8393901","span_id":"1ea528152e134e42","method":"GET","path":"/actuator/prometheus","client_ip":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.400+0530","caller":"actuator/actuator.go:245","message":"Business event","request_id":"c1a329bf0507b63b54b74d96d8393901","trace_id":"c1a329bf0507b63b54b74d96d8393901","span_id":"1ea528152e134e42","event_type":"prometheus_metrics_request","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/prometheus"}
--- PASS: TestActuator_PrometheusMetrics (0.00s)
=== RUN   TestActuator_Status
{"level":"INFO","timestamp":"2025-06-25T23:44:04.400+0530","caller":"actuator/actuator_test.go:175","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_Status (0.00s)
=== RUN   TestActuator_Uptime
{"level":"INFO","timestamp":"2025-06-25T23:44:04.400+0530","caller":"actuator/actuator_test.go:201","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_Uptime (0.00s)
=== RUN   TestActuator_ThreadDump
{"level":"INFO","timestamp":"2025-06-25T23:44:04.400+0530","caller":"actuator/actuator_test.go:224","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_ThreadDump (0.00s)
=== RUN   TestActuator_HeapDump
{"level":"INFO","timestamp":"2025-06-25T23:44:04.400+0530","caller":"actuator/actuator_test.go:246","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_HeapDump (0.00s)
=== RUN   TestActuator_Mappings
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator_test.go:275","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_Mappings (0.00s)
=== RUN   TestActuator_Loggers
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator_test.go:308","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_Loggers (0.00s)
=== RUN   TestActuator_SetLoggerLevel
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator_test.go:329","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_SetLoggerLevel (0.00s)
=== RUN   TestActuator_RecordRequest
--- PASS: TestActuator_RecordRequest (0.00s)
=== RUN   TestActuator_StartEndRequest
--- PASS: TestActuator_StartEndRequest (0.00s)
=== RUN   TestActuator_GetMemoryStats
--- PASS: TestActuator_GetMemoryStats (0.00s)
=== RUN   TestActuator_GetRuntimeStats
--- PASS: TestActuator_GetRuntimeStats (0.00s)
=== RUN   TestActuator_GetRequestStats
--- PASS: TestActuator_GetRequestStats (0.00s)
=== RUN   TestActuator_RegisterHealthCheck
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator_test.go:416","message":"Health check registered","name":"test-check"}
--- PASS: TestActuator_RegisterHealthCheck (0.00s)
=== RUN   TestActuator_RegisterReadinessCheck
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator_test.go:429","message":"Readiness check registered","name":"test-readiness"}
--- PASS: TestActuator_RegisterReadinessCheck (0.00s)
=== RUN   TestActuator_ConfigProps
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator_test.go:452","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_ConfigProps (0.00s)
=== RUN   TestActuator_SetLoggerLevel_Success
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator_test.go:478","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_SetLoggerLevel_Success (0.00s)
=== RUN   TestActuator_SetLoggerLevel_InvalidJSON
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator_test.go:502","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_SetLoggerLevel_InvalidJSON (0.00s)
=== RUN   TestActuator_SetLoggerLevel_EmptyBody
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator_test.go:524","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_SetLoggerLevel_EmptyBody (0.00s)
=== RUN   TestActuator_RegisterRoutes_AllEndpoints
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator_test.go:546","message":"Actuator routes registered","base_path":"/actuator"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator.go:157","message":"Health check request received","request_id":"f560d5528e3a2d7604bc93c43048faa7","trace_id":"f560d5528e3a2d7604bc93c43048faa7","span_id":"e7b49c6519e80605","method":"GET","path":"/actuator/health","client_ip":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator.go:162","message":"Business event","request_id":"f560d5528e3a2d7604bc93c43048faa7","trace_id":"f560d5528e3a2d7604bc93c43048faa7","span_id":"e7b49c6519e80605","event_type":"health_check","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/health"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator.go:170","message":"Liveness check request received","request_id":"5671b8e80c31f7861b14582a92efe1f2","trace_id":"5671b8e80c31f7861b14582a92efe1f2","span_id":"cd545abd505e3e49","method":"GET","path":"/actuator/health/live","client_ip":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator.go:174","message":"Business event","request_id":"5671b8e80c31f7861b14582a92efe1f2","trace_id":"5671b8e80c31f7861b14582a92efe1f2","span_id":"cd545abd505e3e49","event_type":"liveness_check","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/health/live"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator.go:182","message":"Readiness check request received","request_id":"eb546ea52de7a5f6319bf9a94f4ba54d","trace_id":"eb546ea52de7a5f6319bf9a94f4ba54d","span_id":"a9cd060b4b9e7ee6","method":"GET","path":"/actuator/health/ready","client_ip":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator.go:186","message":"Business event","request_id":"eb546ea52de7a5f6319bf9a94f4ba54d","trace_id":"eb546ea52de7a5f6319bf9a94f4ba54d","span_id":"a9cd060b4b9e7ee6","event_type":"readiness_check","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/health/ready"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator.go:194","message":"Application info request received","request_id":"238422f69d7442984b466eed10960d59","trace_id":"238422f69d7442984b466eed10960d59","span_id":"2698105e317182db","method":"GET","path":"/actuator/info","client_ip":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator.go:202","message":"Environment info request received","request_id":"8b757822bec9584e89a5ed0bb003c13b","trace_id":"8b757822bec9584e89a5ed0bb003c13b","span_id":"4f04987deb051f5a","method":"GET","path":"/actuator/env","client_ip":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator.go:220","message":"Metrics request received","request_id":"c3c1678ee34ffad5462c0bf7c5f30a10","trace_id":"c3c1678ee34ffad5462c0bf7c5f30a10","span_id":"41938791a948220b","method":"GET","path":"/actuator/metrics","client_ip":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator.go:230","message":"Business event","request_id":"c3c1678ee34ffad5462c0bf7c5f30a10","trace_id":"c3c1678ee34ffad5462c0bf7c5f30a10","span_id":"41938791a948220b","event_type":"metrics_request","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/metrics"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator.go:240","message":"Prometheus metrics request received","request_id":"8c553d1211a9cc704c1b1e729598fe3d","trace_id":"8c553d1211a9cc704c1b1e729598fe3d","span_id":"8dc37e858091f964","method":"GET","path":"/actuator/prometheus","client_ip":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.401+0530","caller":"actuator/actuator.go:245","message":"Business event","request_id":"8c553d1211a9cc704c1b1e729598fe3d","trace_id":"8c553d1211a9cc704c1b1e729598fe3d","span_id":"8dc37e858091f964","event_type":"prometheus_metrics_request","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/prometheus"}
--- PASS: TestActuator_RegisterRoutes_AllEndpoints (0.00s)
=== RUN   TestActuator_RecordRequest_WithMetrics
--- PASS: TestActuator_RecordRequest_WithMetrics (0.00s)
=== RUN   TestActuator_AppInfo_WithProperties
--- PASS: TestActuator_AppInfo_WithProperties (0.00s)
=== RUN   TestActuator_NewActuator_WithNilAppInfo
--- PASS: TestActuator_NewActuator_WithNilAppInfo (0.00s)
=== RUN   TestActuator_GetMemoryStats_Detailed
--- PASS: TestActuator_GetMemoryStats_Detailed (0.00s)
=== RUN   TestActuator_GetRuntimeStats_Detailed
--- PASS: TestActuator_GetRuntimeStats_Detailed (0.00s)
=== RUN   TestActuator_GetRequestStats_Detailed
--- PASS: TestActuator_GetRequestStats_Detailed (0.00s)
=== RUN   TestDatabaseHealthCheck_Success
--- PASS: TestDatabaseHealthCheck_Success (0.00s)
=== RUN   TestDatabaseHealthCheck_WithTimeout
--- PASS: TestDatabaseHealthCheck_WithTimeout (0.00s)
=== RUN   TestRedisHealthCheck_Success
--- PASS: TestRedisHealthCheck_Success (0.00s)
=== RUN   TestRedisHealthCheck_WithNilClient
--- PASS: TestRedisHealthCheck_WithNilClient (0.00s)
=== RUN   TestDiskSpaceHealthCheck_Success
--- PASS: TestDiskSpaceHealthCheck_Success (0.00s)
=== RUN   TestDiskSpaceHealthCheck_WithZeroSpace
--- PASS: TestDiskSpaceHealthCheck_WithZeroSpace (0.00s)
=== RUN   TestDiskSpaceHealthCheck_WithNegativeSpace
--- PASS: TestDiskSpaceHealthCheck_WithNegativeSpace (0.00s)
=== RUN   TestMemoryHealthCheck_Success
--- PASS: TestMemoryHealthCheck_Success (0.00s)
=== RUN   TestMemoryHealthCheck_WithLowThreshold
--- PASS: TestMemoryHealthCheck_WithLowThreshold (0.00s)
=== RUN   TestMemoryHealthCheck_WithZeroThreshold
--- PASS: TestMemoryHealthCheck_WithZeroThreshold (0.00s)
=== RUN   TestMemoryHealthCheck_WithNegativeThreshold
--- PASS: TestMemoryHealthCheck_WithNegativeThreshold (0.00s)
=== RUN   TestGoroutineHealthCheck_Success
--- PASS: TestGoroutineHealthCheck_Success (0.00s)
=== RUN   TestGoroutineHealthCheck_WithLowThreshold
--- PASS: TestGoroutineHealthCheck_WithLowThreshold (0.00s)
=== RUN   TestGoroutineHealthCheck_WithZeroThreshold
--- PASS: TestGoroutineHealthCheck_WithZeroThreshold (0.00s)
=== RUN   TestGoroutineHealthCheck_WithNegativeThreshold
--- PASS: TestGoroutineHealthCheck_WithNegativeThreshold (0.00s)
=== RUN   TestCustomHealthCheck_Success
--- PASS: TestCustomHealthCheck_Success (0.00s)
=== RUN   TestCustomHealthCheck_WithError
--- PASS: TestCustomHealthCheck_WithError (0.00s)
=== RUN   TestCustomHealthCheck_WithNilFunction
--- PASS: TestCustomHealthCheck_WithNilFunction (0.00s)
=== RUN   TestTimeoutHealthCheck_Success
--- PASS: TestTimeoutHealthCheck_Success (0.01s)
=== RUN   TestTimeoutHealthCheck_WithError
--- PASS: TestTimeoutHealthCheck_WithError (0.01s)
=== RUN   TestTimeoutHealthCheck_WithTimeout
--- PASS: TestTimeoutHealthCheck_WithTimeout (0.05s)
=== RUN   TestTimeoutHealthCheck_WithZeroTimeout
--- PASS: TestTimeoutHealthCheck_WithZeroTimeout (0.00s)
=== RUN   TestTimeoutHealthCheck_WithNegativeTimeout
--- PASS: TestTimeoutHealthCheck_WithNegativeTimeout (0.00s)
=== RUN   TestTimeoutHealthCheck_WithNilCheck
--- PASS: TestTimeoutHealthCheck_WithNilCheck (0.00s)
=== RUN   TestMemoryHealthCheck_Calculation
--- PASS: TestMemoryHealthCheck_Calculation (0.00s)
=== RUN   TestHealthCheck_Integration
=== RUN   TestHealthCheck_Integration/memory
=== RUN   TestHealthCheck_Integration/goroutines
=== RUN   TestHealthCheck_Integration/disk
=== RUN   TestHealthCheck_Integration/redis
=== RUN   TestHealthCheck_Integration/custom
--- PASS: TestHealthCheck_Integration (0.00s)
    --- PASS: TestHealthCheck_Integration/memory (0.00s)
    --- PASS: TestHealthCheck_Integration/goroutines (0.00s)
    --- PASS: TestHealthCheck_Integration/disk (0.00s)
    --- PASS: TestHealthCheck_Integration/redis (0.00s)
    --- PASS: TestHealthCheck_Integration/custom (0.00s)
PASS
coverage: 96.7% of statements
ok  	auth-service/internal/actuator	1.057s	coverage: 96.7% of statements
=== RUN   TestLoadConfig_Success
--- PASS: TestLoadConfig_Success (0.00s)
=== RUN   TestLoadConfig_FileNotFound
--- PASS: TestLoadConfig_FileNotFound (0.00s)
=== RUN   TestLoadConfig_InvalidYAML
--- PASS: TestLoadConfig_InvalidYAML (0.00s)
=== RUN   TestLoadConfig_WithEnvironmentVariables
--- PASS: TestLoadConfig_WithEnvironmentVariables (0.00s)
=== RUN   TestLoadConfig_DefaultValues
--- PASS: TestLoadConfig_DefaultValues (0.00s)
=== RUN   TestDatabaseConfig_GetDSN
--- PASS: TestDatabaseConfig_GetDSN (0.00s)
=== RUN   TestDatabaseConfig_GetDSN_WithSSL
--- PASS: TestDatabaseConfig_GetDSN_WithSSL (0.00s)
=== RUN   TestRedisConfig_GetRedisAddr
--- PASS: TestRedisConfig_GetRedisAddr (0.00s)
=== RUN   TestRedisConfig_GetRedisAddr_CustomHost
--- PASS: TestRedisConfig_GetRedisAddr_CustomHost (0.00s)
=== RUN   TestConfig_Validation
--- PASS: TestConfig_Validation (0.00s)
=== RUN   TestConfig_CompleteConfiguration
--- PASS: TestConfig_CompleteConfiguration (0.00s)
=== RUN   TestLoadConfig_WithAllEnvironmentVariables
--- PASS: TestLoadConfig_WithAllEnvironmentVariables (0.00s)
=== RUN   TestLoadConfig_WithInvalidEnvironmentVariables
--- PASS: TestLoadConfig_WithInvalidEnvironmentVariables (0.00s)
=== RUN   TestLoadConfig_WithZeroEnvironmentVariables
--- PASS: TestLoadConfig_WithZeroEnvironmentVariables (0.00s)
=== RUN   TestDatabaseConfig_GetDSN_WithAllFields
--- PASS: TestDatabaseConfig_GetDSN_WithAllFields (0.00s)
=== RUN   TestRedisConfig_GetRedisAddr_WithPassword
--- PASS: TestRedisConfig_GetRedisAddr_WithPassword (0.00s)
=== RUN   TestRedisConfig_GetRedisAddr_WithCustomPort
--- PASS: TestRedisConfig_GetRedisAddr_WithCustomPort (0.00s)
=== RUN   TestConfig_DefaultValues_Comprehensive
--- PASS: TestConfig_DefaultValues_Comprehensive (0.00s)
PASS
coverage: 90.2% of statements
ok  	auth-service/internal/config	1.154s	coverage: 90.2% of statements
=== RUN   TestAuthHandler_Login_Success
{"level":"INFO","timestamp":"2025-06-25T23:44:03.985+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"a425427bb084b1f9659fc9e07c27713b","trace_id":"a425427bb084b1f9659fc9e07c27713b","span_id":"444289f1819a95c0","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"a425427bb084b1f9659fc9e07c27713b","trace_id":"a425427bb084b1f9659fc9e07c27713b","span_id":"444289f1819a95c0","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:03.985+0530","caller":"rest/auth_handler.go:93","message":"Login attempt started","request_id":"a425427bb084b1f9659fc9e07c27713b","trace_id":"a425427bb084b1f9659fc9e07c27713b","span_id":"444289f1819a95c0","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","endpoint":"/auth/login","method":"POST"}
{"level":"INFO","timestamp":"2025-06-25T23:44:03.986+0530","caller":"rest/auth_handler.go:110","message":"Login validation passed","request_id":"a425427bb084b1f9659fc9e07c27713b","trace_id":"a425427bb084b1f9659fc9e07c27713b","span_id":"444289f1819a95c0","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","email":"test@example.com","tenant_id":"tenant-123"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.002+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"a425427bb084b1f9659fc9e07c27713b","trace_id":"a425427bb084b1f9659fc9e07c27713b","span_id":"444289f1819a95c0","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"a425427bb084b1f9659fc9e07c27713b","trace_id":"a425427bb084b1f9659fc9e07c27713b","span_id":"444289f1819a95c0","user_id":"user-123","tenant_id":"tenant-123","auth_method":"password","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.002+0530","caller":"rest/auth_handler.go:147","message":"Business event","request_id":"a425427bb084b1f9659fc9e07c27713b","trace_id":"a425427bb084b1f9659fc9e07c27713b","span_id":"444289f1819a95c0","event_type":"user_login","user_id":"user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","duration_ms":16,"login_method":"password","roles":["user"]}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.002+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"a425427bb084b1f9659fc9e07c27713b","trace_id":"a425427bb084b1f9659fc9e07c27713b","span_id":"444289f1819a95c0","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"a425427bb084b1f9659fc9e07c27713b","trace_id":"a425427bb084b1f9659fc9e07c27713b","span_id":"444289f1819a95c0","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.017252333}
--- PASS: TestAuthHandler_Login_Success (0.02s)
=== RUN   TestAuthHandler_Login_InvalidEmail
{"level":"INFO","timestamp":"2025-06-25T23:44:04.003+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"5c3161335722ebfa819e348ff48dbcf1","trace_id":"5c3161335722ebfa819e348ff48dbcf1","span_id":"8bdf6d8d6d719d65","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"5c3161335722ebfa819e348ff48dbcf1","trace_id":"5c3161335722ebfa819e348ff48dbcf1","span_id":"8bdf6d8d6d719d65","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.003+0530","caller":"rest/auth_handler.go:93","message":"Login attempt started","request_id":"5c3161335722ebfa819e348ff48dbcf1","trace_id":"5c3161335722ebfa819e348ff48dbcf1","span_id":"8bdf6d8d6d719d65","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","endpoint":"/auth/login","method":"POST"}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.003+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"5c3161335722ebfa819e348ff48dbcf1","trace_id":"5c3161335722ebfa819e348ff48dbcf1","span_id":"8bdf6d8d6d719d65","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"5c3161335722ebfa819e348ff48dbcf1","trace_id":"5c3161335722ebfa819e348ff48dbcf1","span_id":"8bdf6d8d6d719d65","user_id":"","tenant_id":"tenant-123","auth_method":"password","reason":"validation_error","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:100\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidEmail.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidEmail\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:134\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.003+0530","caller":"rest/auth_handler.go:101","message":"Login validation failed","request_id":"5c3161335722ebfa819e348ff48dbcf1","trace_id":"5c3161335722ebfa819e348ff48dbcf1","span_id":"8bdf6d8d6d719d65","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","error":"Key: 'LoginRequest.Email' Error:Field validation for 'Email' failed on the 'email' tag","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:101\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidEmail.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidEmail\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:134\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.003+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"5c3161335722ebfa819e348ff48dbcf1","trace_id":"5c3161335722ebfa819e348ff48dbcf1","span_id":"8bdf6d8d6d719d65","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"5c3161335722ebfa819e348ff48dbcf1","trace_id":"5c3161335722ebfa819e348ff48dbcf1","span_id":"8bdf6d8d6d719d65","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000176375}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.003+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"5c3161335722ebfa819e348ff48dbcf1","trace_id":"5c3161335722ebfa819e348ff48dbcf1","span_id":"8bdf6d8d6d719d65","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":75,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Login_InvalidEmail.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidEmail\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:134\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_Login_InvalidEmail (0.00s)
=== RUN   TestAuthHandler_Login_MissingFields
{"level":"INFO","timestamp":"2025-06-25T23:44:04.003+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"17c8d3e20aa06ba0d31202433fa2ed4e","trace_id":"17c8d3e20aa06ba0d31202433fa2ed4e","span_id":"e564fdf29a164a0a","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"17c8d3e20aa06ba0d31202433fa2ed4e","trace_id":"17c8d3e20aa06ba0d31202433fa2ed4e","span_id":"e564fdf29a164a0a","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.003+0530","caller":"rest/auth_handler.go:93","message":"Login attempt started","request_id":"17c8d3e20aa06ba0d31202433fa2ed4e","trace_id":"17c8d3e20aa06ba0d31202433fa2ed4e","span_id":"e564fdf29a164a0a","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","endpoint":"/auth/login","method":"POST"}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.003+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"17c8d3e20aa06ba0d31202433fa2ed4e","trace_id":"17c8d3e20aa06ba0d31202433fa2ed4e","span_id":"e564fdf29a164a0a","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"17c8d3e20aa06ba0d31202433fa2ed4e","trace_id":"17c8d3e20aa06ba0d31202433fa2ed4e","span_id":"e564fdf29a164a0a","user_id":"","tenant_id":"","auth_method":"password","reason":"validation_error","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:100\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_MissingFields.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_MissingFields\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:171\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.003+0530","caller":"rest/auth_handler.go:101","message":"Login validation failed","request_id":"17c8d3e20aa06ba0d31202433fa2ed4e","trace_id":"17c8d3e20aa06ba0d31202433fa2ed4e","span_id":"e564fdf29a164a0a","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","error":"Key: 'LoginRequest.Password' Error:Field validation for 'Password' failed on the 'required' tag\nKey: 'LoginRequest.TenantID' Error:Field validation for 'TenantID' failed on the 'required' tag","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:101\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_MissingFields.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_MissingFields\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:171\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.003+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"17c8d3e20aa06ba0d31202433fa2ed4e","trace_id":"17c8d3e20aa06ba0d31202433fa2ed4e","span_id":"e564fdf29a164a0a","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"17c8d3e20aa06ba0d31202433fa2ed4e","trace_id":"17c8d3e20aa06ba0d31202433fa2ed4e","span_id":"e564fdf29a164a0a","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000051542}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.003+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"17c8d3e20aa06ba0d31202433fa2ed4e","trace_id":"17c8d3e20aa06ba0d31202433fa2ed4e","span_id":"e564fdf29a164a0a","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":28,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Login_MissingFields.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_MissingFields\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:171\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_Login_MissingFields (0.00s)
=== RUN   TestAuthHandler_Register_Success
{"level":"INFO","timestamp":"2025-06-25T23:44:04.003+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"944665e771d5bcaf057e3cdd78d16634","trace_id":"944665e771d5bcaf057e3cdd78d16634","span_id":"21de672dc9980ee5","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"944665e771d5bcaf057e3cdd78d16634","trace_id":"944665e771d5bcaf057e3cdd78d16634","span_id":"21de672dc9980ee5","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.003+0530","caller":"rest/auth_handler.go:193","message":"Registration attempt started","request_id":"944665e771d5bcaf057e3cdd78d16634","trace_id":"944665e771d5bcaf057e3cdd78d16634","span_id":"21de672dc9980ee5","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","endpoint":"/auth/register","method":"POST"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.003+0530","caller":"rest/auth_handler.go:209","message":"Registration validation passed","request_id":"944665e771d5bcaf057e3cdd78d16634","trace_id":"944665e771d5bcaf057e3cdd78d16634","span_id":"21de672dc9980ee5","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","email":"newuser@example.com","tenant_id":"tenant-123","first_name":"John","last_name":"Doe"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.040+0530","caller":"rest/auth_handler.go:238","message":"Business event","request_id":"944665e771d5bcaf057e3cdd78d16634","trace_id":"944665e771d5bcaf057e3cdd78d16634","span_id":"21de672dc9980ee5","event_type":"user_registration","user_id":"user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","duration_ms":37,"email":"newuser@example.com","first_name":"John","last_name":"Doe"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.040+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"944665e771d5bcaf057e3cdd78d16634","trace_id":"944665e771d5bcaf057e3cdd78d16634","span_id":"21de672dc9980ee5","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"944665e771d5bcaf057e3cdd78d16634","trace_id":"944665e771d5bcaf057e3cdd78d16634","span_id":"21de672dc9980ee5","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":201,"duration":0.037166333}
--- PASS: TestAuthHandler_Register_Success (0.04s)
=== RUN   TestAuthHandler_Register_InvalidEmail
{"level":"INFO","timestamp":"2025-06-25T23:44:04.040+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"4084b47ad0dd52cac4ddf094df6ca2fe","trace_id":"4084b47ad0dd52cac4ddf094df6ca2fe","span_id":"d9cf46a6596a8188","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"4084b47ad0dd52cac4ddf094df6ca2fe","trace_id":"4084b47ad0dd52cac4ddf094df6ca2fe","span_id":"d9cf46a6596a8188","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.040+0530","caller":"rest/auth_handler.go:193","message":"Registration attempt started","request_id":"4084b47ad0dd52cac4ddf094df6ca2fe","trace_id":"4084b47ad0dd52cac4ddf094df6ca2fe","span_id":"d9cf46a6596a8188","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","endpoint":"/auth/register","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.040+0530","caller":"rest/auth_handler.go:200","message":"Registration validation failed","request_id":"4084b47ad0dd52cac4ddf094df6ca2fe","trace_id":"4084b47ad0dd52cac4ddf094df6ca2fe","span_id":"d9cf46a6596a8188","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","error":"Key: 'RegisterRequest.Email' Error:Field validation for 'Email' failed on the 'email' tag","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Register\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:200\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Register_InvalidEmail.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Register_InvalidEmail\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:252\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.040+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"4084b47ad0dd52cac4ddf094df6ca2fe","trace_id":"4084b47ad0dd52cac4ddf094df6ca2fe","span_id":"d9cf46a6596a8188","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"4084b47ad0dd52cac4ddf094df6ca2fe","trace_id":"4084b47ad0dd52cac4ddf094df6ca2fe","span_id":"d9cf46a6596a8188","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.00006425}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.040+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"4084b47ad0dd52cac4ddf094df6ca2fe","trace_id":"4084b47ad0dd52cac4ddf094df6ca2fe","span_id":"d9cf46a6596a8188","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":113,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Register_InvalidEmail.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Register_InvalidEmail\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:252\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_Register_InvalidEmail (0.00s)
=== RUN   TestAuthHandler_Register_MissingFields
{"level":"INFO","timestamp":"2025-06-25T23:44:04.040+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"5db753d3949ceb71798a76ef8407f27d","trace_id":"5db753d3949ceb71798a76ef8407f27d","span_id":"d96e81d0a9465bb4","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"5db753d3949ceb71798a76ef8407f27d","trace_id":"5db753d3949ceb71798a76ef8407f27d","span_id":"d96e81d0a9465bb4","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.040+0530","caller":"rest/auth_handler.go:193","message":"Registration attempt started","request_id":"5db753d3949ceb71798a76ef8407f27d","trace_id":"5db753d3949ceb71798a76ef8407f27d","span_id":"d96e81d0a9465bb4","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","endpoint":"/auth/register","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.040+0530","caller":"rest/auth_handler.go:200","message":"Registration validation failed","request_id":"5db753d3949ceb71798a76ef8407f27d","trace_id":"5db753d3949ceb71798a76ef8407f27d","span_id":"d96e81d0a9465bb4","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","error":"Key: 'RegisterRequest.Password' Error:Field validation for 'Password' failed on the 'required' tag\nKey: 'RegisterRequest.TenantID' Error:Field validation for 'TenantID' failed on the 'required' tag\nKey: 'RegisterRequest.FirstName' Error:Field validation for 'FirstName' failed on the 'required' tag\nKey: 'RegisterRequest.LastName' Error:Field validation for 'LastName' failed on the 'required' tag","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Register\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:200\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Register_MissingFields.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Register_MissingFields\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:289\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.040+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"5db753d3949ceb71798a76ef8407f27d","trace_id":"5db753d3949ceb71798a76ef8407f27d","span_id":"d96e81d0a9465bb4","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"5db753d3949ceb71798a76ef8407f27d","trace_id":"5db753d3949ceb71798a76ef8407f27d","span_id":"d96e81d0a9465bb4","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.00004225}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.040+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"5db753d3949ceb71798a76ef8407f27d","trace_id":"5db753d3949ceb71798a76ef8407f27d","span_id":"d96e81d0a9465bb4","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":28,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Register_MissingFields.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Register_MissingFields\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:289\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_Register_MissingFields (0.00s)
=== RUN   TestAuthHandler_RefreshToken_Success
{"level":"INFO","timestamp":"2025-06-25T23:44:04.040+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"c859f78455c00b321de6cda00b6b6ae7","trace_id":"c859f78455c00b321de6cda00b6b6ae7","span_id":"270c66650e264afb","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"c859f78455c00b321de6cda00b6b6ae7","trace_id":"c859f78455c00b321de6cda00b6b6ae7","span_id":"270c66650e264afb","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.040+0530","caller":"rest/auth_handler.go:281","message":"Token refresh attempt started","request_id":"c859f78455c00b321de6cda00b6b6ae7","trace_id":"c859f78455c00b321de6cda00b6b6ae7","span_id":"270c66650e264afb","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/auth/refresh","method":"POST"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.040+0530","caller":"rest/auth_handler.go:297","message":"Token refresh validation passed","request_id":"c859f78455c00b321de6cda00b6b6ae7","trace_id":"c859f78455c00b321de6cda00b6b6ae7","span_id":"270c66650e264afb","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","refresh_token_prefix":"valid-refr..."}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.046+0530","caller":"rest/auth_handler.go:324","message":"Business event","request_id":"c859f78455c00b321de6cda00b6b6ae7","trace_id":"c859f78455c00b321de6cda00b6b6ae7","span_id":"270c66650e264afb","event_type":"token_refresh","user_id":"user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","duration_ms":5}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.046+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"c859f78455c00b321de6cda00b6b6ae7","trace_id":"c859f78455c00b321de6cda00b6b6ae7","span_id":"270c66650e264afb","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"c859f78455c00b321de6cda00b6b6ae7","trace_id":"c859f78455c00b321de6cda00b6b6ae7","span_id":"270c66650e264afb","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.005749167}
--- PASS: TestAuthHandler_RefreshToken_Success (0.01s)
=== RUN   TestAuthHandler_RefreshToken_MissingToken
{"level":"INFO","timestamp":"2025-06-25T23:44:04.046+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"9c92afb6c1e791a10f5584db1a560d2f","trace_id":"9c92afb6c1e791a10f5584db1a560d2f","span_id":"d3ca640422497ca8","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"9c92afb6c1e791a10f5584db1a560d2f","trace_id":"9c92afb6c1e791a10f5584db1a560d2f","span_id":"d3ca640422497ca8","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.046+0530","caller":"rest/auth_handler.go:281","message":"Token refresh attempt started","request_id":"9c92afb6c1e791a10f5584db1a560d2f","trace_id":"9c92afb6c1e791a10f5584db1a560d2f","span_id":"d3ca640422497ca8","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/auth/refresh","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.046+0530","caller":"rest/auth_handler.go:288","message":"Token refresh validation failed","request_id":"9c92afb6c1e791a10f5584db1a560d2f","trace_id":"9c92afb6c1e791a10f5584db1a560d2f","span_id":"d3ca640422497ca8","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","error":"Key: 'RefreshTokenRequest.RefreshToken' Error:Field validation for 'RefreshToken' failed on the 'required' tag","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).RefreshToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:288\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_RefreshToken_MissingToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_RefreshToken_MissingToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:362\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.046+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"9c92afb6c1e791a10f5584db1a560d2f","trace_id":"9c92afb6c1e791a10f5584db1a560d2f","span_id":"d3ca640422497ca8","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"9c92afb6c1e791a10f5584db1a560d2f","trace_id":"9c92afb6c1e791a10f5584db1a560d2f","span_id":"d3ca640422497ca8","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000059291}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.046+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"9c92afb6c1e791a10f5584db1a560d2f","trace_id":"9c92afb6c1e791a10f5584db1a560d2f","span_id":"d3ca640422497ca8","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":2,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_RefreshToken_MissingToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_RefreshToken_MissingToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:362\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_RefreshToken_MissingToken (0.00s)
=== RUN   TestAuthHandler_Logout_Success
{"level":"INFO","timestamp":"2025-06-25T23:44:04.046+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"8dec28495bd452a9f6225f42538ae39c","trace_id":"8dec28495bd452a9f6225f42538ae39c","span_id":"44a53ec67a475a6a","method":"POST","path":"/logout","client_ip":"192.0.2.1:1234","request_id":"8dec28495bd452a9f6225f42538ae39c","trace_id":"8dec28495bd452a9f6225f42538ae39c","span_id":"44a53ec67a475a6a","parent_span_id":"","method":"POST","path":"/logout","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.046+0530","caller":"rest/auth_handler.go:358","message":"Logout attempt started","request_id":"8dec28495bd452a9f6225f42538ae39c","trace_id":"8dec28495bd452a9f6225f42538ae39c","span_id":"44a53ec67a475a6a","method":"POST","path":"/logout","client_ip":"192.0.2.1:1234","endpoint":"/auth/logout","method":"POST"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.057+0530","caller":"rest/auth_handler.go:371","message":"Business event","request_id":"8dec28495bd452a9f6225f42538ae39c","trace_id":"8dec28495bd452a9f6225f42538ae39c","span_id":"44a53ec67a475a6a","event_type":"user_logout","user_id":"user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","duration_ms":11}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.057+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"8dec28495bd452a9f6225f42538ae39c","trace_id":"8dec28495bd452a9f6225f42538ae39c","span_id":"44a53ec67a475a6a","method":"POST","path":"/logout","client_ip":"192.0.2.1:1234","request_id":"8dec28495bd452a9f6225f42538ae39c","trace_id":"8dec28495bd452a9f6225f42538ae39c","span_id":"44a53ec67a475a6a","parent_span_id":"","method":"POST","path":"/logout","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.011072625}
--- PASS: TestAuthHandler_Logout_Success (0.01s)
=== RUN   TestAuthHandler_Login_InvalidJSON
{"level":"INFO","timestamp":"2025-06-25T23:44:04.057+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"8cb728bec9effe47efa14f0bfa9a8a15","trace_id":"8cb728bec9effe47efa14f0bfa9a8a15","span_id":"b378a79450538e98","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"8cb728bec9effe47efa14f0bfa9a8a15","trace_id":"8cb728bec9effe47efa14f0bfa9a8a15","span_id":"b378a79450538e98","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.057+0530","caller":"rest/auth_handler.go:93","message":"Login attempt started","request_id":"8cb728bec9effe47efa14f0bfa9a8a15","trace_id":"8cb728bec9effe47efa14f0bfa9a8a15","span_id":"b378a79450538e98","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","endpoint":"/auth/login","method":"POST"}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.057+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"8cb728bec9effe47efa14f0bfa9a8a15","trace_id":"8cb728bec9effe47efa14f0bfa9a8a15","span_id":"b378a79450538e98","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"8cb728bec9effe47efa14f0bfa9a8a15","trace_id":"8cb728bec9effe47efa14f0bfa9a8a15","span_id":"b378a79450538e98","user_id":"","tenant_id":"","auth_method":"password","reason":"validation_error","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:100\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:421\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.057+0530","caller":"rest/auth_handler.go:101","message":"Login validation failed","request_id":"8cb728bec9effe47efa14f0bfa9a8a15","trace_id":"8cb728bec9effe47efa14f0bfa9a8a15","span_id":"b378a79450538e98","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","error":"unexpected EOF","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:101\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:421\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.057+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"8cb728bec9effe47efa14f0bfa9a8a15","trace_id":"8cb728bec9effe47efa14f0bfa9a8a15","span_id":"b378a79450538e98","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"8cb728bec9effe47efa14f0bfa9a8a15","trace_id":"8cb728bec9effe47efa14f0bfa9a8a15","span_id":"b378a79450538e98","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000058917}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.057+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"8cb728bec9effe47efa14f0bfa9a8a15","trace_id":"8cb728bec9effe47efa14f0bfa9a8a15","span_id":"b378a79450538e98","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":82,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Login_InvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:421\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_Login_InvalidJSON (0.00s)
=== RUN   TestAuthHandler_Register_EmptyPassword
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"2635f84d3ba77f414a39dd45f97c4410","trace_id":"2635f84d3ba77f414a39dd45f97c4410","span_id":"396a70860ab54365","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"2635f84d3ba77f414a39dd45f97c4410","trace_id":"2635f84d3ba77f414a39dd45f97c4410","span_id":"396a70860ab54365","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"rest/auth_handler.go:193","message":"Registration attempt started","request_id":"2635f84d3ba77f414a39dd45f97c4410","trace_id":"2635f84d3ba77f414a39dd45f97c4410","span_id":"396a70860ab54365","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","endpoint":"/auth/register","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.058+0530","caller":"rest/auth_handler.go:200","message":"Registration validation failed","request_id":"2635f84d3ba77f414a39dd45f97c4410","trace_id":"2635f84d3ba77f414a39dd45f97c4410","span_id":"396a70860ab54365","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","error":"Key: 'RegisterRequest.Password' Error:Field validation for 'Password' failed on the 'required' tag","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Register\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:200\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Register_EmptyPassword.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Register_EmptyPassword\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:460\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"2635f84d3ba77f414a39dd45f97c4410","trace_id":"2635f84d3ba77f414a39dd45f97c4410","span_id":"396a70860ab54365","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"2635f84d3ba77f414a39dd45f97c4410","trace_id":"2635f84d3ba77f414a39dd45f97c4410","span_id":"396a70860ab54365","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000033}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.058+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"2635f84d3ba77f414a39dd45f97c4410","trace_id":"2635f84d3ba77f414a39dd45f97c4410","span_id":"396a70860ab54365","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":105,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Register_EmptyPassword.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Register_EmptyPassword\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:460\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_Register_EmptyPassword (0.00s)
=== RUN   TestAuthHandler_NewAuthHandler
--- PASS: TestAuthHandler_NewAuthHandler (0.00s)
=== RUN   TestOAuthHandler_GoogleLogin_Success
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"f44777fa1f9658f13b47853920b6c07d","trace_id":"f44777fa1f9658f13b47853920b6c07d","span_id":"e88b8f1cb08ab27e","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"f44777fa1f9658f13b47853920b6c07d","trace_id":"f44777fa1f9658f13b47853920b6c07d","span_id":"e88b8f1cb08ab27e","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"rest/oauth_handler.go:65","message":"Google OAuth login initiated","request_id":"f44777fa1f9658f13b47853920b6c07d","trace_id":"f44777fa1f9658f13b47853920b6c07d","span_id":"e88b8f1cb08ab27e","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/login","method":"GET"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"rest/oauth_handler.go:84","message":"Google OAuth login validation passed","request_id":"f44777fa1f9658f13b47853920b6c07d","trace_id":"f44777fa1f9658f13b47853920b6c07d","span_id":"e88b8f1cb08ab27e","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","tenant_id":"tenant-123","redirect_uri":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"f44777fa1f9658f13b47853920b6c07d","trace_id":"f44777fa1f9658f13b47853920b6c07d","span_id":"e88b8f1cb08ab27e","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"f44777fa1f9658f13b47853920b6c07d","trace_id":"f44777fa1f9658f13b47853920b6c07d","span_id":"e88b8f1cb08ab27e","provider":"google","step":"login_initiated","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"rest/oauth_handler.go:101","message":"Business event","request_id":"f44777fa1f9658f13b47853920b6c07d","trace_id":"f44777fa1f9658f13b47853920b6c07d","span_id":"e88b8f1cb08ab27e","event_type":"oauth_login_initiated","user_id":"","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","provider":"google","redirect_uri":"http://localhost:8080/api/v1/oauth/google/callback","duration_ms":0}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"f44777fa1f9658f13b47853920b6c07d","trace_id":"f44777fa1f9658f13b47853920b6c07d","span_id":"e88b8f1cb08ab27e","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"f44777fa1f9658f13b47853920b6c07d","trace_id":"f44777fa1f9658f13b47853920b6c07d","span_id":"e88b8f1cb08ab27e","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.000061916}
--- PASS: TestOAuthHandler_GoogleLogin_Success (0.00s)
=== RUN   TestOAuthHandler_GoogleLogin_WithCustomRedirectURI
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"47cf3e18ca82a0234e262154a6975ef8","trace_id":"47cf3e18ca82a0234e262154a6975ef8","span_id":"2198e87e8cd73320","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"47cf3e18ca82a0234e262154a6975ef8","trace_id":"47cf3e18ca82a0234e262154a6975ef8","span_id":"2198e87e8cd73320","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"rest/oauth_handler.go:65","message":"Google OAuth login initiated","request_id":"47cf3e18ca82a0234e262154a6975ef8","trace_id":"47cf3e18ca82a0234e262154a6975ef8","span_id":"2198e87e8cd73320","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/login","method":"GET"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"rest/oauth_handler.go:84","message":"Google OAuth login validation passed","request_id":"47cf3e18ca82a0234e262154a6975ef8","trace_id":"47cf3e18ca82a0234e262154a6975ef8","span_id":"2198e87e8cd73320","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","tenant_id":"tenant-123","redirect_uri":"https://custom.example.com/callback"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"47cf3e18ca82a0234e262154a6975ef8","trace_id":"47cf3e18ca82a0234e262154a6975ef8","span_id":"2198e87e8cd73320","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"47cf3e18ca82a0234e262154a6975ef8","trace_id":"47cf3e18ca82a0234e262154a6975ef8","span_id":"2198e87e8cd73320","provider":"google","step":"login_initiated","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"rest/oauth_handler.go:101","message":"Business event","request_id":"47cf3e18ca82a0234e262154a6975ef8","trace_id":"47cf3e18ca82a0234e262154a6975ef8","span_id":"2198e87e8cd73320","event_type":"oauth_login_initiated","user_id":"","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","duration_ms":0,"provider":"google","redirect_uri":"https://custom.example.com/callback"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"47cf3e18ca82a0234e262154a6975ef8","trace_id":"47cf3e18ca82a0234e262154a6975ef8","span_id":"2198e87e8cd73320","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"47cf3e18ca82a0234e262154a6975ef8","trace_id":"47cf3e18ca82a0234e262154a6975ef8","span_id":"2198e87e8cd73320","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.000039917}
--- PASS: TestOAuthHandler_GoogleLogin_WithCustomRedirectURI (0.00s)
=== RUN   TestOAuthHandler_GoogleLogin_MissingTenantID
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"53a29b69a8e1102e6570bf35367523aa","trace_id":"53a29b69a8e1102e6570bf35367523aa","span_id":"8934144df940a63d","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"53a29b69a8e1102e6570bf35367523aa","trace_id":"53a29b69a8e1102e6570bf35367523aa","span_id":"8934144df940a63d","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"rest/oauth_handler.go:65","message":"Google OAuth login initiated","request_id":"53a29b69a8e1102e6570bf35367523aa","trace_id":"53a29b69a8e1102e6570bf35367523aa","span_id":"8934144df940a63d","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/login","method":"GET"}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.058+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"53a29b69a8e1102e6570bf35367523aa","trace_id":"53a29b69a8e1102e6570bf35367523aa","span_id":"8934144df940a63d","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"53a29b69a8e1102e6570bf35367523aa","trace_id":"53a29b69a8e1102e6570bf35367523aa","span_id":"8934144df940a63d","user_id":"","tenant_id":"","auth_method":"google_oauth","reason":"missing_tenant_id","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).GoogleLogin\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:74\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleLogin_MissingTenantID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleLogin_MissingTenantID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:115\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.058+0530","caller":"rest/oauth_handler.go:75","message":"Google OAuth login failed - missing tenant ID","request_id":"53a29b69a8e1102e6570bf35367523aa","trace_id":"53a29b69a8e1102e6570bf35367523aa","span_id":"8934144df940a63d","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).GoogleLogin\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:75\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleLogin_MissingTenantID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleLogin_MissingTenantID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:115\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"53a29b69a8e1102e6570bf35367523aa","trace_id":"53a29b69a8e1102e6570bf35367523aa","span_id":"8934144df940a63d","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"53a29b69a8e1102e6570bf35367523aa","trace_id":"53a29b69a8e1102e6570bf35367523aa","span_id":"8934144df940a63d","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000034583}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.058+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"53a29b69a8e1102e6570bf35367523aa","trace_id":"53a29b69a8e1102e6570bf35367523aa","span_id":"8934144df940a63d","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_GoogleLogin_MissingTenantID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleLogin_MissingTenantID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:115\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_GoogleLogin_MissingTenantID (0.00s)
=== RUN   TestOAuthHandler_GoogleCallback_Success
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"907f950c861882cc22da72d9c7014ea9","trace_id":"907f950c861882cc22da72d9c7014ea9","span_id":"3c6fb5b13fd60dcd","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"907f950c861882cc22da72d9c7014ea9","trace_id":"907f950c861882cc22da72d9c7014ea9","span_id":"3c6fb5b13fd60dcd","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"907f950c861882cc22da72d9c7014ea9","trace_id":"907f950c861882cc22da72d9c7014ea9","span_id":"3c6fb5b13fd60dcd","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.058+0530","caller":"rest/oauth_handler.go:174","message":"Google OAuth callback validation passed","request_id":"907f950c861882cc22da72d9c7014ea9","trace_id":"907f950c861882cc22da72d9c7014ea9","span_id":"3c6fb5b13fd60dcd","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","tenant_id":"tenant-123","code_prefix":"test-auth-..."}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.109+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"907f950c861882cc22da72d9c7014ea9","trace_id":"907f950c861882cc22da72d9c7014ea9","span_id":"3c6fb5b13fd60dcd","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"907f950c861882cc22da72d9c7014ea9","trace_id":"907f950c861882cc22da72d9c7014ea9","span_id":"3c6fb5b13fd60dcd","user_id":"google-user-123","tenant_id":"tenant-123","auth_method":"google_oauth","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.109+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"907f950c861882cc22da72d9c7014ea9","trace_id":"907f950c861882cc22da72d9c7014ea9","span_id":"3c6fb5b13fd60dcd","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"907f950c861882cc22da72d9c7014ea9","trace_id":"907f950c861882cc22da72d9c7014ea9","span_id":"3c6fb5b13fd60dcd","provider":"google","step":"callback_success","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.109+0530","caller":"rest/oauth_handler.go:209","message":"Business event","request_id":"907f950c861882cc22da72d9c7014ea9","trace_id":"907f950c861882cc22da72d9c7014ea9","span_id":"3c6fb5b13fd60dcd","event_type":"oauth_login_completed","user_id":"google-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","provider":"google","duration_ms":51}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.109+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"907f950c861882cc22da72d9c7014ea9","trace_id":"907f950c861882cc22da72d9c7014ea9","span_id":"3c6fb5b13fd60dcd","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"907f950c861882cc22da72d9c7014ea9","trace_id":"907f950c861882cc22da72d9c7014ea9","span_id":"3c6fb5b13fd60dcd","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.051092792}
--- PASS: TestOAuthHandler_GoogleCallback_Success (0.05s)
=== RUN   TestOAuthHandler_GoogleCallback_MissingCode
{"level":"INFO","timestamp":"2025-06-25T23:44:04.109+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"a0b8f2b414c09442134dcea90a7bbe2a","trace_id":"a0b8f2b414c09442134dcea90a7bbe2a","span_id":"de98a0c55c27fc36","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"a0b8f2b414c09442134dcea90a7bbe2a","trace_id":"a0b8f2b414c09442134dcea90a7bbe2a","span_id":"de98a0c55c27fc36","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.109+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"a0b8f2b414c09442134dcea90a7bbe2a","trace_id":"a0b8f2b414c09442134dcea90a7bbe2a","span_id":"de98a0c55c27fc36","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.109+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"a0b8f2b414c09442134dcea90a7bbe2a","trace_id":"a0b8f2b414c09442134dcea90a7bbe2a","span_id":"de98a0c55c27fc36","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"a0b8f2b414c09442134dcea90a7bbe2a","trace_id":"a0b8f2b414c09442134dcea90a7bbe2a","span_id":"de98a0c55c27fc36","user_id":"","tenant_id":"tenant-123","auth_method":"google_oauth","reason":"missing_code","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).GoogleCallback\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:164\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_MissingCode.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_MissingCode\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:171\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.109+0530","caller":"rest/oauth_handler.go:165","message":"Google OAuth callback failed - missing authorization code","request_id":"a0b8f2b414c09442134dcea90a7bbe2a","trace_id":"a0b8f2b414c09442134dcea90a7bbe2a","span_id":"de98a0c55c27fc36","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).GoogleCallback\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:165\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_MissingCode.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_MissingCode\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:171\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.109+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"a0b8f2b414c09442134dcea90a7bbe2a","trace_id":"a0b8f2b414c09442134dcea90a7bbe2a","span_id":"de98a0c55c27fc36","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"a0b8f2b414c09442134dcea90a7bbe2a","trace_id":"a0b8f2b414c09442134dcea90a7bbe2a","span_id":"de98a0c55c27fc36","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000060042}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.109+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"a0b8f2b414c09442134dcea90a7bbe2a","trace_id":"a0b8f2b414c09442134dcea90a7bbe2a","span_id":"de98a0c55c27fc36","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_MissingCode.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_MissingCode\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:171\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_GoogleCallback_MissingCode (0.00s)
=== RUN   TestOAuthHandler_GoogleCallback_OAuthError
{"level":"INFO","timestamp":"2025-06-25T23:44:04.109+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"146eb05cb8334b369bda31f9f2ca023b","trace_id":"146eb05cb8334b369bda31f9f2ca023b","span_id":"15b5b51923f2538c","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"146eb05cb8334b369bda31f9f2ca023b","trace_id":"146eb05cb8334b369bda31f9f2ca023b","span_id":"15b5b51923f2538c","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.109+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"146eb05cb8334b369bda31f9f2ca023b","trace_id":"146eb05cb8334b369bda31f9f2ca023b","span_id":"15b5b51923f2538c","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.109+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"146eb05cb8334b369bda31f9f2ca023b","trace_id":"146eb05cb8334b369bda31f9f2ca023b","span_id":"15b5b51923f2538c","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"146eb05cb8334b369bda31f9f2ca023b","trace_id":"146eb05cb8334b369bda31f9f2ca023b","span_id":"15b5b51923f2538c","user_id":"","tenant_id":"tenant-123","auth_method":"google_oauth","reason":"oauth_error","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).GoogleCallback\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:153\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_OAuthError.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_OAuthError\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:197\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.109+0530","caller":"logger/logger.go:225","message":"OAuth flow failed","request_id":"146eb05cb8334b369bda31f9f2ca023b","trace_id":"146eb05cb8334b369bda31f9f2ca023b","span_id":"15b5b51923f2538c","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"146eb05cb8334b369bda31f9f2ca023b","trace_id":"146eb05cb8334b369bda31f9f2ca023b","span_id":"15b5b51923f2538c","provider":"google","step":"callback_error","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","error":"oauth error: access_denied","stacktrace":"auth-service/internal/logger.(*RequestLogger).OAuthFlow\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:225\nauth-service/internal/handler/rest.(*OAuthHandler).GoogleCallback\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:154\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_OAuthError.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_OAuthError\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:197\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.109+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"146eb05cb8334b369bda31f9f2ca023b","trace_id":"146eb05cb8334b369bda31f9f2ca023b","span_id":"15b5b51923f2538c","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"146eb05cb8334b369bda31f9f2ca023b","trace_id":"146eb05cb8334b369bda31f9f2ca023b","span_id":"15b5b51923f2538c","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000038333}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.109+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"146eb05cb8334b369bda31f9f2ca023b","trace_id":"146eb05cb8334b369bda31f9f2ca023b","span_id":"15b5b51923f2538c","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_OAuthError.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_OAuthError\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:197\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_GoogleCallback_OAuthError (0.00s)
=== RUN   TestOAuthHandler_ClientCredentials_Success
{"level":"INFO","timestamp":"2025-06-25T23:44:04.109+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"595d21b3b9e1ac9d988f2106ebafcb62","trace_id":"595d21b3b9e1ac9d988f2106ebafcb62","span_id":"fbd9a76d455a5319","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"595d21b3b9e1ac9d988f2106ebafcb62","trace_id":"595d21b3b9e1ac9d988f2106ebafcb62","span_id":"fbd9a76d455a5319","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.109+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"595d21b3b9e1ac9d988f2106ebafcb62","trace_id":"595d21b3b9e1ac9d988f2106ebafcb62","span_id":"fbd9a76d455a5319","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.109+0530","caller":"rest/oauth_handler.go:277","message":"Client credentials validation passed","request_id":"595d21b3b9e1ac9d988f2106ebafcb62","trace_id":"595d21b3b9e1ac9d988f2106ebafcb62","span_id":"fbd9a76d455a5319","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","client_id":"service-client-123","grant_type":"client_credentials","scope":"read:users write:users"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.130+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"595d21b3b9e1ac9d988f2106ebafcb62","trace_id":"595d21b3b9e1ac9d988f2106ebafcb62","span_id":"fbd9a76d455a5319","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"595d21b3b9e1ac9d988f2106ebafcb62","trace_id":"595d21b3b9e1ac9d988f2106ebafcb62","span_id":"fbd9a76d455a5319","user_id":"service-client-123","tenant_id":"","auth_method":"client_credentials","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.130+0530","caller":"rest/oauth_handler.go:310","message":"Business event","request_id":"595d21b3b9e1ac9d988f2106ebafcb62","trace_id":"595d21b3b9e1ac9d988f2106ebafcb62","span_id":"fbd9a76d455a5319","event_type":"client_credentials_success","user_id":"service-client-123","tenant_id":"","client_ip":"192.0.2.1:1234","scope":"read:users write:users","duration_ms":21}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.130+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"595d21b3b9e1ac9d988f2106ebafcb62","trace_id":"595d21b3b9e1ac9d988f2106ebafcb62","span_id":"fbd9a76d455a5319","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"595d21b3b9e1ac9d988f2106ebafcb62","trace_id":"595d21b3b9e1ac9d988f2106ebafcb62","span_id":"fbd9a76d455a5319","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.021077541}
--- PASS: TestOAuthHandler_ClientCredentials_Success (0.02s)
=== RUN   TestOAuthHandler_ClientCredentials_UnsupportedGrantType
{"level":"INFO","timestamp":"2025-06-25T23:44:04.130+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"f659d332b022b35b05703eec678a92d6","trace_id":"f659d332b022b35b05703eec678a92d6","span_id":"fc37a284e2a22d38","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"f659d332b022b35b05703eec678a92d6","trace_id":"f659d332b022b35b05703eec678a92d6","span_id":"fc37a284e2a22d38","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.130+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"f659d332b022b35b05703eec678a92d6","trace_id":"f659d332b022b35b05703eec678a92d6","span_id":"fc37a284e2a22d38","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.130+0530","caller":"rest/oauth_handler.go:277","message":"Client credentials validation passed","request_id":"f659d332b022b35b05703eec678a92d6","trace_id":"f659d332b022b35b05703eec678a92d6","span_id":"fc37a284e2a22d38","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","client_id":"service-client-123","grant_type":"authorization_code","scope":"read:users write:users"}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.130+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"f659d332b022b35b05703eec678a92d6","trace_id":"f659d332b022b35b05703eec678a92d6","span_id":"fc37a284e2a22d38","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"f659d332b022b35b05703eec678a92d6","trace_id":"f659d332b022b35b05703eec678a92d6","span_id":"fc37a284e2a22d38","user_id":"service-client-123","tenant_id":"","auth_method":"client_credentials","reason":"unsupported_grant_type","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).ClientCredentials\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:284\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_UnsupportedGrantType.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_UnsupportedGrantType\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:273\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.130+0530","caller":"rest/oauth_handler.go:285","message":"Unsupported grant type","request_id":"f659d332b022b35b05703eec678a92d6","trace_id":"f659d332b022b35b05703eec678a92d6","span_id":"fc37a284e2a22d38","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","grant_type":"authorization_code","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).ClientCredentials\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:285\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_UnsupportedGrantType.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_UnsupportedGrantType\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:273\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.130+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"f659d332b022b35b05703eec678a92d6","trace_id":"f659d332b022b35b05703eec678a92d6","span_id":"fc37a284e2a22d38","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"f659d332b022b35b05703eec678a92d6","trace_id":"f659d332b022b35b05703eec678a92d6","span_id":"fc37a284e2a22d38","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000069375}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.130+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"f659d332b022b35b05703eec678a92d6","trace_id":"f659d332b022b35b05703eec678a92d6","span_id":"fc37a284e2a22d38","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":138,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_UnsupportedGrantType.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_UnsupportedGrantType\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:273\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_ClientCredentials_UnsupportedGrantType (0.00s)
=== RUN   TestOAuthHandler_ClientCredentials_InvalidJSON
{"level":"INFO","timestamp":"2025-06-25T23:44:04.131+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"bdd51c43dfc39a469aa86e5e99c1a871","trace_id":"bdd51c43dfc39a469aa86e5e99c1a871","span_id":"91d8743f6d91aff3","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"bdd51c43dfc39a469aa86e5e99c1a871","trace_id":"bdd51c43dfc39a469aa86e5e99c1a871","span_id":"91d8743f6d91aff3","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.131+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"bdd51c43dfc39a469aa86e5e99c1a871","trace_id":"bdd51c43dfc39a469aa86e5e99c1a871","span_id":"91d8743f6d91aff3","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.131+0530","caller":"rest/oauth_handler.go:268","message":"Client credentials validation failed","request_id":"bdd51c43dfc39a469aa86e5e99c1a871","trace_id":"bdd51c43dfc39a469aa86e5e99c1a871","span_id":"91d8743f6d91aff3","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","error":"unexpected EOF","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).ClientCredentials\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:268\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_InvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_InvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:303\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.131+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"bdd51c43dfc39a469aa86e5e99c1a871","trace_id":"bdd51c43dfc39a469aa86e5e99c1a871","span_id":"91d8743f6d91aff3","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"bdd51c43dfc39a469aa86e5e99c1a871","trace_id":"bdd51c43dfc39a469aa86e5e99c1a871","span_id":"91d8743f6d91aff3","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000033875}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.131+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"bdd51c43dfc39a469aa86e5e99c1a871","trace_id":"bdd51c43dfc39a469aa86e5e99c1a871","span_id":"91d8743f6d91aff3","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":70,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_InvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_InvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:303\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_ClientCredentials_InvalidJSON (0.00s)
=== RUN   TestOAuthHandler_CreateOneTimeToken_Success
{"level":"INFO","timestamp":"2025-06-25T23:44:04.131+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"09f359427511368f89856c4db65b3490","trace_id":"09f359427511368f89856c4db65b3490","span_id":"44bfd96f0e7be91f","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"09f359427511368f89856c4db65b3490","trace_id":"09f359427511368f89856c4db65b3490","span_id":"44bfd96f0e7be91f","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.131+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"09f359427511368f89856c4db65b3490","trace_id":"09f359427511368f89856c4db65b3490","span_id":"44bfd96f0e7be91f","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.131+0530","caller":"rest/oauth_handler.go:380","message":"One-time token validation passed","request_id":"09f359427511368f89856c4db65b3490","trace_id":"09f359427511368f89856c4db65b3490","span_id":"44bfd96f0e7be91f","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","url":"https://app.example.com/survey/123","session_id":"survey-session-456","expires_in":3600,"max_uses":1}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.147+0530","caller":"rest/oauth_handler.go:421","message":"Business event","request_id":"09f359427511368f89856c4db65b3490","trace_id":"09f359427511368f89856c4db65b3490","span_id":"44bfd96f0e7be91f","event_type":"one_time_token_created","user_id":"","tenant_id":"","client_ip":"192.0.2.1:1234","duration_ms":16,"session_id":"survey-session-456","expires_in":3600,"max_uses":1}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.147+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"09f359427511368f89856c4db65b3490","trace_id":"09f359427511368f89856c4db65b3490","span_id":"44bfd96f0e7be91f","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"09f359427511368f89856c4db65b3490","trace_id":"09f359427511368f89856c4db65b3490","span_id":"44bfd96f0e7be91f","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":201,"duration":0.016122875}
--- PASS: TestOAuthHandler_CreateOneTimeToken_Success (0.02s)
=== RUN   TestOAuthHandler_CreateOneTimeToken_MissingURL
{"level":"INFO","timestamp":"2025-06-25T23:44:04.147+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"b0fefbee81c34bc662a4f18ee7414e19","trace_id":"b0fefbee81c34bc662a4f18ee7414e19","span_id":"07a2b10076600ba4","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"b0fefbee81c34bc662a4f18ee7414e19","trace_id":"b0fefbee81c34bc662a4f18ee7414e19","span_id":"07a2b10076600ba4","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.147+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"b0fefbee81c34bc662a4f18ee7414e19","trace_id":"b0fefbee81c34bc662a4f18ee7414e19","span_id":"07a2b10076600ba4","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.147+0530","caller":"rest/oauth_handler.go:371","message":"One-time token validation failed","request_id":"b0fefbee81c34bc662a4f18ee7414e19","trace_id":"b0fefbee81c34bc662a4f18ee7414e19","span_id":"07a2b10076600ba4","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","error":"Key: 'OneTimeTokenRequest.URL' Error:Field validation for 'URL' failed on the 'required' tag","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).CreateOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:371\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_MissingURL.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_MissingURL\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:385\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.147+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"b0fefbee81c34bc662a4f18ee7414e19","trace_id":"b0fefbee81c34bc662a4f18ee7414e19","span_id":"07a2b10076600ba4","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"b0fefbee81c34bc662a4f18ee7414e19","trace_id":"b0fefbee81c34bc662a4f18ee7414e19","span_id":"07a2b10076600ba4","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000041625}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.147+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"b0fefbee81c34bc662a4f18ee7414e19","trace_id":"b0fefbee81c34bc662a4f18ee7414e19","span_id":"07a2b10076600ba4","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":87,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_MissingURL.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_MissingURL\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:385\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_CreateOneTimeToken_MissingURL (0.00s)
=== RUN   TestOAuthHandler_VerifyOneTimeToken_Success
{"level":"INFO","timestamp":"2025-06-25T23:44:04.147+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"ecd28bd46cb84de98b953321a38d3779","trace_id":"ecd28bd46cb84de98b953321a38d3779","span_id":"c79f28685da782e3","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"ecd28bd46cb84de98b953321a38d3779","trace_id":"ecd28bd46cb84de98b953321a38d3779","span_id":"c79f28685da782e3","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.147+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"ecd28bd46cb84de98b953321a38d3779","trace_id":"ecd28bd46cb84de98b953321a38d3779","span_id":"c79f28685da782e3","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.147+0530","caller":"rest/oauth_handler.go:488","message":"One-time token verification validation passed","request_id":"ecd28bd46cb84de98b953321a38d3779","trace_id":"ecd28bd46cb84de98b953321a38d3779","span_id":"c79f28685da782e3","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","token_prefix":"one-time-t...","session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.158+0530","caller":"rest/oauth_handler.go:542","message":"Business event","request_id":"ecd28bd46cb84de98b953321a38d3779","trace_id":"ecd28bd46cb84de98b953321a38d3779","span_id":"c79f28685da782e3","event_type":"one_time_token_verified","user_id":"anonymous-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","is_valid":true,"duration_ms":11,"session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.158+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"ecd28bd46cb84de98b953321a38d3779","trace_id":"ecd28bd46cb84de98b953321a38d3779","span_id":"c79f28685da782e3","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"ecd28bd46cb84de98b953321a38d3779","trace_id":"ecd28bd46cb84de98b953321a38d3779","span_id":"c79f28685da782e3","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.01109075}
--- PASS: TestOAuthHandler_VerifyOneTimeToken_Success (0.01s)
=== RUN   TestOAuthHandler_VerifyOneTimeToken_MissingToken
{"level":"INFO","timestamp":"2025-06-25T23:44:04.158+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"adf86f8c8efba47f5aef6ce1ce321cf4","trace_id":"adf86f8c8efba47f5aef6ce1ce321cf4","span_id":"9903a446041068ca","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"adf86f8c8efba47f5aef6ce1ce321cf4","trace_id":"adf86f8c8efba47f5aef6ce1ce321cf4","span_id":"9903a446041068ca","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.158+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"adf86f8c8efba47f5aef6ce1ce321cf4","trace_id":"adf86f8c8efba47f5aef6ce1ce321cf4","span_id":"9903a446041068ca","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.158+0530","caller":"rest/oauth_handler.go:469","message":"One-time token verification failed - missing token","request_id":"adf86f8c8efba47f5aef6ce1ce321cf4","trace_id":"adf86f8c8efba47f5aef6ce1ce321cf4","span_id":"9903a446041068ca","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).VerifyOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:469\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_MissingToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_MissingToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:440\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.158+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"adf86f8c8efba47f5aef6ce1ce321cf4","trace_id":"adf86f8c8efba47f5aef6ce1ce321cf4","span_id":"9903a446041068ca","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"adf86f8c8efba47f5aef6ce1ce321cf4","trace_id":"adf86f8c8efba47f5aef6ce1ce321cf4","span_id":"9903a446041068ca","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000053916}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.158+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"adf86f8c8efba47f5aef6ce1ce321cf4","trace_id":"adf86f8c8efba47f5aef6ce1ce321cf4","span_id":"9903a446041068ca","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_MissingToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_MissingToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:440\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_VerifyOneTimeToken_MissingToken (0.00s)
=== RUN   TestOAuthHandler_VerifyOneTimeToken_InvalidToken
{"level":"INFO","timestamp":"2025-06-25T23:44:04.158+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"1eda528c8c95ddbf984067d0355a7708","trace_id":"1eda528c8c95ddbf984067d0355a7708","span_id":"405c7d21a5bda7e5","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"1eda528c8c95ddbf984067d0355a7708","trace_id":"1eda528c8c95ddbf984067d0355a7708","span_id":"405c7d21a5bda7e5","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.158+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"1eda528c8c95ddbf984067d0355a7708","trace_id":"1eda528c8c95ddbf984067d0355a7708","span_id":"405c7d21a5bda7e5","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.158+0530","caller":"rest/oauth_handler.go:488","message":"One-time token verification validation passed","request_id":"1eda528c8c95ddbf984067d0355a7708","trace_id":"1eda528c8c95ddbf984067d0355a7708","span_id":"405c7d21a5bda7e5","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","token_prefix":"invalid-to...","session_id":"session-123"}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.169+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"1eda528c8c95ddbf984067d0355a7708","trace_id":"1eda528c8c95ddbf984067d0355a7708","span_id":"405c7d21a5bda7e5","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"1eda528c8c95ddbf984067d0355a7708","trace_id":"1eda528c8c95ddbf984067d0355a7708","span_id":"405c7d21a5bda7e5","user_id":"","tenant_id":"","auth_method":"one_time_token","reason":"invalid_token","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).VerifyOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:513\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_InvalidToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_InvalidToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:466\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.169+0530","caller":"rest/oauth_handler.go:514","message":"One-time token verification failed - invalid token or session","request_id":"1eda528c8c95ddbf984067d0355a7708","trace_id":"1eda528c8c95ddbf984067d0355a7708","span_id":"405c7d21a5bda7e5","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).VerifyOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:514\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_InvalidToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_InvalidToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:466\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.169+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"1eda528c8c95ddbf984067d0355a7708","trace_id":"1eda528c8c95ddbf984067d0355a7708","span_id":"405c7d21a5bda7e5","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"1eda528c8c95ddbf984067d0355a7708","trace_id":"1eda528c8c95ddbf984067d0355a7708","span_id":"405c7d21a5bda7e5","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":401,"duration":0.011162042}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.169+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"1eda528c8c95ddbf984067d0355a7708","trace_id":"1eda528c8c95ddbf984067d0355a7708","span_id":"405c7d21a5bda7e5","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_InvalidToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_InvalidToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:466\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_VerifyOneTimeToken_InvalidToken (0.01s)
=== RUN   TestOAuthHandler_RefreshSession_Success
{"level":"INFO","timestamp":"2025-06-25T23:44:04.169+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"c91ee8b84d723fe92101f1a42a06dc97","trace_id":"c91ee8b84d723fe92101f1a42a06dc97","span_id":"9852dca8fa051a8e","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"c91ee8b84d723fe92101f1a42a06dc97","trace_id":"c91ee8b84d723fe92101f1a42a06dc97","span_id":"9852dca8fa051a8e","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.169+0530","caller":"rest/oauth_handler.go:580","message":"Session refresh initiated","request_id":"c91ee8b84d723fe92101f1a42a06dc97","trace_id":"c91ee8b84d723fe92101f1a42a06dc97","span_id":"9852dca8fa051a8e","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/oauth/refresh","method":"POST"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.169+0530","caller":"rest/oauth_handler.go:598","message":"Session refresh validation passed","request_id":"c91ee8b84d723fe92101f1a42a06dc97","trace_id":"c91ee8b84d723fe92101f1a42a06dc97","span_id":"9852dca8fa051a8e","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","token_prefix":"one-time-t...","session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.179+0530","caller":"rest/oauth_handler.go:637","message":"Business event","request_id":"c91ee8b84d723fe92101f1a42a06dc97","trace_id":"c91ee8b84d723fe92101f1a42a06dc97","span_id":"9852dca8fa051a8e","event_type":"session_refreshed","user_id":"anonymous-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","duration_ms":9}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.179+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"c91ee8b84d723fe92101f1a42a06dc97","trace_id":"c91ee8b84d723fe92101f1a42a06dc97","span_id":"9852dca8fa051a8e","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"c91ee8b84d723fe92101f1a42a06dc97","trace_id":"c91ee8b84d723fe92101f1a42a06dc97","span_id":"9852dca8fa051a8e","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.009102708}
--- PASS: TestOAuthHandler_RefreshSession_Success (0.01s)
=== RUN   TestOAuthHandler_RefreshSession_MissingSessionID
{"level":"INFO","timestamp":"2025-06-25T23:44:04.179+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"a96eb0a57105133c780b3b6254c1e463","trace_id":"a96eb0a57105133c780b3b6254c1e463","span_id":"5556b6b0cb8d4aac","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"a96eb0a57105133c780b3b6254c1e463","trace_id":"a96eb0a57105133c780b3b6254c1e463","span_id":"5556b6b0cb8d4aac","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.179+0530","caller":"rest/oauth_handler.go:580","message":"Session refresh initiated","request_id":"a96eb0a57105133c780b3b6254c1e463","trace_id":"a96eb0a57105133c780b3b6254c1e463","span_id":"5556b6b0cb8d4aac","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/oauth/refresh","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.179+0530","caller":"rest/oauth_handler.go:589","message":"Session refresh failed - missing parameters","request_id":"a96eb0a57105133c780b3b6254c1e463","trace_id":"a96eb0a57105133c780b3b6254c1e463","span_id":"5556b6b0cb8d4aac","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).RefreshSession\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:589\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_MissingSessionID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_MissingSessionID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:522\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.179+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"a96eb0a57105133c780b3b6254c1e463","trace_id":"a96eb0a57105133c780b3b6254c1e463","span_id":"5556b6b0cb8d4aac","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"a96eb0a57105133c780b3b6254c1e463","trace_id":"a96eb0a57105133c780b3b6254c1e463","span_id":"5556b6b0cb8d4aac","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000042917}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.179+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"a96eb0a57105133c780b3b6254c1e463","trace_id":"a96eb0a57105133c780b3b6254c1e463","span_id":"5556b6b0cb8d4aac","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_MissingSessionID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_MissingSessionID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:522\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_RefreshSession_MissingSessionID (0.00s)
=== RUN   TestOAuthHandler_NewOAuthHandler
--- PASS: TestOAuthHandler_NewOAuthHandler (0.00s)
=== RUN   TestOAuthHandler_CreateOneTimeToken_WithAllFields
{"level":"INFO","timestamp":"2025-06-25T23:44:04.179+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"4b4bc21cb050598a08a30f25a71c7eb4","trace_id":"4b4bc21cb050598a08a30f25a71c7eb4","span_id":"e3818065a6af9c3e","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"4b4bc21cb050598a08a30f25a71c7eb4","trace_id":"4b4bc21cb050598a08a30f25a71c7eb4","span_id":"e3818065a6af9c3e","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.179+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"4b4bc21cb050598a08a30f25a71c7eb4","trace_id":"4b4bc21cb050598a08a30f25a71c7eb4","span_id":"e3818065a6af9c3e","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.179+0530","caller":"rest/oauth_handler.go:380","message":"One-time token validation passed","request_id":"4b4bc21cb050598a08a30f25a71c7eb4","trace_id":"4b4bc21cb050598a08a30f25a71c7eb4","span_id":"e3818065a6af9c3e","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","url":"https://app.example.com/survey/123","session_id":"survey-session-456","expires_in":7200,"max_uses":5}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.195+0530","caller":"rest/oauth_handler.go:421","message":"Business event","request_id":"4b4bc21cb050598a08a30f25a71c7eb4","trace_id":"4b4bc21cb050598a08a30f25a71c7eb4","span_id":"e3818065a6af9c3e","event_type":"one_time_token_created","user_id":"","tenant_id":"","client_ip":"192.0.2.1:1234","max_uses":5,"duration_ms":16,"session_id":"survey-session-456","expires_in":7200}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.195+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"4b4bc21cb050598a08a30f25a71c7eb4","trace_id":"4b4bc21cb050598a08a30f25a71c7eb4","span_id":"e3818065a6af9c3e","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"4b4bc21cb050598a08a30f25a71c7eb4","trace_id":"4b4bc21cb050598a08a30f25a71c7eb4","span_id":"e3818065a6af9c3e","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":201,"duration":0.01610575}
--- PASS: TestOAuthHandler_CreateOneTimeToken_WithAllFields (0.02s)
=== RUN   TestOAuthHandler_CreateOneTimeToken_WithDefaultValues
{"level":"INFO","timestamp":"2025-06-25T23:44:04.195+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"52fba7beb947d2b0ca40bfc848b2b80d","trace_id":"52fba7beb947d2b0ca40bfc848b2b80d","span_id":"8300fe2b89f8ff08","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"52fba7beb947d2b0ca40bfc848b2b80d","trace_id":"52fba7beb947d2b0ca40bfc848b2b80d","span_id":"8300fe2b89f8ff08","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.195+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"52fba7beb947d2b0ca40bfc848b2b80d","trace_id":"52fba7beb947d2b0ca40bfc848b2b80d","span_id":"8300fe2b89f8ff08","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.195+0530","caller":"rest/oauth_handler.go:380","message":"One-time token validation passed","request_id":"52fba7beb947d2b0ca40bfc848b2b80d","trace_id":"52fba7beb947d2b0ca40bfc848b2b80d","span_id":"8300fe2b89f8ff08","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","url":"https://app.example.com/survey/123","session_id":"survey-session-456","expires_in":0,"max_uses":0}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.211+0530","caller":"rest/oauth_handler.go:421","message":"Business event","request_id":"52fba7beb947d2b0ca40bfc848b2b80d","trace_id":"52fba7beb947d2b0ca40bfc848b2b80d","span_id":"8300fe2b89f8ff08","event_type":"one_time_token_created","user_id":"","tenant_id":"","client_ip":"192.0.2.1:1234","expires_in":0,"max_uses":0,"duration_ms":16,"session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.211+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"52fba7beb947d2b0ca40bfc848b2b80d","trace_id":"52fba7beb947d2b0ca40bfc848b2b80d","span_id":"8300fe2b89f8ff08","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"52fba7beb947d2b0ca40bfc848b2b80d","trace_id":"52fba7beb947d2b0ca40bfc848b2b80d","span_id":"8300fe2b89f8ff08","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":201,"duration":0.016234}
--- PASS: TestOAuthHandler_CreateOneTimeToken_WithDefaultValues (0.02s)
=== RUN   TestOAuthHandler_CreateOneTimeToken_WithInvalidJSON
{"level":"INFO","timestamp":"2025-06-25T23:44:04.211+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"91c1daade21acba587db0d459e3175d1","trace_id":"91c1daade21acba587db0d459e3175d1","span_id":"495cafb40e35eb19","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"91c1daade21acba587db0d459e3175d1","trace_id":"91c1daade21acba587db0d459e3175d1","span_id":"495cafb40e35eb19","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.211+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"91c1daade21acba587db0d459e3175d1","trace_id":"91c1daade21acba587db0d459e3175d1","span_id":"495cafb40e35eb19","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.212+0530","caller":"rest/oauth_handler.go:371","message":"One-time token validation failed","request_id":"91c1daade21acba587db0d459e3175d1","trace_id":"91c1daade21acba587db0d459e3175d1","span_id":"495cafb40e35eb19","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","error":"unexpected EOF","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).CreateOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:371\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithInvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithInvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:638\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.212+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"91c1daade21acba587db0d459e3175d1","trace_id":"91c1daade21acba587db0d459e3175d1","span_id":"495cafb40e35eb19","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"91c1daade21acba587db0d459e3175d1","trace_id":"91c1daade21acba587db0d459e3175d1","span_id":"495cafb40e35eb19","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000164917}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.212+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"91c1daade21acba587db0d459e3175d1","trace_id":"91c1daade21acba587db0d459e3175d1","span_id":"495cafb40e35eb19","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":44,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithInvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithInvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:638\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_CreateOneTimeToken_WithInvalidJSON (0.00s)
=== RUN   TestOAuthHandler_CreateOneTimeToken_WithEmptyBody
{"level":"INFO","timestamp":"2025-06-25T23:44:04.212+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"5a29ec378169354402b08c3c86d61b8f","trace_id":"5a29ec378169354402b08c3c86d61b8f","span_id":"481e84b587eea7b6","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"5a29ec378169354402b08c3c86d61b8f","trace_id":"5a29ec378169354402b08c3c86d61b8f","span_id":"481e84b587eea7b6","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.212+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"5a29ec378169354402b08c3c86d61b8f","trace_id":"5a29ec378169354402b08c3c86d61b8f","span_id":"481e84b587eea7b6","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.212+0530","caller":"rest/oauth_handler.go:371","message":"One-time token validation failed","request_id":"5a29ec378169354402b08c3c86d61b8f","trace_id":"5a29ec378169354402b08c3c86d61b8f","span_id":"481e84b587eea7b6","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","error":"EOF","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).CreateOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:371\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithEmptyBody.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithEmptyBody\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:665\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.212+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"5a29ec378169354402b08c3c86d61b8f","trace_id":"5a29ec378169354402b08c3c86d61b8f","span_id":"481e84b587eea7b6","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"5a29ec378169354402b08c3c86d61b8f","trace_id":"5a29ec378169354402b08c3c86d61b8f","span_id":"481e84b587eea7b6","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000139583}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.212+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"5a29ec378169354402b08c3c86d61b8f","trace_id":"5a29ec378169354402b08c3c86d61b8f","span_id":"481e84b587eea7b6","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithEmptyBody.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithEmptyBody\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:665\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_CreateOneTimeToken_WithEmptyBody (0.00s)
=== RUN   TestOAuthHandler_VerifyOneTimeToken_WithAllFields
{"level":"INFO","timestamp":"2025-06-25T23:44:04.212+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"d39e185721a8df4da80c58bc267fc65f","trace_id":"d39e185721a8df4da80c58bc267fc65f","span_id":"af34a4bddd89aeb6","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"d39e185721a8df4da80c58bc267fc65f","trace_id":"d39e185721a8df4da80c58bc267fc65f","span_id":"af34a4bddd89aeb6","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.212+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"d39e185721a8df4da80c58bc267fc65f","trace_id":"d39e185721a8df4da80c58bc267fc65f","span_id":"af34a4bddd89aeb6","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.212+0530","caller":"rest/oauth_handler.go:488","message":"One-time token verification validation passed","request_id":"d39e185721a8df4da80c58bc267fc65f","trace_id":"d39e185721a8df4da80c58bc267fc65f","span_id":"af34a4bddd89aeb6","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","token_prefix":"one-time-t...","session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.223+0530","caller":"rest/oauth_handler.go:542","message":"Business event","request_id":"d39e185721a8df4da80c58bc267fc65f","trace_id":"d39e185721a8df4da80c58bc267fc65f","span_id":"af34a4bddd89aeb6","event_type":"one_time_token_verified","user_id":"anonymous-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","is_valid":true,"duration_ms":11}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.224+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"d39e185721a8df4da80c58bc267fc65f","trace_id":"d39e185721a8df4da80c58bc267fc65f","span_id":"af34a4bddd89aeb6","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"d39e185721a8df4da80c58bc267fc65f","trace_id":"d39e185721a8df4da80c58bc267fc65f","span_id":"af34a4bddd89aeb6","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.011413125}
--- PASS: TestOAuthHandler_VerifyOneTimeToken_WithAllFields (0.01s)
=== RUN   TestOAuthHandler_VerifyOneTimeToken_WithMissingSessionID
{"level":"INFO","timestamp":"2025-06-25T23:44:04.224+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"b966fc0adb3c59d48ed2df85c0dcd892","trace_id":"b966fc0adb3c59d48ed2df85c0dcd892","span_id":"6b4cd79debce92f4","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"b966fc0adb3c59d48ed2df85c0dcd892","trace_id":"b966fc0adb3c59d48ed2df85c0dcd892","span_id":"6b4cd79debce92f4","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.224+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"b966fc0adb3c59d48ed2df85c0dcd892","trace_id":"b966fc0adb3c59d48ed2df85c0dcd892","span_id":"6b4cd79debce92f4","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.224+0530","caller":"rest/oauth_handler.go:479","message":"One-time token verification failed - missing session ID","request_id":"b966fc0adb3c59d48ed2df85c0dcd892","trace_id":"b966fc0adb3c59d48ed2df85c0dcd892","span_id":"6b4cd79debce92f4","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).VerifyOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:479\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithMissingSessionID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithMissingSessionID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:723\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.224+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"b966fc0adb3c59d48ed2df85c0dcd892","trace_id":"b966fc0adb3c59d48ed2df85c0dcd892","span_id":"6b4cd79debce92f4","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"b966fc0adb3c59d48ed2df85c0dcd892","trace_id":"b966fc0adb3c59d48ed2df85c0dcd892","span_id":"6b4cd79debce92f4","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.00015025}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.224+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"b966fc0adb3c59d48ed2df85c0dcd892","trace_id":"b966fc0adb3c59d48ed2df85c0dcd892","span_id":"6b4cd79debce92f4","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithMissingSessionID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithMissingSessionID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:723\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_VerifyOneTimeToken_WithMissingSessionID (0.00s)
=== RUN   TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken
{"level":"INFO","timestamp":"2025-06-25T23:44:04.224+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"ffd9709631392caaeda6c9223abaa503","trace_id":"ffd9709631392caaeda6c9223abaa503","span_id":"1ec9d441c216100e","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"ffd9709631392caaeda6c9223abaa503","trace_id":"ffd9709631392caaeda6c9223abaa503","span_id":"1ec9d441c216100e","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.224+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"ffd9709631392caaeda6c9223abaa503","trace_id":"ffd9709631392caaeda6c9223abaa503","span_id":"1ec9d441c216100e","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.224+0530","caller":"rest/oauth_handler.go:488","message":"One-time token verification validation passed","request_id":"ffd9709631392caaeda6c9223abaa503","trace_id":"ffd9709631392caaeda6c9223abaa503","span_id":"1ec9d441c216100e","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","token_prefix":"invalid-to...","session_id":"invalid-session"}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.235+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"ffd9709631392caaeda6c9223abaa503","trace_id":"ffd9709631392caaeda6c9223abaa503","span_id":"1ec9d441c216100e","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"ffd9709631392caaeda6c9223abaa503","trace_id":"ffd9709631392caaeda6c9223abaa503","span_id":"1ec9d441c216100e","user_id":"","tenant_id":"","auth_method":"one_time_token","reason":"invalid_token","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).VerifyOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:513\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:750\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.235+0530","caller":"rest/oauth_handler.go:514","message":"One-time token verification failed - invalid token or session","request_id":"ffd9709631392caaeda6c9223abaa503","trace_id":"ffd9709631392caaeda6c9223abaa503","span_id":"1ec9d441c216100e","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).VerifyOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:514\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:750\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.235+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"ffd9709631392caaeda6c9223abaa503","trace_id":"ffd9709631392caaeda6c9223abaa503","span_id":"1ec9d441c216100e","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"ffd9709631392caaeda6c9223abaa503","trace_id":"ffd9709631392caaeda6c9223abaa503","span_id":"1ec9d441c216100e","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":401,"duration":0.011008083}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.235+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"ffd9709631392caaeda6c9223abaa503","trace_id":"ffd9709631392caaeda6c9223abaa503","span_id":"1ec9d441c216100e","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:750\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken (0.01s)
=== RUN   TestOAuthHandler_RefreshSession_WithAllFields
{"level":"INFO","timestamp":"2025-06-25T23:44:04.235+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"b97fe5c77faae9c98b4689a603ae24fd","trace_id":"b97fe5c77faae9c98b4689a603ae24fd","span_id":"a8a818a2dd1f77bf","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"b97fe5c77faae9c98b4689a603ae24fd","trace_id":"b97fe5c77faae9c98b4689a603ae24fd","span_id":"a8a818a2dd1f77bf","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.235+0530","caller":"rest/oauth_handler.go:580","message":"Session refresh initiated","request_id":"b97fe5c77faae9c98b4689a603ae24fd","trace_id":"b97fe5c77faae9c98b4689a603ae24fd","span_id":"a8a818a2dd1f77bf","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/oauth/refresh","method":"POST"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.236+0530","caller":"rest/oauth_handler.go:598","message":"Session refresh validation passed","request_id":"b97fe5c77faae9c98b4689a603ae24fd","trace_id":"b97fe5c77faae9c98b4689a603ae24fd","span_id":"a8a818a2dd1f77bf","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","token_prefix":"one-time-t...","session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.245+0530","caller":"rest/oauth_handler.go:637","message":"Business event","request_id":"b97fe5c77faae9c98b4689a603ae24fd","trace_id":"b97fe5c77faae9c98b4689a603ae24fd","span_id":"a8a818a2dd1f77bf","event_type":"session_refreshed","user_id":"anonymous-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","duration_ms":9}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.245+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"b97fe5c77faae9c98b4689a603ae24fd","trace_id":"b97fe5c77faae9c98b4689a603ae24fd","span_id":"a8a818a2dd1f77bf","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"b97fe5c77faae9c98b4689a603ae24fd","trace_id":"b97fe5c77faae9c98b4689a603ae24fd","span_id":"a8a818a2dd1f77bf","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.009245625}
--- PASS: TestOAuthHandler_RefreshSession_WithAllFields (0.01s)
=== RUN   TestOAuthHandler_RefreshSession_WithInvalidJSON
{"level":"INFO","timestamp":"2025-06-25T23:44:04.245+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"bae37e553d0661b5d0828a5ef6134a16","trace_id":"bae37e553d0661b5d0828a5ef6134a16","span_id":"08ff8eb9e1204c2b","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"bae37e553d0661b5d0828a5ef6134a16","trace_id":"bae37e553d0661b5d0828a5ef6134a16","span_id":"08ff8eb9e1204c2b","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.245+0530","caller":"rest/oauth_handler.go:580","message":"Session refresh initiated","request_id":"bae37e553d0661b5d0828a5ef6134a16","trace_id":"bae37e553d0661b5d0828a5ef6134a16","span_id":"08ff8eb9e1204c2b","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/oauth/refresh","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.245+0530","caller":"rest/oauth_handler.go:589","message":"Session refresh failed - missing parameters","request_id":"bae37e553d0661b5d0828a5ef6134a16","trace_id":"bae37e553d0661b5d0828a5ef6134a16","span_id":"08ff8eb9e1204c2b","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).RefreshSession\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:589\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithInvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithInvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:810\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.245+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"bae37e553d0661b5d0828a5ef6134a16","trace_id":"bae37e553d0661b5d0828a5ef6134a16","span_id":"08ff8eb9e1204c2b","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"bae37e553d0661b5d0828a5ef6134a16","trace_id":"bae37e553d0661b5d0828a5ef6134a16","span_id":"08ff8eb9e1204c2b","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.00009475}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.245+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"bae37e553d0661b5d0828a5ef6134a16","trace_id":"bae37e553d0661b5d0828a5ef6134a16","span_id":"08ff8eb9e1204c2b","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":33,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithInvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithInvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:810\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_RefreshSession_WithInvalidJSON (0.00s)
=== RUN   TestOAuthHandler_RefreshSession_WithEmptyBody
{"level":"INFO","timestamp":"2025-06-25T23:44:04.245+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"9bfc4131313e299b78c864b713b4a9f2","trace_id":"9bfc4131313e299b78c864b713b4a9f2","span_id":"13c6772796fa1180","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"9bfc4131313e299b78c864b713b4a9f2","trace_id":"9bfc4131313e299b78c864b713b4a9f2","span_id":"13c6772796fa1180","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.245+0530","caller":"rest/oauth_handler.go:580","message":"Session refresh initiated","request_id":"9bfc4131313e299b78c864b713b4a9f2","trace_id":"9bfc4131313e299b78c864b713b4a9f2","span_id":"13c6772796fa1180","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/oauth/refresh","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.245+0530","caller":"rest/oauth_handler.go:589","message":"Session refresh failed - missing parameters","request_id":"9bfc4131313e299b78c864b713b4a9f2","trace_id":"9bfc4131313e299b78c864b713b4a9f2","span_id":"13c6772796fa1180","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).RefreshSession\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:589\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithEmptyBody.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithEmptyBody\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:837\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.245+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"9bfc4131313e299b78c864b713b4a9f2","trace_id":"9bfc4131313e299b78c864b713b4a9f2","span_id":"13c6772796fa1180","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"9bfc4131313e299b78c864b713b4a9f2","trace_id":"9bfc4131313e299b78c864b713b4a9f2","span_id":"13c6772796fa1180","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000067375}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.245+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"9bfc4131313e299b78c864b713b4a9f2","trace_id":"9bfc4131313e299b78c864b713b4a9f2","span_id":"13c6772796fa1180","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithEmptyBody.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithEmptyBody\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:837\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_RefreshSession_WithEmptyBody (0.00s)
=== RUN   TestOAuthHandler_ClientCredentials_WithScope
{"level":"INFO","timestamp":"2025-06-25T23:44:04.245+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"2dc9c5ffd9a3905aa6242d0670c97982","trace_id":"2dc9c5ffd9a3905aa6242d0670c97982","span_id":"edbd2ac0a808a821","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"2dc9c5ffd9a3905aa6242d0670c97982","trace_id":"2dc9c5ffd9a3905aa6242d0670c97982","span_id":"edbd2ac0a808a821","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.245+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"2dc9c5ffd9a3905aa6242d0670c97982","trace_id":"2dc9c5ffd9a3905aa6242d0670c97982","span_id":"edbd2ac0a808a821","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.245+0530","caller":"rest/oauth_handler.go:277","message":"Client credentials validation passed","request_id":"2dc9c5ffd9a3905aa6242d0670c97982","trace_id":"2dc9c5ffd9a3905aa6242d0670c97982","span_id":"edbd2ac0a808a821","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","client_id":"test-client-id","grant_type":"client_credentials","scope":"read:users write:users"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.266+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"2dc9c5ffd9a3905aa6242d0670c97982","trace_id":"2dc9c5ffd9a3905aa6242d0670c97982","span_id":"edbd2ac0a808a821","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"2dc9c5ffd9a3905aa6242d0670c97982","trace_id":"2dc9c5ffd9a3905aa6242d0670c97982","span_id":"edbd2ac0a808a821","user_id":"test-client-id","tenant_id":"","auth_method":"client_credentials","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.267+0530","caller":"rest/oauth_handler.go:310","message":"Business event","request_id":"2dc9c5ffd9a3905aa6242d0670c97982","trace_id":"2dc9c5ffd9a3905aa6242d0670c97982","span_id":"edbd2ac0a808a821","event_type":"client_credentials_success","user_id":"test-client-id","tenant_id":"","client_ip":"192.0.2.1:1234","scope":"read:users write:users","duration_ms":21}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.267+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"2dc9c5ffd9a3905aa6242d0670c97982","trace_id":"2dc9c5ffd9a3905aa6242d0670c97982","span_id":"edbd2ac0a808a821","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"2dc9c5ffd9a3905aa6242d0670c97982","trace_id":"2dc9c5ffd9a3905aa6242d0670c97982","span_id":"edbd2ac0a808a821","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.021388708}
--- PASS: TestOAuthHandler_ClientCredentials_WithScope (0.02s)
=== RUN   TestOAuthHandler_ClientCredentials_WithoutScope
{"level":"INFO","timestamp":"2025-06-25T23:44:04.267+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"de61042eecd7ffab1821f5107517a8b5","trace_id":"de61042eecd7ffab1821f5107517a8b5","span_id":"81d2d3c76bfc4a2c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"de61042eecd7ffab1821f5107517a8b5","trace_id":"de61042eecd7ffab1821f5107517a8b5","span_id":"81d2d3c76bfc4a2c","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.267+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"de61042eecd7ffab1821f5107517a8b5","trace_id":"de61042eecd7ffab1821f5107517a8b5","span_id":"81d2d3c76bfc4a2c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.267+0530","caller":"rest/oauth_handler.go:277","message":"Client credentials validation passed","request_id":"de61042eecd7ffab1821f5107517a8b5","trace_id":"de61042eecd7ffab1821f5107517a8b5","span_id":"81d2d3c76bfc4a2c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","client_id":"test-client-id","grant_type":"client_credentials","scope":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.288+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"de61042eecd7ffab1821f5107517a8b5","trace_id":"de61042eecd7ffab1821f5107517a8b5","span_id":"81d2d3c76bfc4a2c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"de61042eecd7ffab1821f5107517a8b5","trace_id":"de61042eecd7ffab1821f5107517a8b5","span_id":"81d2d3c76bfc4a2c","user_id":"test-client-id","tenant_id":"","auth_method":"client_credentials","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.288+0530","caller":"rest/oauth_handler.go:310","message":"Business event","request_id":"de61042eecd7ffab1821f5107517a8b5","trace_id":"de61042eecd7ffab1821f5107517a8b5","span_id":"81d2d3c76bfc4a2c","event_type":"client_credentials_success","user_id":"test-client-id","tenant_id":"","client_ip":"192.0.2.1:1234","scope":"","duration_ms":21}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.288+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"de61042eecd7ffab1821f5107517a8b5","trace_id":"de61042eecd7ffab1821f5107517a8b5","span_id":"81d2d3c76bfc4a2c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"de61042eecd7ffab1821f5107517a8b5","trace_id":"de61042eecd7ffab1821f5107517a8b5","span_id":"81d2d3c76bfc4a2c","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.021338125}
--- PASS: TestOAuthHandler_ClientCredentials_WithoutScope (0.02s)
=== RUN   TestOAuthHandler_ClientCredentials_WithEmptyScope
{"level":"INFO","timestamp":"2025-06-25T23:44:04.289+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"691f2c843358019e22a31d9b4db63732","trace_id":"691f2c843358019e22a31d9b4db63732","span_id":"da27c384903921f3","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"691f2c843358019e22a31d9b4db63732","trace_id":"691f2c843358019e22a31d9b4db63732","span_id":"da27c384903921f3","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.289+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"691f2c843358019e22a31d9b4db63732","trace_id":"691f2c843358019e22a31d9b4db63732","span_id":"da27c384903921f3","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.289+0530","caller":"rest/oauth_handler.go:277","message":"Client credentials validation passed","request_id":"691f2c843358019e22a31d9b4db63732","trace_id":"691f2c843358019e22a31d9b4db63732","span_id":"da27c384903921f3","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","client_id":"test-client-id","grant_type":"client_credentials","scope":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.310+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"691f2c843358019e22a31d9b4db63732","trace_id":"691f2c843358019e22a31d9b4db63732","span_id":"da27c384903921f3","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"691f2c843358019e22a31d9b4db63732","trace_id":"691f2c843358019e22a31d9b4db63732","span_id":"da27c384903921f3","user_id":"test-client-id","tenant_id":"","auth_method":"client_credentials","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.310+0530","caller":"rest/oauth_handler.go:310","message":"Business event","request_id":"691f2c843358019e22a31d9b4db63732","trace_id":"691f2c843358019e22a31d9b4db63732","span_id":"da27c384903921f3","event_type":"client_credentials_success","user_id":"test-client-id","tenant_id":"","client_ip":"192.0.2.1:1234","scope":"","duration_ms":21}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.310+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"691f2c843358019e22a31d9b4db63732","trace_id":"691f2c843358019e22a31d9b4db63732","span_id":"da27c384903921f3","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"691f2c843358019e22a31d9b4db63732","trace_id":"691f2c843358019e22a31d9b4db63732","span_id":"da27c384903921f3","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.021220334}
--- PASS: TestOAuthHandler_ClientCredentials_WithEmptyScope (0.02s)
=== RUN   TestOAuthHandler_GoogleLogin_WithEmptyRedirectURI
{"level":"INFO","timestamp":"2025-06-25T23:44:04.310+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"e14113ca370335b0485c570b3549b668","trace_id":"e14113ca370335b0485c570b3549b668","span_id":"6c815590899f73dc","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"e14113ca370335b0485c570b3549b668","trace_id":"e14113ca370335b0485c570b3549b668","span_id":"6c815590899f73dc","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.310+0530","caller":"rest/oauth_handler.go:65","message":"Google OAuth login initiated","request_id":"e14113ca370335b0485c570b3549b668","trace_id":"e14113ca370335b0485c570b3549b668","span_id":"6c815590899f73dc","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/login","method":"GET"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.310+0530","caller":"rest/oauth_handler.go:84","message":"Google OAuth login validation passed","request_id":"e14113ca370335b0485c570b3549b668","trace_id":"e14113ca370335b0485c570b3549b668","span_id":"6c815590899f73dc","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","tenant_id":"tenant-123","redirect_uri":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.310+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"e14113ca370335b0485c570b3549b668","trace_id":"e14113ca370335b0485c570b3549b668","span_id":"6c815590899f73dc","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"e14113ca370335b0485c570b3549b668","trace_id":"e14113ca370335b0485c570b3549b668","span_id":"6c815590899f73dc","provider":"google","step":"login_initiated","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.310+0530","caller":"rest/oauth_handler.go:101","message":"Business event","request_id":"e14113ca370335b0485c570b3549b668","trace_id":"e14113ca370335b0485c570b3549b668","span_id":"6c815590899f73dc","event_type":"oauth_login_initiated","user_id":"","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","redirect_uri":"http://localhost:8080/api/v1/oauth/google/callback","duration_ms":0,"provider":"google"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.310+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"e14113ca370335b0485c570b3549b668","trace_id":"e14113ca370335b0485c570b3549b668","span_id":"6c815590899f73dc","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"e14113ca370335b0485c570b3549b668","trace_id":"e14113ca370335b0485c570b3549b668","span_id":"6c815590899f73dc","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.0001095}
--- PASS: TestOAuthHandler_GoogleLogin_WithEmptyRedirectURI (0.00s)
=== RUN   TestOAuthHandler_GoogleCallback_WithEmptyState
{"level":"INFO","timestamp":"2025-06-25T23:44:04.310+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"4054611b290d4c3a8487d217c39860bd","trace_id":"4054611b290d4c3a8487d217c39860bd","span_id":"4a8b2730fb8ac120","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"4054611b290d4c3a8487d217c39860bd","trace_id":"4054611b290d4c3a8487d217c39860bd","span_id":"4a8b2730fb8ac120","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.310+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"4054611b290d4c3a8487d217c39860bd","trace_id":"4054611b290d4c3a8487d217c39860bd","span_id":"4a8b2730fb8ac120","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.310+0530","caller":"rest/oauth_handler.go:174","message":"Google OAuth callback validation passed","request_id":"4054611b290d4c3a8487d217c39860bd","trace_id":"4054611b290d4c3a8487d217c39860bd","span_id":"4a8b2730fb8ac120","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","tenant_id":"","code_prefix":"test-auth-..."}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.361+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"4054611b290d4c3a8487d217c39860bd","trace_id":"4054611b290d4c3a8487d217c39860bd","span_id":"4a8b2730fb8ac120","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"4054611b290d4c3a8487d217c39860bd","trace_id":"4054611b290d4c3a8487d217c39860bd","span_id":"4a8b2730fb8ac120","user_id":"google-user-123","tenant_id":"","auth_method":"google_oauth","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.361+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"4054611b290d4c3a8487d217c39860bd","trace_id":"4054611b290d4c3a8487d217c39860bd","span_id":"4a8b2730fb8ac120","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"4054611b290d4c3a8487d217c39860bd","trace_id":"4054611b290d4c3a8487d217c39860bd","span_id":"4a8b2730fb8ac120","provider":"google","step":"callback_success","tenant_id":"","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.361+0530","caller":"rest/oauth_handler.go:209","message":"Business event","request_id":"4054611b290d4c3a8487d217c39860bd","trace_id":"4054611b290d4c3a8487d217c39860bd","span_id":"4a8b2730fb8ac120","event_type":"oauth_login_completed","user_id":"google-user-123","tenant_id":"","client_ip":"192.0.2.1:1234","provider":"google","duration_ms":51}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.361+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"4054611b290d4c3a8487d217c39860bd","trace_id":"4054611b290d4c3a8487d217c39860bd","span_id":"4a8b2730fb8ac120","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"4054611b290d4c3a8487d217c39860bd","trace_id":"4054611b290d4c3a8487d217c39860bd","span_id":"4a8b2730fb8ac120","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.051300666}
--- PASS: TestOAuthHandler_GoogleCallback_WithEmptyState (0.05s)
=== RUN   TestOAuthHandler_GoogleCallback_WithOnlyCode
{"level":"INFO","timestamp":"2025-06-25T23:44:04.362+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"30fcbba92fe73b1bf47bdbb314b02f8a","trace_id":"30fcbba92fe73b1bf47bdbb314b02f8a","span_id":"6cc6cf28032d2f03","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"30fcbba92fe73b1bf47bdbb314b02f8a","trace_id":"30fcbba92fe73b1bf47bdbb314b02f8a","span_id":"6cc6cf28032d2f03","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.362+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"30fcbba92fe73b1bf47bdbb314b02f8a","trace_id":"30fcbba92fe73b1bf47bdbb314b02f8a","span_id":"6cc6cf28032d2f03","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.362+0530","caller":"rest/oauth_handler.go:174","message":"Google OAuth callback validation passed","request_id":"30fcbba92fe73b1bf47bdbb314b02f8a","trace_id":"30fcbba92fe73b1bf47bdbb314b02f8a","span_id":"6cc6cf28032d2f03","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","tenant_id":"","code_prefix":"test-auth-..."}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.412+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"30fcbba92fe73b1bf47bdbb314b02f8a","trace_id":"30fcbba92fe73b1bf47bdbb314b02f8a","span_id":"6cc6cf28032d2f03","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"30fcbba92fe73b1bf47bdbb314b02f8a","trace_id":"30fcbba92fe73b1bf47bdbb314b02f8a","span_id":"6cc6cf28032d2f03","user_id":"google-user-123","tenant_id":"","auth_method":"google_oauth","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.412+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"30fcbba92fe73b1bf47bdbb314b02f8a","trace_id":"30fcbba92fe73b1bf47bdbb314b02f8a","span_id":"6cc6cf28032d2f03","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"30fcbba92fe73b1bf47bdbb314b02f8a","trace_id":"30fcbba92fe73b1bf47bdbb314b02f8a","span_id":"6cc6cf28032d2f03","provider":"google","step":"callback_success","tenant_id":"","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.412+0530","caller":"rest/oauth_handler.go:209","message":"Business event","request_id":"30fcbba92fe73b1bf47bdbb314b02f8a","trace_id":"30fcbba92fe73b1bf47bdbb314b02f8a","span_id":"6cc6cf28032d2f03","event_type":"oauth_login_completed","user_id":"google-user-123","tenant_id":"","client_ip":"192.0.2.1:1234","provider":"google","duration_ms":50}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.412+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"30fcbba92fe73b1bf47bdbb314b02f8a","trace_id":"30fcbba92fe73b1bf47bdbb314b02f8a","span_id":"6cc6cf28032d2f03","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"30fcbba92fe73b1bf47bdbb314b02f8a","trace_id":"30fcbba92fe73b1bf47bdbb314b02f8a","span_id":"6cc6cf28032d2f03","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.050322292}
--- PASS: TestOAuthHandler_GoogleCallback_WithOnlyCode (0.05s)
=== RUN   TestOAuthHandler_GoogleCallback_WithOnlyError
{"level":"INFO","timestamp":"2025-06-25T23:44:04.412+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"6d10b1a77ce878f05f4f46819903a8ab","trace_id":"6d10b1a77ce878f05f4f46819903a8ab","span_id":"844c45d13793284d","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"6d10b1a77ce878f05f4f46819903a8ab","trace_id":"6d10b1a77ce878f05f4f46819903a8ab","span_id":"844c45d13793284d","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.412+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"6d10b1a77ce878f05f4f46819903a8ab","trace_id":"6d10b1a77ce878f05f4f46819903a8ab","span_id":"844c45d13793284d","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.412+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"6d10b1a77ce878f05f4f46819903a8ab","trace_id":"6d10b1a77ce878f05f4f46819903a8ab","span_id":"844c45d13793284d","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"6d10b1a77ce878f05f4f46819903a8ab","trace_id":"6d10b1a77ce878f05f4f46819903a8ab","span_id":"844c45d13793284d","user_id":"","tenant_id":"","auth_method":"google_oauth","reason":"oauth_error","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).GoogleCallback\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:153\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_WithOnlyError.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_WithOnlyError\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:1063\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.412+0530","caller":"logger/logger.go:225","message":"OAuth flow failed","request_id":"6d10b1a77ce878f05f4f46819903a8ab","trace_id":"6d10b1a77ce878f05f4f46819903a8ab","span_id":"844c45d13793284d","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"6d10b1a77ce878f05f4f46819903a8ab","trace_id":"6d10b1a77ce878f05f4f46819903a8ab","span_id":"844c45d13793284d","provider":"google","step":"callback_error","tenant_id":"","client_ip":"192.0.2.1:1234","error":"oauth error: access_denied","stacktrace":"auth-service/internal/logger.(*RequestLogger).OAuthFlow\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:225\nauth-service/internal/handler/rest.(*OAuthHandler).GoogleCallback\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:154\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_WithOnlyError.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_WithOnlyError\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:1063\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.412+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"6d10b1a77ce878f05f4f46819903a8ab","trace_id":"6d10b1a77ce878f05f4f46819903a8ab","span_id":"844c45d13793284d","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"6d10b1a77ce878f05f4f46819903a8ab","trace_id":"6d10b1a77ce878f05f4f46819903a8ab","span_id":"844c45d13793284d","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000091625}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.412+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"6d10b1a77ce878f05f4f46819903a8ab","trace_id":"6d10b1a77ce878f05f4f46819903a8ab","span_id":"844c45d13793284d","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_WithOnlyError.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_WithOnlyError\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:1063\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_GoogleCallback_WithOnlyError (0.00s)
=== RUN   TestOAuthHandler_Integration
=== RUN   TestOAuthHandler_Integration/GoogleLogin
{"level":"INFO","timestamp":"2025-06-25T23:44:04.413+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"6aa0ba6d5ebc5e5f04cbe42d88c454d1","trace_id":"6aa0ba6d5ebc5e5f04cbe42d88c454d1","span_id":"e6afe4f9a2eb59f9","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"6aa0ba6d5ebc5e5f04cbe42d88c454d1","trace_id":"6aa0ba6d5ebc5e5f04cbe42d88c454d1","span_id":"e6afe4f9a2eb59f9","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.413+0530","caller":"rest/oauth_handler.go:65","message":"Google OAuth login initiated","request_id":"6aa0ba6d5ebc5e5f04cbe42d88c454d1","trace_id":"6aa0ba6d5ebc5e5f04cbe42d88c454d1","span_id":"e6afe4f9a2eb59f9","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/login","method":"GET"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.413+0530","caller":"rest/oauth_handler.go:84","message":"Google OAuth login validation passed","request_id":"6aa0ba6d5ebc5e5f04cbe42d88c454d1","trace_id":"6aa0ba6d5ebc5e5f04cbe42d88c454d1","span_id":"e6afe4f9a2eb59f9","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","tenant_id":"tenant-123","redirect_uri":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.413+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"6aa0ba6d5ebc5e5f04cbe42d88c454d1","trace_id":"6aa0ba6d5ebc5e5f04cbe42d88c454d1","span_id":"e6afe4f9a2eb59f9","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"6aa0ba6d5ebc5e5f04cbe42d88c454d1","trace_id":"6aa0ba6d5ebc5e5f04cbe42d88c454d1","span_id":"e6afe4f9a2eb59f9","provider":"google","step":"login_initiated","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.413+0530","caller":"rest/oauth_handler.go:101","message":"Business event","request_id":"6aa0ba6d5ebc5e5f04cbe42d88c454d1","trace_id":"6aa0ba6d5ebc5e5f04cbe42d88c454d1","span_id":"e6afe4f9a2eb59f9","event_type":"oauth_login_initiated","user_id":"","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","provider":"google","redirect_uri":"http://localhost:8080/api/v1/oauth/google/callback","duration_ms":0}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.413+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"6aa0ba6d5ebc5e5f04cbe42d88c454d1","trace_id":"6aa0ba6d5ebc5e5f04cbe42d88c454d1","span_id":"e6afe4f9a2eb59f9","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"6aa0ba6d5ebc5e5f04cbe42d88c454d1","trace_id":"6aa0ba6d5ebc5e5f04cbe42d88c454d1","span_id":"e6afe4f9a2eb59f9","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.000116625}
=== RUN   TestOAuthHandler_Integration/GoogleCallback
{"level":"INFO","timestamp":"2025-06-25T23:44:04.413+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"f0e46d4474c46d6e162fa42bfb030114","trace_id":"f0e46d4474c46d6e162fa42bfb030114","span_id":"715668d3c6d3f119","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"f0e46d4474c46d6e162fa42bfb030114","trace_id":"f0e46d4474c46d6e162fa42bfb030114","span_id":"715668d3c6d3f119","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.413+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"f0e46d4474c46d6e162fa42bfb030114","trace_id":"f0e46d4474c46d6e162fa42bfb030114","span_id":"715668d3c6d3f119","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.413+0530","caller":"rest/oauth_handler.go:174","message":"Google OAuth callback validation passed","request_id":"f0e46d4474c46d6e162fa42bfb030114","trace_id":"f0e46d4474c46d6e162fa42bfb030114","span_id":"715668d3c6d3f119","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","tenant_id":"tenant-123","code_prefix":"test-code..."}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.464+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"f0e46d4474c46d6e162fa42bfb030114","trace_id":"f0e46d4474c46d6e162fa42bfb030114","span_id":"715668d3c6d3f119","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"f0e46d4474c46d6e162fa42bfb030114","trace_id":"f0e46d4474c46d6e162fa42bfb030114","span_id":"715668d3c6d3f119","user_id":"google-user-123","tenant_id":"tenant-123","auth_method":"google_oauth","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.464+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"f0e46d4474c46d6e162fa42bfb030114","trace_id":"f0e46d4474c46d6e162fa42bfb030114","span_id":"715668d3c6d3f119","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"f0e46d4474c46d6e162fa42bfb030114","trace_id":"f0e46d4474c46d6e162fa42bfb030114","span_id":"715668d3c6d3f119","provider":"google","step":"callback_success","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.464+0530","caller":"rest/oauth_handler.go:209","message":"Business event","request_id":"f0e46d4474c46d6e162fa42bfb030114","trace_id":"f0e46d4474c46d6e162fa42bfb030114","span_id":"715668d3c6d3f119","event_type":"oauth_login_completed","user_id":"google-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","provider":"google","duration_ms":51}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.464+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"f0e46d4474c46d6e162fa42bfb030114","trace_id":"f0e46d4474c46d6e162fa42bfb030114","span_id":"715668d3c6d3f119","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"f0e46d4474c46d6e162fa42bfb030114","trace_id":"f0e46d4474c46d6e162fa42bfb030114","span_id":"715668d3c6d3f119","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.051310875}
=== RUN   TestOAuthHandler_Integration/ClientCredentials
{"level":"INFO","timestamp":"2025-06-25T23:44:04.464+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"e10344c983bcbd051a1f85df68491c86","trace_id":"e10344c983bcbd051a1f85df68491c86","span_id":"063a3f53c9875690","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"e10344c983bcbd051a1f85df68491c86","trace_id":"e10344c983bcbd051a1f85df68491c86","span_id":"063a3f53c9875690","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.464+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"e10344c983bcbd051a1f85df68491c86","trace_id":"e10344c983bcbd051a1f85df68491c86","span_id":"063a3f53c9875690","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.464+0530","caller":"rest/oauth_handler.go:277","message":"Client credentials validation passed","request_id":"e10344c983bcbd051a1f85df68491c86","trace_id":"e10344c983bcbd051a1f85df68491c86","span_id":"063a3f53c9875690","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","client_id":"test-client-id","grant_type":"client_credentials","scope":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.485+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"e10344c983bcbd051a1f85df68491c86","trace_id":"e10344c983bcbd051a1f85df68491c86","span_id":"063a3f53c9875690","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"e10344c983bcbd051a1f85df68491c86","trace_id":"e10344c983bcbd051a1f85df68491c86","span_id":"063a3f53c9875690","user_id":"test-client-id","tenant_id":"","auth_method":"client_credentials","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.485+0530","caller":"rest/oauth_handler.go:310","message":"Business event","request_id":"e10344c983bcbd051a1f85df68491c86","trace_id":"e10344c983bcbd051a1f85df68491c86","span_id":"063a3f53c9875690","event_type":"client_credentials_success","user_id":"test-client-id","tenant_id":"","client_ip":"192.0.2.1:1234","scope":"","duration_ms":20}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.485+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"e10344c983bcbd051a1f85df68491c86","trace_id":"e10344c983bcbd051a1f85df68491c86","span_id":"063a3f53c9875690","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"e10344c983bcbd051a1f85df68491c86","trace_id":"e10344c983bcbd051a1f85df68491c86","span_id":"063a3f53c9875690","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.020753167}
=== RUN   TestOAuthHandler_Integration/CreateOneTimeToken
{"level":"INFO","timestamp":"2025-06-25T23:44:04.485+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"9f34a319ceed3dd94badc38c1e4db7a8","trace_id":"9f34a319ceed3dd94badc38c1e4db7a8","span_id":"5bf79d0d526ff2e5","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"9f34a319ceed3dd94badc38c1e4db7a8","trace_id":"9f34a319ceed3dd94badc38c1e4db7a8","span_id":"5bf79d0d526ff2e5","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.485+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"9f34a319ceed3dd94badc38c1e4db7a8","trace_id":"9f34a319ceed3dd94badc38c1e4db7a8","span_id":"5bf79d0d526ff2e5","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.485+0530","caller":"rest/oauth_handler.go:380","message":"One-time token validation passed","request_id":"9f34a319ceed3dd94badc38c1e4db7a8","trace_id":"9f34a319ceed3dd94badc38c1e4db7a8","span_id":"5bf79d0d526ff2e5","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","url":"https://app.example.com/survey/123","session_id":"survey-session-456","expires_in":0,"max_uses":0}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.501+0530","caller":"rest/oauth_handler.go:421","message":"Business event","request_id":"9f34a319ceed3dd94badc38c1e4db7a8","trace_id":"9f34a319ceed3dd94badc38c1e4db7a8","span_id":"5bf79d0d526ff2e5","event_type":"one_time_token_created","user_id":"","tenant_id":"","client_ip":"192.0.2.1:1234","duration_ms":16,"session_id":"survey-session-456","expires_in":0,"max_uses":0}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.501+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"9f34a319ceed3dd94badc38c1e4db7a8","trace_id":"9f34a319ceed3dd94badc38c1e4db7a8","span_id":"5bf79d0d526ff2e5","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"9f34a319ceed3dd94badc38c1e4db7a8","trace_id":"9f34a319ceed3dd94badc38c1e4db7a8","span_id":"5bf79d0d526ff2e5","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":201,"duration":0.016300583}
=== RUN   TestOAuthHandler_Integration/VerifyOneTimeToken
{"level":"INFO","timestamp":"2025-06-25T23:44:04.501+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"c4058288cf6a72f026e9860f5adea56d","trace_id":"c4058288cf6a72f026e9860f5adea56d","span_id":"3ee4d3dea593c119","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"c4058288cf6a72f026e9860f5adea56d","trace_id":"c4058288cf6a72f026e9860f5adea56d","span_id":"3ee4d3dea593c119","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.502+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"c4058288cf6a72f026e9860f5adea56d","trace_id":"c4058288cf6a72f026e9860f5adea56d","span_id":"3ee4d3dea593c119","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.502+0530","caller":"rest/oauth_handler.go:488","message":"One-time token verification validation passed","request_id":"c4058288cf6a72f026e9860f5adea56d","trace_id":"c4058288cf6a72f026e9860f5adea56d","span_id":"3ee4d3dea593c119","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","token_prefix":"one-time-t...","session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.513+0530","caller":"rest/oauth_handler.go:542","message":"Business event","request_id":"c4058288cf6a72f026e9860f5adea56d","trace_id":"c4058288cf6a72f026e9860f5adea56d","span_id":"3ee4d3dea593c119","event_type":"one_time_token_verified","user_id":"anonymous-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","is_valid":true,"duration_ms":11,"session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.513+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"c4058288cf6a72f026e9860f5adea56d","trace_id":"c4058288cf6a72f026e9860f5adea56d","span_id":"3ee4d3dea593c119","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"c4058288cf6a72f026e9860f5adea56d","trace_id":"c4058288cf6a72f026e9860f5adea56d","span_id":"3ee4d3dea593c119","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.011371084}
=== RUN   TestOAuthHandler_Integration/RefreshSession
{"level":"INFO","timestamp":"2025-06-25T23:44:04.513+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"f2f4dcbd85c31d271d884684aab66eb5","trace_id":"f2f4dcbd85c31d271d884684aab66eb5","span_id":"c16a76f356f83aac","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"f2f4dcbd85c31d271d884684aab66eb5","trace_id":"f2f4dcbd85c31d271d884684aab66eb5","span_id":"c16a76f356f83aac","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.513+0530","caller":"rest/oauth_handler.go:580","message":"Session refresh initiated","request_id":"f2f4dcbd85c31d271d884684aab66eb5","trace_id":"f2f4dcbd85c31d271d884684aab66eb5","span_id":"c16a76f356f83aac","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/oauth/refresh","method":"POST"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.513+0530","caller":"rest/oauth_handler.go:598","message":"Session refresh validation passed","request_id":"f2f4dcbd85c31d271d884684aab66eb5","trace_id":"f2f4dcbd85c31d271d884684aab66eb5","span_id":"c16a76f356f83aac","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","token_prefix":"one-time-t...","session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.522+0530","caller":"rest/oauth_handler.go:637","message":"Business event","request_id":"f2f4dcbd85c31d271d884684aab66eb5","trace_id":"f2f4dcbd85c31d271d884684aab66eb5","span_id":"c16a76f356f83aac","event_type":"session_refreshed","user_id":"anonymous-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","duration_ms":9}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.522+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"f2f4dcbd85c31d271d884684aab66eb5","trace_id":"f2f4dcbd85c31d271d884684aab66eb5","span_id":"c16a76f356f83aac","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"f2f4dcbd85c31d271d884684aab66eb5","trace_id":"f2f4dcbd85c31d271d884684aab66eb5","span_id":"c16a76f356f83aac","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.009246}
--- PASS: TestOAuthHandler_Integration (0.11s)
    --- PASS: TestOAuthHandler_Integration/GoogleLogin (0.00s)
    --- PASS: TestOAuthHandler_Integration/GoogleCallback (0.05s)
    --- PASS: TestOAuthHandler_Integration/ClientCredentials (0.02s)
    --- PASS: TestOAuthHandler_Integration/CreateOneTimeToken (0.02s)
    --- PASS: TestOAuthHandler_Integration/VerifyOneTimeToken (0.01s)
    --- PASS: TestOAuthHandler_Integration/RefreshSession (0.01s)
PASS
coverage: 94.6% of statements
ok  	auth-service/internal/handler/rest	1.101s	coverage: 94.6% of statements
=== RUN   TestNewLogger
--- PASS: TestNewLogger (0.00s)
=== RUN   TestLogger_WithRequest
--- PASS: TestLogger_WithRequest (0.00s)
=== RUN   TestLogger_WithRequest_NoHeaders
--- PASS: TestLogger_WithRequest_NoHeaders (0.00s)
=== RUN   TestRequestLogger_Methods
{"level":"INFO","timestamp":"2025-06-25T23:44:04.775+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"bba80b21825b82acb5cf464109c1f624","trace_id":"bba80b21825b82acb5cf464109c1f624","span_id":"3880e7500d6c2b03","method":"GET","path":"/test","client_ip":"192.0.2.1:1234","request_id":"bba80b21825b82acb5cf464109c1f624","trace_id":"bba80b21825b82acb5cf464109c1f624","span_id":"3880e7500d6c2b03","parent_span_id":"","method":"GET","path":"/test","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.775+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"bba80b21825b82acb5cf464109c1f624","trace_id":"bba80b21825b82acb5cf464109c1f624","span_id":"3880e7500d6c2b03","method":"GET","path":"/test","client_ip":"192.0.2.1:1234","request_id":"bba80b21825b82acb5cf464109c1f624","trace_id":"bba80b21825b82acb5cf464109c1f624","span_id":"3880e7500d6c2b03","parent_span_id":"","method":"GET","path":"/test","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.0000001}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.775+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"bba80b21825b82acb5cf464109c1f624","trace_id":"bba80b21825b82acb5cf464109c1f624","span_id":"3880e7500d6c2b03","method":"GET","path":"/test","client_ip":"192.0.2.1:1234","request_id":"bba80b21825b82acb5cf464109c1f624","trace_id":"bba80b21825b82acb5cf464109c1f624","span_id":"3880e7500d6c2b03","user_id":"user-123","tenant_id":"tenant-123","auth_method":"password","client_ip":"192.0.2.1:1234"}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.775+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"bba80b21825b82acb5cf464109c1f624","trace_id":"bba80b21825b82acb5cf464109c1f624","span_id":"3880e7500d6c2b03","method":"GET","path":"/test","client_ip":"192.0.2.1:1234","request_id":"bba80b21825b82acb5cf464109c1f624","trace_id":"bba80b21825b82acb5cf464109c1f624","span_id":"3880e7500d6c2b03","user_id":"user-123","tenant_id":"tenant-123","auth_method":"password","reason":"invalid_credentials","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/logger.TestRequestLogger_Methods\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger_test.go:94\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.776+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"bba80b21825b82acb5cf464109c1f624","trace_id":"bba80b21825b82acb5cf464109c1f624","span_id":"3880e7500d6c2b03","method":"GET","path":"/test","client_ip":"192.0.2.1:1234","request_id":"bba80b21825b82acb5cf464109c1f624","trace_id":"bba80b21825b82acb5cf464109c1f624","span_id":"3880e7500d6c2b03","provider":"google","step":"login_initiated","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.776+0530","caller":"logger/logger_test.go:98","message":"Security event","request_id":"bba80b21825b82acb5cf464109c1f624","trace_id":"bba80b21825b82acb5cf464109c1f624","span_id":"3880e7500d6c2b03","event_type":"login_attempt","user_id":"user-123","tenant_id":"tenant-123","details":"Multiple failed attempts","severity":"medium","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.TestRequestLogger_Methods\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger_test.go:98\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.776+0530","caller":"logger/logger_test.go:99","message":"Business event","request_id":"bba80b21825b82acb5cf464109c1f624","trace_id":"bba80b21825b82acb5cf464109c1f624","span_id":"3880e7500d6c2b03","event_type":"user_login","user_id":"user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","login_method":"password","success":true}
{"level":"INFO","timestamp":"2025-06-25T23:44:04.776+0530","caller":"logger/logger_test.go:103","message":"Test info message","request_id":"bba80b21825b82acb5cf464109c1f624","trace_id":"bba80b21825b82acb5cf464109c1f624","span_id":"3880e7500d6c2b03","method":"GET","path":"/test","client_ip":"192.0.2.1:1234"}
{"level":"WARN","timestamp":"2025-06-25T23:44:04.776+0530","caller":"logger/logger_test.go:104","message":"Test warning message","request_id":"bba80b21825b82acb5cf464109c1f624","trace_id":"bba80b21825b82acb5cf464109c1f624","span_id":"3880e7500d6c2b03","method":"GET","path":"/test","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.TestRequestLogger_Methods\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger_test.go:104\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-25T23:44:04.776+0530","caller":"logger/logger_test.go:105","message":"Test error message","request_id":"bba80b21825b82acb5cf464109c1f624","trace_id":"bba80b21825b82acb5cf464109c1f624","span_id":"3880e7500d6c2b03","method":"GET","path":"/test","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.TestRequestLogger_Methods\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger_test.go:105\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestRequestLogger_Methods (0.00s)
PASS
coverage: 62.7% of statements
ok  	auth-service/internal/logger	1.358s	coverage: 62.7% of statements
=== RUN   TestActuatorMiddleware
--- PASS: TestActuatorMiddleware (0.00s)
=== RUN   TestHealthCheckMiddleware
--- PASS: TestHealthCheckMiddleware (0.00s)
=== RUN   TestRBACMiddleware_UserHasPermission_Success
--- PASS: TestRBACMiddleware_UserHasPermission_Success (0.00s)
=== RUN   TestRBACMiddleware_UserDoesNotHavePermission
--- PASS: TestRBACMiddleware_UserDoesNotHavePermission (0.00s)
=== RUN   TestRBACMiddleware_MissingUserID
--- PASS: TestRBACMiddleware_MissingUserID (0.00s)
=== RUN   TestRBACMiddleware_MissingTenantID
--- PASS: TestRBACMiddleware_MissingTenantID (0.00s)
=== RUN   TestRBACMiddleware_RBACServiceError
--- PASS: TestRBACMiddleware_RBACServiceError (0.00s)
=== RUN   TestRBACMiddleware_DifferentPermissions
--- PASS: TestRBACMiddleware_DifferentPermissions (0.00s)
=== RUN   TestRBACMiddleware_DifferentUsers
--- PASS: TestRBACMiddleware_DifferentUsers (0.00s)
=== RUN   TestRBACMiddleware_DifferentTenants
--- PASS: TestRBACMiddleware_DifferentTenants (0.00s)
PASS
coverage: 56.2% of statements
ok  	auth-service/internal/middleware	1.596s	coverage: 56.2% of statements
=== RUN   TestRole_Structure
--- PASS: TestRole_Structure (0.00s)
=== RUN   TestRole_DefaultRole
--- PASS: TestRole_DefaultRole (0.00s)
=== RUN   TestPermission_Structure
--- PASS: TestPermission_Structure (0.00s)
=== RUN   TestRolePermission_Structure
--- PASS: TestRolePermission_Structure (0.00s)
=== RUN   TestUserRole_Structure
--- PASS: TestUserRole_Structure (0.00s)
=== RUN   TestServiceRole_Structure
--- PASS: TestServiceRole_Structure (0.00s)
=== RUN   TestRole_EmptyFields
--- PASS: TestRole_EmptyFields (0.00s)
=== RUN   TestPermission_EmptyFields
--- PASS: TestPermission_EmptyFields (0.00s)
=== RUN   TestRolePermission_EmptyFields
--- PASS: TestRolePermission_EmptyFields (0.00s)
=== RUN   TestUserRole_EmptyFields
--- PASS: TestUserRole_EmptyFields (0.00s)
=== RUN   TestServiceRole_EmptyFields
--- PASS: TestServiceRole_EmptyFields (0.00s)
=== RUN   TestRole_ComplexName
--- PASS: TestRole_ComplexName (0.00s)
=== RUN   TestPermission_ComplexName
--- PASS: TestPermission_ComplexName (0.00s)
=== RUN   TestRole_WithSpecialCharacters
--- PASS: TestRole_WithSpecialCharacters (0.00s)
=== RUN   TestPermission_WithSpecialCharacters
--- PASS: TestPermission_WithSpecialCharacters (0.00s)
=== RUN   TestRolePermission_WithSpecialCharacters
--- PASS: TestRolePermission_WithSpecialCharacters (0.00s)
=== RUN   TestUserRole_WithSpecialCharacters
--- PASS: TestUserRole_WithSpecialCharacters (0.00s)
=== RUN   TestServiceRole_WithSpecialCharacters
--- PASS: TestServiceRole_WithSpecialCharacters (0.00s)
=== RUN   TestRole_Validation
=== RUN   TestRole_Validation/Valid_role
=== RUN   TestRole_Validation/Empty_ID
=== RUN   TestRole_Validation/Empty_TenantID
=== RUN   TestRole_Validation/Empty_Name
--- PASS: TestRole_Validation (0.00s)
    --- PASS: TestRole_Validation/Valid_role (0.00s)
    --- PASS: TestRole_Validation/Empty_ID (0.00s)
    --- PASS: TestRole_Validation/Empty_TenantID (0.00s)
    --- PASS: TestRole_Validation/Empty_Name (0.00s)
=== RUN   TestPermission_Validation
=== RUN   TestPermission_Validation/Valid_permission
=== RUN   TestPermission_Validation/Empty_ID
=== RUN   TestPermission_Validation/Empty_Name
--- PASS: TestPermission_Validation (0.00s)
    --- PASS: TestPermission_Validation/Valid_permission (0.00s)
    --- PASS: TestPermission_Validation/Empty_ID (0.00s)
    --- PASS: TestPermission_Validation/Empty_Name (0.00s)
=== RUN   TestRolePermission_Validation
=== RUN   TestRolePermission_Validation/Valid_role_permission
=== RUN   TestRolePermission_Validation/Empty_RoleID
=== RUN   TestRolePermission_Validation/Empty_PermissionID
--- PASS: TestRolePermission_Validation (0.00s)
    --- PASS: TestRolePermission_Validation/Valid_role_permission (0.00s)
    --- PASS: TestRolePermission_Validation/Empty_RoleID (0.00s)
    --- PASS: TestRolePermission_Validation/Empty_PermissionID (0.00s)
=== RUN   TestUserRole_Validation
=== RUN   TestUserRole_Validation/Valid_user_role
=== RUN   TestUserRole_Validation/Empty_UserID
=== RUN   TestUserRole_Validation/Empty_RoleID
=== RUN   TestUserRole_Validation/Empty_TenantID
--- PASS: TestUserRole_Validation (0.00s)
    --- PASS: TestUserRole_Validation/Valid_user_role (0.00s)
    --- PASS: TestUserRole_Validation/Empty_UserID (0.00s)
    --- PASS: TestUserRole_Validation/Empty_RoleID (0.00s)
    --- PASS: TestUserRole_Validation/Empty_TenantID (0.00s)
=== RUN   TestServiceRole_Validation
=== RUN   TestServiceRole_Validation/Valid_service_role
=== RUN   TestServiceRole_Validation/Empty_ServiceID
=== RUN   TestServiceRole_Validation/Empty_RoleID
=== RUN   TestServiceRole_Validation/Empty_TenantID
--- PASS: TestServiceRole_Validation (0.00s)
    --- PASS: TestServiceRole_Validation/Valid_service_role (0.00s)
    --- PASS: TestServiceRole_Validation/Empty_ServiceID (0.00s)
    --- PASS: TestServiceRole_Validation/Empty_RoleID (0.00s)
    --- PASS: TestServiceRole_Validation/Empty_TenantID (0.00s)
PASS
coverage: [no statements]
ok  	auth-service/internal/models	0.731s	coverage: [no statements]
=== RUN   TestRBACService_AssignRoleToUser_Success
--- PASS: TestRBACService_AssignRoleToUser_Success (0.00s)
=== RUN   TestRBACService_AssignRoleToUser_Error
--- PASS: TestRBACService_AssignRoleToUser_Error (0.00s)
=== RUN   TestRBACService_AssignRoleToService_Success
--- PASS: TestRBACService_AssignRoleToService_Success (0.00s)
=== RUN   TestRBACService_AssignRoleToService_Error
--- PASS: TestRBACService_AssignRoleToService_Error (0.00s)
=== RUN   TestRBACService_AssignPermissionToRole_Success
--- PASS: TestRBACService_AssignPermissionToRole_Success (0.00s)
=== RUN   TestRBACService_AssignPermissionToRole_Error
--- PASS: TestRBACService_AssignPermissionToRole_Error (0.00s)
=== RUN   TestRBACService_UserHasPermission_Success
--- PASS: TestRBACService_UserHasPermission_Success (0.00s)
=== RUN   TestRBACService_UserHasPermission_NoPermission
--- PASS: TestRBACService_UserHasPermission_NoPermission (0.00s)
=== RUN   TestRBACService_UserHasPermission_Error
--- PASS: TestRBACService_UserHasPermission_Error (0.00s)
=== RUN   TestRBACService_ServiceHasPermission_Success
--- PASS: TestRBACService_ServiceHasPermission_Success (0.00s)
=== RUN   TestRBACService_ServiceHasPermission_NoPermission
--- PASS: TestRBACService_ServiceHasPermission_NoPermission (0.00s)
=== RUN   TestRBACService_ServiceHasPermission_Error
--- PASS: TestRBACService_ServiceHasPermission_Error (0.00s)
=== RUN   TestRBACService_GetUserRoles_Success
--- PASS: TestRBACService_GetUserRoles_Success (0.00s)
=== RUN   TestRBACService_GetUserRoles_Error
--- PASS: TestRBACService_GetUserRoles_Error (0.00s)
=== RUN   TestRBACService_GetRolePermissions_Success
--- PASS: TestRBACService_GetRolePermissions_Success (0.00s)
=== RUN   TestRBACService_GetRolePermissions_Error
--- PASS: TestRBACService_GetRolePermissions_Error (0.00s)
=== RUN   TestRBACService_Integration_UserRoleAssignment
--- PASS: TestRBACService_Integration_UserRoleAssignment (0.00s)
=== RUN   TestRBACService_Integration_ServiceRoleAssignment
--- PASS: TestRBACService_Integration_ServiceRoleAssignment (0.00s)
PASS
coverage: [no statements]
ok  	auth-service/internal/service	1.944s	coverage: [no statements]
=== RUN   TestExtractTracingFromRequest_StandardHeaders
--- PASS: TestExtractTracingFromRequest_StandardHeaders (0.00s)
=== RUN   TestExtractTracingFromRequest_XRayHeaders
--- PASS: TestExtractTracingFromRequest_XRayHeaders (0.00s)
=== RUN   TestExtractTracingFromRequest_CloudTraceHeaders
--- PASS: TestExtractTracingFromRequest_CloudTraceHeaders (0.00s)
=== RUN   TestExtractTracingFromRequest_RequestIDFallback
--- PASS: TestExtractTracingFromRequest_RequestIDFallback (0.00s)
=== RUN   TestExtractTracingFromRequest_NoHeaders
--- PASS: TestExtractTracingFromRequest_NoHeaders (0.00s)
=== RUN   TestExtractXRayTraceID
=== RUN   TestExtractXRayTraceID/valid_xray_header
=== RUN   TestExtractXRayTraceID/xray_header_without_parent
=== RUN   TestExtractXRayTraceID/invalid_xray_header
=== RUN   TestExtractXRayTraceID/empty_header
--- PASS: TestExtractXRayTraceID (0.00s)
    --- PASS: TestExtractXRayTraceID/valid_xray_header (0.00s)
    --- PASS: TestExtractXRayTraceID/xray_header_without_parent (0.00s)
    --- PASS: TestExtractXRayTraceID/invalid_xray_header (0.00s)
    --- PASS: TestExtractXRayTraceID/empty_header (0.00s)
=== RUN   TestExtractXRaySpanID
=== RUN   TestExtractXRaySpanID/valid_xray_header_with_parent
=== RUN   TestExtractXRaySpanID/xray_header_without_parent
=== RUN   TestExtractXRaySpanID/invalid_xray_header
--- PASS: TestExtractXRaySpanID (0.00s)
    --- PASS: TestExtractXRaySpanID/valid_xray_header_with_parent (0.00s)
    --- PASS: TestExtractXRaySpanID/xray_header_without_parent (0.00s)
    --- PASS: TestExtractXRaySpanID/invalid_xray_header (0.00s)
=== RUN   TestExtractCloudTraceID
=== RUN   TestExtractCloudTraceID/valid_cloud_trace_header
=== RUN   TestExtractCloudTraceID/cloud_trace_header_without_span
=== RUN   TestExtractCloudTraceID/invalid_cloud_trace_header
=== RUN   TestExtractCloudTraceID/empty_header
--- PASS: TestExtractCloudTraceID (0.00s)
    --- PASS: TestExtractCloudTraceID/valid_cloud_trace_header (0.00s)
    --- PASS: TestExtractCloudTraceID/cloud_trace_header_without_span (0.00s)
    --- PASS: TestExtractCloudTraceID/invalid_cloud_trace_header (0.00s)
    --- PASS: TestExtractCloudTraceID/empty_header (0.00s)
=== RUN   TestGenerateTraceID
--- PASS: TestGenerateTraceID (0.00s)
=== RUN   TestGenerateSpanID
--- PASS: TestGenerateSpanID (0.00s)
=== RUN   TestAddTracingHeaders
--- PASS: TestAddTracingHeaders (0.00s)
=== RUN   TestGetTracingContextFromContext
--- PASS: TestGetTracingContextFromContext (0.00s)
=== RUN   TestCreateSpan
--- PASS: TestCreateSpan (0.00s)
=== RUN   TestPropagateTracing
--- PASS: TestPropagateTracing (0.00s)
=== RUN   TestTracingContext_String
--- PASS: TestTracingContext_String (0.00s)
=== RUN   TestExtractTracingFromRequest_PriorityOrder
--- PASS: TestExtractTracingFromRequest_PriorityOrder (0.00s)
=== RUN   TestExtractTracingFromRequest_RequestIDPriority
--- PASS: TestExtractTracingFromRequest_RequestIDPriority (0.00s)
PASS
coverage: 89.7% of statements
ok  	auth-service/internal/tracing	1.755s	coverage: 89.7% of statements
