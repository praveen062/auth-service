	auth-service/docs		coverage: 0.0% of statements
=== RUN   TestMain_LoadConfig_Success
--- PASS: TestMain_LoadConfig_Success (0.00s)
=== RUN   TestMain_LoadConfig_FileNotFound
--- PASS: TestMain_LoadConfig_FileNotFound (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_AllowedIP
--- PASS: TestMain_IPAllowlistMiddleware_AllowedIP (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_BlockedIP
--- PASS: TestMain_IPAllowlistMiddleware_BlockedIP (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_IPv6Allowed
--- PASS: TestMain_IPAllowlistMiddleware_IPv6Allowed (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_EmptyAllowedIPs
--- PASS: TestMain_IPAllowlistMiddleware_EmptyAllowedIPs (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_ProxyHeaders
--- PASS: TestMain_IPAllowlistMiddleware_ProxyHeaders (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_RealIPHeader
--- PASS: TestMain_IPAllowlistMiddleware_RealIPHeader (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_MultipleForwardedIPs
--- PASS: TestMain_IPAllowlistMiddleware_MultipleForwardedIPs (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_InvalidIP
--- PASS: TestMain_IPAllowlistMiddleware_InvalidIP (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_SubnetMatching
--- PASS: TestMain_IPAllowlistMiddleware_SubnetMatching (0.00s)
=== RUN   TestMain_IPAllowlistMiddleware_SubnetBlocked
--- PASS: TestMain_IPAllowlistMiddleware_SubnetBlocked (0.00s)
=== RUN   TestMain_ConfigurationValidation
--- PASS: TestMain_ConfigurationValidation (0.00s)
=== RUN   TestMain_DatabaseDSN_Generation
--- PASS: TestMain_DatabaseDSN_Generation (0.00s)
=== RUN   TestMain_RedisAddr_Generation
--- PASS: TestMain_RedisAddr_Generation (0.00s)
=== RUN   TestMain_EnvironmentVariableOverride
--- PASS: TestMain_EnvironmentVariableOverride (0.00s)
=== RUN   TestIPAllowlistMiddleware_AllowedIP
--- PASS: TestIPAllowlistMiddleware_AllowedIP (0.00s)
=== RUN   TestIPAllowlistMiddleware_AllowedIPWithPort
--- PASS: TestIPAllowlistMiddleware_AllowedIPWithPort (0.00s)
=== RUN   TestIPAllowlistMiddleware_AllowedIPSubnet
--- PASS: TestIPAllowlistMiddleware_AllowedIPSubnet (0.00s)
=== RUN   TestIPAllowlistMiddleware_DisallowedIP
--- PASS: TestIPAllowlistMiddleware_DisallowedIP (0.00s)
=== RUN   TestIPAllowlistMiddleware_EmptyAllowedIPs
--- PASS: TestIPAllowlistMiddleware_EmptyAllowedIPs (0.00s)
=== RUN   TestIPAllowlistMiddleware_NoRemoteAddr
--- PASS: TestIPAllowlistMiddleware_NoRemoteAddr (0.00s)
=== RUN   TestIPAllowlistMiddleware_IPv6Allowed
--- PASS: TestIPAllowlistMiddleware_IPv6Allowed (0.00s)
=== RUN   TestIPAllowlistMiddleware_IPv6Disallowed
--- PASS: TestIPAllowlistMiddleware_IPv6Disallowed (0.00s)
=== RUN   TestIPAllowlistMiddleware_MultipleAllowedIPs
--- PASS: TestIPAllowlistMiddleware_MultipleAllowedIPs (0.00s)
=== RUN   TestIPAllowlistMiddleware_InvalidIPFormat
--- PASS: TestIPAllowlistMiddleware_InvalidIPFormat (0.00s)
=== RUN   TestIPAllowlistMiddleware_EmptyRemoteAddr
--- PASS: TestIPAllowlistMiddleware_EmptyRemoteAddr (0.00s)
=== RUN   TestIPAllowlistMiddleware_Integration
=== RUN   TestIPAllowlistMiddleware_Integration/Allowed_IPv4
=== RUN   TestIPAllowlistMiddleware_Integration/Allowed_IPv4_Subnet
=== RUN   TestIPAllowlistMiddleware_Integration/Allowed_IPv6
=== RUN   TestIPAllowlistMiddleware_Integration/Disallowed_IPv4
=== RUN   TestIPAllowlistMiddleware_Integration/Disallowed_IPv6
=== RUN   TestIPAllowlistMiddleware_Integration/Empty_Remote_Addr
=== RUN   TestIPAllowlistMiddleware_Integration/Invalid_Format
--- PASS: TestIPAllowlistMiddleware_Integration (0.00s)
    --- PASS: TestIPAllowlistMiddleware_Integration/Allowed_IPv4 (0.00s)
    --- PASS: TestIPAllowlistMiddleware_Integration/Allowed_IPv4_Subnet (0.00s)
    --- PASS: TestIPAllowlistMiddleware_Integration/Allowed_IPv6 (0.00s)
    --- PASS: TestIPAllowlistMiddleware_Integration/Disallowed_IPv4 (0.00s)
    --- PASS: TestIPAllowlistMiddleware_Integration/Disallowed_IPv6 (0.00s)
    --- PASS: TestIPAllowlistMiddleware_Integration/Empty_Remote_Addr (0.00s)
    --- PASS: TestIPAllowlistMiddleware_Integration/Invalid_Format (0.00s)
=== RUN   TestMain_HandlerSetup
{"level":"INFO","timestamp":"2025-06-26T13:02:14.682+0530","caller":"rest/auth_handler.go:95","message":"Login attempt started","request_id":"9acc573a32682ac2baa992db2e43108a","trace_id":"9acc573a32682ac2baa992db2e43108a","span_id":"885d0b29a5dc4d7c","method":"POST","path":"/api/v1/auth/login","client_ip":"","endpoint":"/auth/login","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.682+0530","caller":"rest/auth_handler.go:149","message":"Login validation passed","request_id":"9acc573a32682ac2baa992db2e43108a","trace_id":"9acc573a32682ac2baa992db2e43108a","span_id":"885d0b29a5dc4d7c","method":"POST","path":"/api/v1/auth/login","client_ip":"","email":"test@example.com","tenant_id":"test-tenant","tenant_name":"Test Tenant"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.699+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"9acc573a32682ac2baa992db2e43108a","trace_id":"9acc573a32682ac2baa992db2e43108a","span_id":"885d0b29a5dc4d7c","method":"POST","path":"/api/v1/auth/login","client_ip":"","request_id":"9acc573a32682ac2baa992db2e43108a","trace_id":"9acc573a32682ac2baa992db2e43108a","span_id":"885d0b29a5dc4d7c","user_id":"user-123","tenant_id":"test-tenant","auth_method":"password","client_ip":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.699+0530","caller":"rest/auth_handler.go:187","message":"Business event","request_id":"9acc573a32682ac2baa992db2e43108a","trace_id":"9acc573a32682ac2baa992db2e43108a","span_id":"885d0b29a5dc4d7c","event_type":"user_login","user_id":"user-123","tenant_id":"test-tenant","client_ip":"","tenant_name":"Test Tenant","tenant_plan":"pro","login_method":"password","roles":["user"],"duration_ms":17}
--- PASS: TestMain_HandlerSetup (0.02s)
=== RUN   TestMain_ServerSetup
{"level":"INFO","timestamp":"2025-06-26T13:02:14.700+0530","caller":"server/main_test.go:1011","message":"Health check registered","name":"memory"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.700+0530","caller":"server/main_test.go:1012","message":"Health check registered","name":"goroutines"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.700+0530","caller":"server/main_test.go:1013","message":"Health check registered","name":"disk"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.700+0530","caller":"server/main_test.go:1021","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestMain_ServerSetup (0.00s)
=== RUN   TestMain_ActuatorSetup
{"level":"INFO","timestamp":"2025-06-26T13:02:14.700+0530","caller":"server/main_test.go:1084","message":"Health check registered","name":"memory"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.700+0530","caller":"server/main_test.go:1085","message":"Health check registered","name":"goroutines"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.700+0530","caller":"server/main_test.go:1086","message":"Health check registered","name":"disk"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.700+0530","caller":"server/main_test.go:1094","message":"Actuator routes registered","base_path":"/actuator"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.700+0530","caller":"actuator/actuator.go:194","message":"Application info request received","request_id":"a4f7d5b3ef38174b05b07058827e3ed5","trace_id":"a4f7d5b3ef38174b05b07058827e3ed5","span_id":"11263f30319e9157","method":"GET","path":"/actuator/info","client_ip":""}
--- PASS: TestMain_ActuatorSetup (0.00s)
=== RUN   TestMain_SwaggerSetup
--- PASS: TestMain_SwaggerSetup (0.00s)
=== RUN   TestMain_ErrorHandling
--- PASS: TestMain_ErrorHandling (0.00s)
=== RUN   TestMain_AddressGeneration
--- PASS: TestMain_AddressGeneration (0.00s)
=== RUN   TestMain_PrintfStatements
--- PASS: TestMain_PrintfStatements (0.00s)
PASS
coverage: 12.7% of statements
ok  	auth-service/cmd/server	1.151s	coverage: 12.7% of statements
=== RUN   TestNewActuator
--- PASS: TestNewActuator (0.00s)
=== RUN   TestActuator_Info
{"level":"INFO","timestamp":"2025-06-26T13:02:14.275+0530","caller":"actuator/actuator_test.go:47","message":"Actuator routes registered","base_path":"/actuator"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.275+0530","caller":"actuator/actuator.go:194","message":"Application info request received","request_id":"3c6afc0774e6d508e2dde298d4142ccd","trace_id":"3c6afc0774e6d508e2dde298d4142ccd","span_id":"94197698f2093c01","method":"GET","path":"/actuator/info","client_ip":""}
--- PASS: TestActuator_Info (0.00s)
=== RUN   TestActuator_Health
{"level":"INFO","timestamp":"2025-06-26T13:02:14.275+0530","caller":"actuator/actuator_test.go:70","message":"Actuator routes registered","base_path":"/actuator"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.275+0530","caller":"actuator/actuator.go:157","message":"Health check request received","request_id":"9bf9d6e7cda22de1e6890f0c60b4e965","trace_id":"9bf9d6e7cda22de1e6890f0c60b4e965","span_id":"ea7e5f8ef471a154","method":"GET","path":"/actuator/health","client_ip":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.275+0530","caller":"actuator/actuator.go:162","message":"Business event","request_id":"9bf9d6e7cda22de1e6890f0c60b4e965","trace_id":"9bf9d6e7cda22de1e6890f0c60b4e965","span_id":"ea7e5f8ef471a154","event_type":"health_check","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/health"}
--- PASS: TestActuator_Health (0.00s)
=== RUN   TestActuator_Liveness
{"level":"INFO","timestamp":"2025-06-26T13:02:14.275+0530","caller":"actuator/actuator_test.go:84","message":"Actuator routes registered","base_path":"/actuator"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.275+0530","caller":"actuator/actuator.go:170","message":"Liveness check request received","request_id":"1a8d75a154ea0509a68193c41f782e74","trace_id":"1a8d75a154ea0509a68193c41f782e74","span_id":"6927cbdccfadce5c","method":"GET","path":"/actuator/health/live","client_ip":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.275+0530","caller":"actuator/actuator.go:174","message":"Business event","request_id":"1a8d75a154ea0509a68193c41f782e74","trace_id":"1a8d75a154ea0509a68193c41f782e74","span_id":"6927cbdccfadce5c","event_type":"liveness_check","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/health/live"}
--- PASS: TestActuator_Liveness (0.00s)
=== RUN   TestActuator_Readiness
{"level":"INFO","timestamp":"2025-06-26T13:02:14.275+0530","caller":"actuator/actuator_test.go:98","message":"Actuator routes registered","base_path":"/actuator"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.275+0530","caller":"actuator/actuator.go:182","message":"Readiness check request received","request_id":"676c6bf7c5ce32146e3810305343d661","trace_id":"676c6bf7c5ce32146e3810305343d661","span_id":"dca183ab3bf05b56","method":"GET","path":"/actuator/health/ready","client_ip":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.275+0530","caller":"actuator/actuator.go:186","message":"Business event","request_id":"676c6bf7c5ce32146e3810305343d661","trace_id":"676c6bf7c5ce32146e3810305343d661","span_id":"dca183ab3bf05b56","event_type":"readiness_check","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/health/ready"}
--- PASS: TestActuator_Readiness (0.00s)
=== RUN   TestActuator_Environment
{"level":"INFO","timestamp":"2025-06-26T13:02:14.275+0530","caller":"actuator/actuator_test.go:112","message":"Actuator routes registered","base_path":"/actuator"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.275+0530","caller":"actuator/actuator.go:202","message":"Environment info request received","request_id":"25c590365ef58f77a6c9171048e8947f","trace_id":"25c590365ef58f77a6c9171048e8947f","span_id":"06a51e48dd193961","method":"GET","path":"/actuator/env","client_ip":""}
--- PASS: TestActuator_Environment (0.00s)
=== RUN   TestActuator_Metrics
{"level":"INFO","timestamp":"2025-06-26T13:02:14.276+0530","caller":"actuator/actuator_test.go:136","message":"Actuator routes registered","base_path":"/actuator"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.276+0530","caller":"actuator/actuator.go:220","message":"Metrics request received","request_id":"2fa2043fc74596ef0cfab810786e2659","trace_id":"2fa2043fc74596ef0cfab810786e2659","span_id":"6696e0824bbd0925","method":"GET","path":"/actuator/metrics","client_ip":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.276+0530","caller":"actuator/actuator.go:230","message":"Business event","request_id":"2fa2043fc74596ef0cfab810786e2659","trace_id":"2fa2043fc74596ef0cfab810786e2659","span_id":"6696e0824bbd0925","event_type":"metrics_request","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/metrics"}
--- PASS: TestActuator_Metrics (0.00s)
=== RUN   TestActuator_PrometheusMetrics
{"level":"INFO","timestamp":"2025-06-26T13:02:14.276+0530","caller":"actuator/actuator_test.go:160","message":"Actuator routes registered","base_path":"/actuator"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.276+0530","caller":"actuator/actuator.go:240","message":"Prometheus metrics request received","request_id":"17cdbd327a23ad5fb11a839d07a09119","trace_id":"17cdbd327a23ad5fb11a839d07a09119","span_id":"608a1d8ca20a9714","method":"GET","path":"/actuator/prometheus","client_ip":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.276+0530","caller":"actuator/actuator.go:245","message":"Business event","request_id":"17cdbd327a23ad5fb11a839d07a09119","trace_id":"17cdbd327a23ad5fb11a839d07a09119","span_id":"608a1d8ca20a9714","event_type":"prometheus_metrics_request","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/prometheus"}
--- PASS: TestActuator_PrometheusMetrics (0.00s)
=== RUN   TestActuator_Status
{"level":"INFO","timestamp":"2025-06-26T13:02:14.276+0530","caller":"actuator/actuator_test.go:175","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_Status (0.00s)
=== RUN   TestActuator_Uptime
{"level":"INFO","timestamp":"2025-06-26T13:02:14.276+0530","caller":"actuator/actuator_test.go:201","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_Uptime (0.00s)
=== RUN   TestActuator_ThreadDump
{"level":"INFO","timestamp":"2025-06-26T13:02:14.276+0530","caller":"actuator/actuator_test.go:224","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_ThreadDump (0.00s)
=== RUN   TestActuator_HeapDump
{"level":"INFO","timestamp":"2025-06-26T13:02:14.276+0530","caller":"actuator/actuator_test.go:246","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_HeapDump (0.00s)
=== RUN   TestActuator_Mappings
{"level":"INFO","timestamp":"2025-06-26T13:02:14.276+0530","caller":"actuator/actuator_test.go:275","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_Mappings (0.00s)
=== RUN   TestActuator_Loggers
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator_test.go:308","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_Loggers (0.00s)
=== RUN   TestActuator_SetLoggerLevel
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator_test.go:329","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_SetLoggerLevel (0.00s)
=== RUN   TestActuator_RecordRequest
--- PASS: TestActuator_RecordRequest (0.00s)
=== RUN   TestActuator_StartEndRequest
--- PASS: TestActuator_StartEndRequest (0.00s)
=== RUN   TestActuator_GetMemoryStats
--- PASS: TestActuator_GetMemoryStats (0.00s)
=== RUN   TestActuator_GetRuntimeStats
--- PASS: TestActuator_GetRuntimeStats (0.00s)
=== RUN   TestActuator_GetRequestStats
--- PASS: TestActuator_GetRequestStats (0.00s)
=== RUN   TestActuator_RegisterHealthCheck
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator_test.go:416","message":"Health check registered","name":"test-check"}
--- PASS: TestActuator_RegisterHealthCheck (0.00s)
=== RUN   TestActuator_RegisterReadinessCheck
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator_test.go:429","message":"Readiness check registered","name":"test-readiness"}
--- PASS: TestActuator_RegisterReadinessCheck (0.00s)
=== RUN   TestActuator_ConfigProps
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator_test.go:452","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_ConfigProps (0.00s)
=== RUN   TestActuator_SetLoggerLevel_Success
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator_test.go:478","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_SetLoggerLevel_Success (0.00s)
=== RUN   TestActuator_SetLoggerLevel_InvalidJSON
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator_test.go:502","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_SetLoggerLevel_InvalidJSON (0.00s)
=== RUN   TestActuator_SetLoggerLevel_EmptyBody
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator_test.go:524","message":"Actuator routes registered","base_path":"/actuator"}
--- PASS: TestActuator_SetLoggerLevel_EmptyBody (0.00s)
=== RUN   TestActuator_RegisterRoutes_AllEndpoints
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator_test.go:546","message":"Actuator routes registered","base_path":"/actuator"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator.go:157","message":"Health check request received","request_id":"a66f6c7e05e802039022c3eb4e1a398e","trace_id":"a66f6c7e05e802039022c3eb4e1a398e","span_id":"6e5fc9597f8b8a49","method":"GET","path":"/actuator/health","client_ip":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator.go:162","message":"Business event","request_id":"a66f6c7e05e802039022c3eb4e1a398e","trace_id":"a66f6c7e05e802039022c3eb4e1a398e","span_id":"6e5fc9597f8b8a49","event_type":"health_check","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/health"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator.go:170","message":"Liveness check request received","request_id":"5d62563382f73d5dbcd81af16f21770f","trace_id":"5d62563382f73d5dbcd81af16f21770f","span_id":"ad80938371b382d8","method":"GET","path":"/actuator/health/live","client_ip":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator.go:174","message":"Business event","request_id":"5d62563382f73d5dbcd81af16f21770f","trace_id":"5d62563382f73d5dbcd81af16f21770f","span_id":"ad80938371b382d8","event_type":"liveness_check","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/health/live"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator.go:182","message":"Readiness check request received","request_id":"fa9e1187890b927baf232dd98df3edca","trace_id":"fa9e1187890b927baf232dd98df3edca","span_id":"8d32a5a24d6f9182","method":"GET","path":"/actuator/health/ready","client_ip":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator.go:186","message":"Business event","request_id":"fa9e1187890b927baf232dd98df3edca","trace_id":"fa9e1187890b927baf232dd98df3edca","span_id":"8d32a5a24d6f9182","event_type":"readiness_check","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/health/ready"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator.go:194","message":"Application info request received","request_id":"fb8003b8f533f75e2d849f3c68dc2cb0","trace_id":"fb8003b8f533f75e2d849f3c68dc2cb0","span_id":"d50ad3528cf3f6a8","method":"GET","path":"/actuator/info","client_ip":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator.go:202","message":"Environment info request received","request_id":"e63b7e93972c89042dc22783977ec18c","trace_id":"e63b7e93972c89042dc22783977ec18c","span_id":"2eaf0e3b0e51d09b","method":"GET","path":"/actuator/env","client_ip":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator.go:220","message":"Metrics request received","request_id":"f5d7a91704b4221d23f288470f567e11","trace_id":"f5d7a91704b4221d23f288470f567e11","span_id":"74a3ae700078dbd4","method":"GET","path":"/actuator/metrics","client_ip":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator.go:230","message":"Business event","request_id":"f5d7a91704b4221d23f288470f567e11","trace_id":"f5d7a91704b4221d23f288470f567e11","span_id":"74a3ae700078dbd4","event_type":"metrics_request","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/metrics"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator.go:240","message":"Prometheus metrics request received","request_id":"d0512aa6ad3ed82da805ba59070411ca","trace_id":"d0512aa6ad3ed82da805ba59070411ca","span_id":"f6370e163dc4de19","method":"GET","path":"/actuator/prometheus","client_ip":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.277+0530","caller":"actuator/actuator.go:245","message":"Business event","request_id":"d0512aa6ad3ed82da805ba59070411ca","trace_id":"d0512aa6ad3ed82da805ba59070411ca","span_id":"f6370e163dc4de19","event_type":"prometheus_metrics_request","user_id":"","tenant_id":"","client_ip":"","endpoint":"/actuator/prometheus"}
--- PASS: TestActuator_RegisterRoutes_AllEndpoints (0.00s)
=== RUN   TestActuator_RecordRequest_WithMetrics
--- PASS: TestActuator_RecordRequest_WithMetrics (0.00s)
=== RUN   TestActuator_AppInfo_WithProperties
--- PASS: TestActuator_AppInfo_WithProperties (0.00s)
=== RUN   TestActuator_NewActuator_WithNilAppInfo
--- PASS: TestActuator_NewActuator_WithNilAppInfo (0.00s)
=== RUN   TestActuator_GetMemoryStats_Detailed
--- PASS: TestActuator_GetMemoryStats_Detailed (0.00s)
=== RUN   TestActuator_GetRuntimeStats_Detailed
--- PASS: TestActuator_GetRuntimeStats_Detailed (0.00s)
=== RUN   TestActuator_GetRequestStats_Detailed
--- PASS: TestActuator_GetRequestStats_Detailed (0.00s)
=== RUN   TestDatabaseHealthCheck_Success
--- PASS: TestDatabaseHealthCheck_Success (0.00s)
=== RUN   TestDatabaseHealthCheck_WithTimeout
--- PASS: TestDatabaseHealthCheck_WithTimeout (0.00s)
=== RUN   TestRedisHealthCheck_Success
--- PASS: TestRedisHealthCheck_Success (0.00s)
=== RUN   TestRedisHealthCheck_WithNilClient
--- PASS: TestRedisHealthCheck_WithNilClient (0.00s)
=== RUN   TestDiskSpaceHealthCheck_Success
--- PASS: TestDiskSpaceHealthCheck_Success (0.00s)
=== RUN   TestDiskSpaceHealthCheck_WithZeroSpace
--- PASS: TestDiskSpaceHealthCheck_WithZeroSpace (0.00s)
=== RUN   TestDiskSpaceHealthCheck_WithNegativeSpace
--- PASS: TestDiskSpaceHealthCheck_WithNegativeSpace (0.00s)
=== RUN   TestMemoryHealthCheck_Success
--- PASS: TestMemoryHealthCheck_Success (0.00s)
=== RUN   TestMemoryHealthCheck_WithLowThreshold
--- PASS: TestMemoryHealthCheck_WithLowThreshold (0.00s)
=== RUN   TestMemoryHealthCheck_WithZeroThreshold
--- PASS: TestMemoryHealthCheck_WithZeroThreshold (0.00s)
=== RUN   TestMemoryHealthCheck_WithNegativeThreshold
--- PASS: TestMemoryHealthCheck_WithNegativeThreshold (0.00s)
=== RUN   TestGoroutineHealthCheck_Success
--- PASS: TestGoroutineHealthCheck_Success (0.00s)
=== RUN   TestGoroutineHealthCheck_WithLowThreshold
--- PASS: TestGoroutineHealthCheck_WithLowThreshold (0.00s)
=== RUN   TestGoroutineHealthCheck_WithZeroThreshold
--- PASS: TestGoroutineHealthCheck_WithZeroThreshold (0.00s)
=== RUN   TestGoroutineHealthCheck_WithNegativeThreshold
--- PASS: TestGoroutineHealthCheck_WithNegativeThreshold (0.00s)
=== RUN   TestCustomHealthCheck_Success
--- PASS: TestCustomHealthCheck_Success (0.00s)
=== RUN   TestCustomHealthCheck_WithError
--- PASS: TestCustomHealthCheck_WithError (0.00s)
=== RUN   TestCustomHealthCheck_WithNilFunction
--- PASS: TestCustomHealthCheck_WithNilFunction (0.00s)
=== RUN   TestTimeoutHealthCheck_Success
--- PASS: TestTimeoutHealthCheck_Success (0.01s)
=== RUN   TestTimeoutHealthCheck_WithError
--- PASS: TestTimeoutHealthCheck_WithError (0.01s)
=== RUN   TestTimeoutHealthCheck_WithTimeout
--- PASS: TestTimeoutHealthCheck_WithTimeout (0.05s)
=== RUN   TestTimeoutHealthCheck_WithZeroTimeout
--- PASS: TestTimeoutHealthCheck_WithZeroTimeout (0.00s)
=== RUN   TestTimeoutHealthCheck_WithNegativeTimeout
--- PASS: TestTimeoutHealthCheck_WithNegativeTimeout (0.00s)
=== RUN   TestTimeoutHealthCheck_WithNilCheck
--- PASS: TestTimeoutHealthCheck_WithNilCheck (0.00s)
=== RUN   TestMemoryHealthCheck_Calculation
--- PASS: TestMemoryHealthCheck_Calculation (0.00s)
=== RUN   TestHealthCheck_Integration
=== RUN   TestHealthCheck_Integration/memory
=== RUN   TestHealthCheck_Integration/goroutines
=== RUN   TestHealthCheck_Integration/disk
=== RUN   TestHealthCheck_Integration/redis
=== RUN   TestHealthCheck_Integration/custom
--- PASS: TestHealthCheck_Integration (0.00s)
    --- PASS: TestHealthCheck_Integration/memory (0.00s)
    --- PASS: TestHealthCheck_Integration/goroutines (0.00s)
    --- PASS: TestHealthCheck_Integration/disk (0.00s)
    --- PASS: TestHealthCheck_Integration/redis (0.00s)
    --- PASS: TestHealthCheck_Integration/custom (0.00s)
PASS
coverage: 96.7% of statements
ok  	auth-service/internal/actuator	0.802s	coverage: 96.7% of statements
=== RUN   TestLoadConfig_Success
--- PASS: TestLoadConfig_Success (0.00s)
=== RUN   TestLoadConfig_FileNotFound
--- PASS: TestLoadConfig_FileNotFound (0.00s)
=== RUN   TestLoadConfig_InvalidYAML
--- PASS: TestLoadConfig_InvalidYAML (0.00s)
=== RUN   TestLoadConfig_WithEnvironmentVariables
--- PASS: TestLoadConfig_WithEnvironmentVariables (0.00s)
=== RUN   TestLoadConfig_DefaultValues
--- PASS: TestLoadConfig_DefaultValues (0.00s)
=== RUN   TestDatabaseConfig_GetDSN
--- PASS: TestDatabaseConfig_GetDSN (0.00s)
=== RUN   TestDatabaseConfig_GetDSN_WithSSL
--- PASS: TestDatabaseConfig_GetDSN_WithSSL (0.00s)
=== RUN   TestRedisConfig_GetRedisAddr
--- PASS: TestRedisConfig_GetRedisAddr (0.00s)
=== RUN   TestRedisConfig_GetRedisAddr_CustomHost
--- PASS: TestRedisConfig_GetRedisAddr_CustomHost (0.00s)
=== RUN   TestConfig_Validation
--- PASS: TestConfig_Validation (0.00s)
=== RUN   TestConfig_CompleteConfiguration
--- PASS: TestConfig_CompleteConfiguration (0.00s)
=== RUN   TestLoadConfig_WithAllEnvironmentVariables
--- PASS: TestLoadConfig_WithAllEnvironmentVariables (0.00s)
=== RUN   TestLoadConfig_WithInvalidEnvironmentVariables
--- PASS: TestLoadConfig_WithInvalidEnvironmentVariables (0.00s)
=== RUN   TestLoadConfig_WithZeroEnvironmentVariables
--- PASS: TestLoadConfig_WithZeroEnvironmentVariables (0.00s)
=== RUN   TestDatabaseConfig_GetDSN_WithAllFields
--- PASS: TestDatabaseConfig_GetDSN_WithAllFields (0.00s)
=== RUN   TestRedisConfig_GetRedisAddr_WithPassword
--- PASS: TestRedisConfig_GetRedisAddr_WithPassword (0.00s)
=== RUN   TestRedisConfig_GetRedisAddr_WithCustomPort
--- PASS: TestRedisConfig_GetRedisAddr_WithCustomPort (0.00s)
=== RUN   TestConfig_DefaultValues_Comprehensive
--- PASS: TestConfig_DefaultValues_Comprehensive (0.00s)
PASS
coverage: 85.5% of statements
ok  	auth-service/internal/config	1.819s	coverage: 85.5% of statements
=== RUN   TestAuthHandler_Login_Success
{"level":"INFO","timestamp":"2025-06-26T13:02:14.944+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"3ac0f8afed0a14a1d83ca294f4fd8c20","trace_id":"3ac0f8afed0a14a1d83ca294f4fd8c20","span_id":"71952352883a7faa","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"3ac0f8afed0a14a1d83ca294f4fd8c20","trace_id":"3ac0f8afed0a14a1d83ca294f4fd8c20","span_id":"71952352883a7faa","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.944+0530","caller":"rest/auth_handler.go:95","message":"Login attempt started","request_id":"3ac0f8afed0a14a1d83ca294f4fd8c20","trace_id":"3ac0f8afed0a14a1d83ca294f4fd8c20","span_id":"71952352883a7faa","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","endpoint":"/auth/login","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.944+0530","caller":"rest/auth_handler.go:149","message":"Login validation passed","request_id":"3ac0f8afed0a14a1d83ca294f4fd8c20","trace_id":"3ac0f8afed0a14a1d83ca294f4fd8c20","span_id":"71952352883a7faa","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","email":"test@example.com","tenant_id":"tenant-123","tenant_name":"Test Tenant"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.961+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"3ac0f8afed0a14a1d83ca294f4fd8c20","trace_id":"3ac0f8afed0a14a1d83ca294f4fd8c20","span_id":"71952352883a7faa","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"3ac0f8afed0a14a1d83ca294f4fd8c20","trace_id":"3ac0f8afed0a14a1d83ca294f4fd8c20","span_id":"71952352883a7faa","user_id":"user-123","tenant_id":"tenant-123","auth_method":"password","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.961+0530","caller":"rest/auth_handler.go:187","message":"Business event","request_id":"3ac0f8afed0a14a1d83ca294f4fd8c20","trace_id":"3ac0f8afed0a14a1d83ca294f4fd8c20","span_id":"71952352883a7faa","event_type":"user_login","user_id":"user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","login_method":"password","roles":["user"],"duration_ms":16,"tenant_name":"Test Tenant","tenant_plan":"pro"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.961+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"3ac0f8afed0a14a1d83ca294f4fd8c20","trace_id":"3ac0f8afed0a14a1d83ca294f4fd8c20","span_id":"71952352883a7faa","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"3ac0f8afed0a14a1d83ca294f4fd8c20","trace_id":"3ac0f8afed0a14a1d83ca294f4fd8c20","span_id":"71952352883a7faa","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.017355458}
--- PASS: TestAuthHandler_Login_Success (0.02s)
=== RUN   TestAuthHandler_Login_InvalidEmail
{"level":"INFO","timestamp":"2025-06-26T13:02:14.961+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"9aae88eb3ed824b591b018e91dc9bf53","trace_id":"9aae88eb3ed824b591b018e91dc9bf53","span_id":"8cd7495c1fe7fb73","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"9aae88eb3ed824b591b018e91dc9bf53","trace_id":"9aae88eb3ed824b591b018e91dc9bf53","span_id":"8cd7495c1fe7fb73","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.961+0530","caller":"rest/auth_handler.go:95","message":"Login attempt started","request_id":"9aae88eb3ed824b591b018e91dc9bf53","trace_id":"9aae88eb3ed824b591b018e91dc9bf53","span_id":"8cd7495c1fe7fb73","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","endpoint":"/auth/login","method":"POST"}
{"level":"WARN","timestamp":"2025-06-26T13:02:14.961+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"9aae88eb3ed824b591b018e91dc9bf53","trace_id":"9aae88eb3ed824b591b018e91dc9bf53","span_id":"8cd7495c1fe7fb73","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"9aae88eb3ed824b591b018e91dc9bf53","trace_id":"9aae88eb3ed824b591b018e91dc9bf53","span_id":"8cd7495c1fe7fb73","user_id":"","tenant_id":"","auth_method":"password","reason":"validation_error","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:102\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidEmail.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidEmail\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:157\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:14.961+0530","caller":"rest/auth_handler.go:103","message":"Login validation failed","request_id":"9aae88eb3ed824b591b018e91dc9bf53","trace_id":"9aae88eb3ed824b591b018e91dc9bf53","span_id":"8cd7495c1fe7fb73","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","error":"Key: 'LoginRequest.Email' Error:Field validation for 'Email' failed on the 'email' tag","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:103\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidEmail.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidEmail\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:157\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.961+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"9aae88eb3ed824b591b018e91dc9bf53","trace_id":"9aae88eb3ed824b591b018e91dc9bf53","span_id":"8cd7495c1fe7fb73","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"9aae88eb3ed824b591b018e91dc9bf53","trace_id":"9aae88eb3ed824b591b018e91dc9bf53","span_id":"8cd7495c1fe7fb73","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000155667}
{"level":"WARN","timestamp":"2025-06-26T13:02:14.961+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"9aae88eb3ed824b591b018e91dc9bf53","trace_id":"9aae88eb3ed824b591b018e91dc9bf53","span_id":"8cd7495c1fe7fb73","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":75,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Login_InvalidEmail.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidEmail\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:157\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_Login_InvalidEmail (0.00s)
=== RUN   TestAuthHandler_Login_MissingFields
{"level":"INFO","timestamp":"2025-06-26T13:02:14.961+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"68f59fc1b48f74f5760197788b5b8422","trace_id":"68f59fc1b48f74f5760197788b5b8422","span_id":"542a6921c627aecd","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"68f59fc1b48f74f5760197788b5b8422","trace_id":"68f59fc1b48f74f5760197788b5b8422","span_id":"542a6921c627aecd","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.961+0530","caller":"rest/auth_handler.go:95","message":"Login attempt started","request_id":"68f59fc1b48f74f5760197788b5b8422","trace_id":"68f59fc1b48f74f5760197788b5b8422","span_id":"542a6921c627aecd","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","endpoint":"/auth/login","method":"POST"}
{"level":"WARN","timestamp":"2025-06-26T13:02:14.961+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"68f59fc1b48f74f5760197788b5b8422","trace_id":"68f59fc1b48f74f5760197788b5b8422","span_id":"542a6921c627aecd","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"68f59fc1b48f74f5760197788b5b8422","trace_id":"68f59fc1b48f74f5760197788b5b8422","span_id":"542a6921c627aecd","user_id":"","tenant_id":"","auth_method":"password","reason":"validation_error","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:102\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_MissingFields.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_MissingFields\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:194\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:14.961+0530","caller":"rest/auth_handler.go:103","message":"Login validation failed","request_id":"68f59fc1b48f74f5760197788b5b8422","trace_id":"68f59fc1b48f74f5760197788b5b8422","span_id":"542a6921c627aecd","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","error":"Key: 'LoginRequest.Password' Error:Field validation for 'Password' failed on the 'required' tag","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:103\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_MissingFields.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_MissingFields\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:194\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.961+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"68f59fc1b48f74f5760197788b5b8422","trace_id":"68f59fc1b48f74f5760197788b5b8422","span_id":"542a6921c627aecd","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"68f59fc1b48f74f5760197788b5b8422","trace_id":"68f59fc1b48f74f5760197788b5b8422","span_id":"542a6921c627aecd","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000049541}
{"level":"WARN","timestamp":"2025-06-26T13:02:14.961+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"68f59fc1b48f74f5760197788b5b8422","trace_id":"68f59fc1b48f74f5760197788b5b8422","span_id":"542a6921c627aecd","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":28,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Login_MissingFields.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_MissingFields\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:194\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_Login_MissingFields (0.00s)
=== RUN   TestAuthHandler_Register_Success
{"level":"INFO","timestamp":"2025-06-26T13:02:14.961+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"e534a56f41671ce8387fd8f3bcf47855","trace_id":"e534a56f41671ce8387fd8f3bcf47855","span_id":"8f955b8e62b5d2d2","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"e534a56f41671ce8387fd8f3bcf47855","trace_id":"e534a56f41671ce8387fd8f3bcf47855","span_id":"8f955b8e62b5d2d2","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.961+0530","caller":"rest/auth_handler.go:235","message":"Registration attempt started","request_id":"e534a56f41671ce8387fd8f3bcf47855","trace_id":"e534a56f41671ce8387fd8f3bcf47855","span_id":"8f955b8e62b5d2d2","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","endpoint":"/auth/register","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.961+0530","caller":"rest/auth_handler.go:251","message":"Registration validation passed","request_id":"e534a56f41671ce8387fd8f3bcf47855","trace_id":"e534a56f41671ce8387fd8f3bcf47855","span_id":"8f955b8e62b5d2d2","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","email":"newuser@example.com","tenant_id":"tenant-123","first_name":"John","last_name":"Doe"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.999+0530","caller":"rest/auth_handler.go:280","message":"Business event","request_id":"e534a56f41671ce8387fd8f3bcf47855","trace_id":"e534a56f41671ce8387fd8f3bcf47855","span_id":"8f955b8e62b5d2d2","event_type":"user_registration","user_id":"user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","email":"newuser@example.com","first_name":"John","last_name":"Doe","duration_ms":37}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.999+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"e534a56f41671ce8387fd8f3bcf47855","trace_id":"e534a56f41671ce8387fd8f3bcf47855","span_id":"8f955b8e62b5d2d2","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"e534a56f41671ce8387fd8f3bcf47855","trace_id":"e534a56f41671ce8387fd8f3bcf47855","span_id":"8f955b8e62b5d2d2","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":201,"duration":0.037222542}
--- PASS: TestAuthHandler_Register_Success (0.04s)
=== RUN   TestAuthHandler_Register_InvalidEmail
{"level":"INFO","timestamp":"2025-06-26T13:02:14.999+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"30a3e03479cd373953329dc67995ee13","trace_id":"30a3e03479cd373953329dc67995ee13","span_id":"ae11d36de1edd23c","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"30a3e03479cd373953329dc67995ee13","trace_id":"30a3e03479cd373953329dc67995ee13","span_id":"ae11d36de1edd23c","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.999+0530","caller":"rest/auth_handler.go:235","message":"Registration attempt started","request_id":"30a3e03479cd373953329dc67995ee13","trace_id":"30a3e03479cd373953329dc67995ee13","span_id":"ae11d36de1edd23c","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","endpoint":"/auth/register","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:14.999+0530","caller":"rest/auth_handler.go:242","message":"Registration validation failed","request_id":"30a3e03479cd373953329dc67995ee13","trace_id":"30a3e03479cd373953329dc67995ee13","span_id":"ae11d36de1edd23c","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","error":"Key: 'RegisterRequest.Email' Error:Field validation for 'Email' failed on the 'email' tag","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Register\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:242\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Register_InvalidEmail.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Register_InvalidEmail\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:275\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.999+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"30a3e03479cd373953329dc67995ee13","trace_id":"30a3e03479cd373953329dc67995ee13","span_id":"ae11d36de1edd23c","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"30a3e03479cd373953329dc67995ee13","trace_id":"30a3e03479cd373953329dc67995ee13","span_id":"ae11d36de1edd23c","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000145375}
{"level":"WARN","timestamp":"2025-06-26T13:02:14.999+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"30a3e03479cd373953329dc67995ee13","trace_id":"30a3e03479cd373953329dc67995ee13","span_id":"ae11d36de1edd23c","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":113,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Register_InvalidEmail.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Register_InvalidEmail\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:275\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_Register_InvalidEmail (0.00s)
=== RUN   TestAuthHandler_Register_MissingFields
{"level":"INFO","timestamp":"2025-06-26T13:02:14.999+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"def7fdbfd988b3f5a2e606c2c9528ff1","trace_id":"def7fdbfd988b3f5a2e606c2c9528ff1","span_id":"c10bdb2a9f41a5d9","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"def7fdbfd988b3f5a2e606c2c9528ff1","trace_id":"def7fdbfd988b3f5a2e606c2c9528ff1","span_id":"c10bdb2a9f41a5d9","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.999+0530","caller":"rest/auth_handler.go:235","message":"Registration attempt started","request_id":"def7fdbfd988b3f5a2e606c2c9528ff1","trace_id":"def7fdbfd988b3f5a2e606c2c9528ff1","span_id":"c10bdb2a9f41a5d9","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","endpoint":"/auth/register","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:14.999+0530","caller":"rest/auth_handler.go:242","message":"Registration validation failed","request_id":"def7fdbfd988b3f5a2e606c2c9528ff1","trace_id":"def7fdbfd988b3f5a2e606c2c9528ff1","span_id":"c10bdb2a9f41a5d9","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","error":"Key: 'RegisterRequest.Password' Error:Field validation for 'Password' failed on the 'required' tag\nKey: 'RegisterRequest.TenantID' Error:Field validation for 'TenantID' failed on the 'required' tag\nKey: 'RegisterRequest.FirstName' Error:Field validation for 'FirstName' failed on the 'required' tag\nKey: 'RegisterRequest.LastName' Error:Field validation for 'LastName' failed on the 'required' tag","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Register\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:242\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Register_MissingFields.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Register_MissingFields\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:312\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.999+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"def7fdbfd988b3f5a2e606c2c9528ff1","trace_id":"def7fdbfd988b3f5a2e606c2c9528ff1","span_id":"c10bdb2a9f41a5d9","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"def7fdbfd988b3f5a2e606c2c9528ff1","trace_id":"def7fdbfd988b3f5a2e606c2c9528ff1","span_id":"c10bdb2a9f41a5d9","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000090875}
{"level":"WARN","timestamp":"2025-06-26T13:02:14.999+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"def7fdbfd988b3f5a2e606c2c9528ff1","trace_id":"def7fdbfd988b3f5a2e606c2c9528ff1","span_id":"c10bdb2a9f41a5d9","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":28,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Register_MissingFields.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Register_MissingFields\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:312\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_Register_MissingFields (0.00s)
=== RUN   TestAuthHandler_RefreshToken_Success
{"level":"INFO","timestamp":"2025-06-26T13:02:14.999+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"4747baeac460de8b326d9fd23e1e5042","trace_id":"4747baeac460de8b326d9fd23e1e5042","span_id":"10689f4ae639e2d3","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"4747baeac460de8b326d9fd23e1e5042","trace_id":"4747baeac460de8b326d9fd23e1e5042","span_id":"10689f4ae639e2d3","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.999+0530","caller":"rest/auth_handler.go:323","message":"Token refresh attempt started","request_id":"4747baeac460de8b326d9fd23e1e5042","trace_id":"4747baeac460de8b326d9fd23e1e5042","span_id":"10689f4ae639e2d3","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/auth/refresh","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T13:02:14.999+0530","caller":"rest/auth_handler.go:339","message":"Token refresh validation passed","request_id":"4747baeac460de8b326d9fd23e1e5042","trace_id":"4747baeac460de8b326d9fd23e1e5042","span_id":"10689f4ae639e2d3","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","refresh_token_prefix":"valid-refr..."}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.005+0530","caller":"rest/auth_handler.go:366","message":"Business event","request_id":"4747baeac460de8b326d9fd23e1e5042","trace_id":"4747baeac460de8b326d9fd23e1e5042","span_id":"10689f4ae639e2d3","event_type":"token_refresh","user_id":"user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","duration_ms":5}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.005+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"4747baeac460de8b326d9fd23e1e5042","trace_id":"4747baeac460de8b326d9fd23e1e5042","span_id":"10689f4ae639e2d3","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"4747baeac460de8b326d9fd23e1e5042","trace_id":"4747baeac460de8b326d9fd23e1e5042","span_id":"10689f4ae639e2d3","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.005851958}
--- PASS: TestAuthHandler_RefreshToken_Success (0.01s)
=== RUN   TestAuthHandler_RefreshToken_MissingToken
{"level":"INFO","timestamp":"2025-06-26T13:02:15.005+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"df5501e062acf04748921889551ea458","trace_id":"df5501e062acf04748921889551ea458","span_id":"7b18a5d13c8d4502","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"df5501e062acf04748921889551ea458","trace_id":"df5501e062acf04748921889551ea458","span_id":"7b18a5d13c8d4502","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.005+0530","caller":"rest/auth_handler.go:323","message":"Token refresh attempt started","request_id":"df5501e062acf04748921889551ea458","trace_id":"df5501e062acf04748921889551ea458","span_id":"7b18a5d13c8d4502","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/auth/refresh","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.006+0530","caller":"rest/auth_handler.go:330","message":"Token refresh validation failed","request_id":"df5501e062acf04748921889551ea458","trace_id":"df5501e062acf04748921889551ea458","span_id":"7b18a5d13c8d4502","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","error":"Key: 'RefreshTokenRequest.RefreshToken' Error:Field validation for 'RefreshToken' failed on the 'required' tag","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).RefreshToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:330\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_RefreshToken_MissingToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_RefreshToken_MissingToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:385\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.006+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"df5501e062acf04748921889551ea458","trace_id":"df5501e062acf04748921889551ea458","span_id":"7b18a5d13c8d4502","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"df5501e062acf04748921889551ea458","trace_id":"df5501e062acf04748921889551ea458","span_id":"7b18a5d13c8d4502","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000337125}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.006+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"df5501e062acf04748921889551ea458","trace_id":"df5501e062acf04748921889551ea458","span_id":"7b18a5d13c8d4502","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":2,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_RefreshToken_MissingToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_RefreshToken_MissingToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:385\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_RefreshToken_MissingToken (0.00s)
=== RUN   TestAuthHandler_Logout_Success
{"level":"INFO","timestamp":"2025-06-26T13:02:15.006+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"878806e80233fd9a5946d5eab478eece","trace_id":"878806e80233fd9a5946d5eab478eece","span_id":"add651d115c4e24d","method":"POST","path":"/logout","client_ip":"192.0.2.1:1234","request_id":"878806e80233fd9a5946d5eab478eece","trace_id":"878806e80233fd9a5946d5eab478eece","span_id":"add651d115c4e24d","parent_span_id":"","method":"POST","path":"/logout","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.006+0530","caller":"rest/auth_handler.go:400","message":"Logout attempt started","request_id":"878806e80233fd9a5946d5eab478eece","trace_id":"878806e80233fd9a5946d5eab478eece","span_id":"add651d115c4e24d","method":"POST","path":"/logout","client_ip":"192.0.2.1:1234","endpoint":"/auth/logout","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.017+0530","caller":"rest/auth_handler.go:413","message":"Business event","request_id":"878806e80233fd9a5946d5eab478eece","trace_id":"878806e80233fd9a5946d5eab478eece","span_id":"add651d115c4e24d","event_type":"user_logout","user_id":"user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","duration_ms":11}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.017+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"878806e80233fd9a5946d5eab478eece","trace_id":"878806e80233fd9a5946d5eab478eece","span_id":"add651d115c4e24d","method":"POST","path":"/logout","client_ip":"192.0.2.1:1234","request_id":"878806e80233fd9a5946d5eab478eece","trace_id":"878806e80233fd9a5946d5eab478eece","span_id":"add651d115c4e24d","parent_span_id":"","method":"POST","path":"/logout","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.011255333}
--- PASS: TestAuthHandler_Logout_Success (0.01s)
=== RUN   TestAuthHandler_Login_InvalidJSON
{"level":"INFO","timestamp":"2025-06-26T13:02:15.017+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"28298c8f204db520d0cadc95e37af22e","trace_id":"28298c8f204db520d0cadc95e37af22e","span_id":"0a370b65fdfba340","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"28298c8f204db520d0cadc95e37af22e","trace_id":"28298c8f204db520d0cadc95e37af22e","span_id":"0a370b65fdfba340","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.017+0530","caller":"rest/auth_handler.go:95","message":"Login attempt started","request_id":"28298c8f204db520d0cadc95e37af22e","trace_id":"28298c8f204db520d0cadc95e37af22e","span_id":"0a370b65fdfba340","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","endpoint":"/auth/login","method":"POST"}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.017+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"28298c8f204db520d0cadc95e37af22e","trace_id":"28298c8f204db520d0cadc95e37af22e","span_id":"0a370b65fdfba340","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"28298c8f204db520d0cadc95e37af22e","trace_id":"28298c8f204db520d0cadc95e37af22e","span_id":"0a370b65fdfba340","user_id":"","tenant_id":"","auth_method":"password","reason":"validation_error","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:102\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:444\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.017+0530","caller":"rest/auth_handler.go:103","message":"Login validation failed","request_id":"28298c8f204db520d0cadc95e37af22e","trace_id":"28298c8f204db520d0cadc95e37af22e","span_id":"0a370b65fdfba340","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","error":"unexpected EOF","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:103\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:444\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.017+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"28298c8f204db520d0cadc95e37af22e","trace_id":"28298c8f204db520d0cadc95e37af22e","span_id":"0a370b65fdfba340","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"28298c8f204db520d0cadc95e37af22e","trace_id":"28298c8f204db520d0cadc95e37af22e","span_id":"0a370b65fdfba340","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000277708}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.017+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"28298c8f204db520d0cadc95e37af22e","trace_id":"28298c8f204db520d0cadc95e37af22e","span_id":"0a370b65fdfba340","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":82,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Login_InvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:444\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_Login_InvalidJSON (0.00s)
=== RUN   TestAuthHandler_Register_EmptyPassword
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"215488b4ee5893cc8529174eafa8f52d","trace_id":"215488b4ee5893cc8529174eafa8f52d","span_id":"38eff43a5b030aef","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"215488b4ee5893cc8529174eafa8f52d","trace_id":"215488b4ee5893cc8529174eafa8f52d","span_id":"38eff43a5b030aef","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"rest/auth_handler.go:235","message":"Registration attempt started","request_id":"215488b4ee5893cc8529174eafa8f52d","trace_id":"215488b4ee5893cc8529174eafa8f52d","span_id":"38eff43a5b030aef","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","endpoint":"/auth/register","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.018+0530","caller":"rest/auth_handler.go:242","message":"Registration validation failed","request_id":"215488b4ee5893cc8529174eafa8f52d","trace_id":"215488b4ee5893cc8529174eafa8f52d","span_id":"38eff43a5b030aef","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","error":"Key: 'RegisterRequest.Password' Error:Field validation for 'Password' failed on the 'required' tag","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Register\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:242\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Register_EmptyPassword.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Register_EmptyPassword\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:483\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"215488b4ee5893cc8529174eafa8f52d","trace_id":"215488b4ee5893cc8529174eafa8f52d","span_id":"38eff43a5b030aef","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"215488b4ee5893cc8529174eafa8f52d","trace_id":"215488b4ee5893cc8529174eafa8f52d","span_id":"38eff43a5b030aef","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000089125}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.018+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"215488b4ee5893cc8529174eafa8f52d","trace_id":"215488b4ee5893cc8529174eafa8f52d","span_id":"38eff43a5b030aef","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":105,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Register_EmptyPassword.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Register_EmptyPassword\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:483\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_Register_EmptyPassword (0.00s)
=== RUN   TestAuthHandler_NewAuthHandler
--- PASS: TestAuthHandler_NewAuthHandler (0.00s)
=== RUN   TestOAuthHandler_GoogleLogin_Success
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"57986657028eb31f1386df1e7eba7edd","trace_id":"57986657028eb31f1386df1e7eba7edd","span_id":"df246c1dba2db4f8","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"57986657028eb31f1386df1e7eba7edd","trace_id":"57986657028eb31f1386df1e7eba7edd","span_id":"df246c1dba2db4f8","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"rest/oauth_handler.go:65","message":"Google OAuth login initiated","request_id":"57986657028eb31f1386df1e7eba7edd","trace_id":"57986657028eb31f1386df1e7eba7edd","span_id":"df246c1dba2db4f8","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/login","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"rest/oauth_handler.go:84","message":"Google OAuth login validation passed","request_id":"57986657028eb31f1386df1e7eba7edd","trace_id":"57986657028eb31f1386df1e7eba7edd","span_id":"df246c1dba2db4f8","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","tenant_id":"tenant-123","redirect_uri":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"57986657028eb31f1386df1e7eba7edd","trace_id":"57986657028eb31f1386df1e7eba7edd","span_id":"df246c1dba2db4f8","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"57986657028eb31f1386df1e7eba7edd","trace_id":"57986657028eb31f1386df1e7eba7edd","span_id":"df246c1dba2db4f8","provider":"google","step":"login_initiated","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"rest/oauth_handler.go:101","message":"Business event","request_id":"57986657028eb31f1386df1e7eba7edd","trace_id":"57986657028eb31f1386df1e7eba7edd","span_id":"df246c1dba2db4f8","event_type":"oauth_login_initiated","user_id":"","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","provider":"google","redirect_uri":"http://localhost:8080/api/v1/oauth/google/callback","duration_ms":0}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"57986657028eb31f1386df1e7eba7edd","trace_id":"57986657028eb31f1386df1e7eba7edd","span_id":"df246c1dba2db4f8","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"57986657028eb31f1386df1e7eba7edd","trace_id":"57986657028eb31f1386df1e7eba7edd","span_id":"df246c1dba2db4f8","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.000163583}
--- PASS: TestOAuthHandler_GoogleLogin_Success (0.00s)
=== RUN   TestOAuthHandler_GoogleLogin_WithCustomRedirectURI
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"a28f663c0083dff12268e78631ae9526","trace_id":"a28f663c0083dff12268e78631ae9526","span_id":"3d270dded48b2893","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"a28f663c0083dff12268e78631ae9526","trace_id":"a28f663c0083dff12268e78631ae9526","span_id":"3d270dded48b2893","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"rest/oauth_handler.go:65","message":"Google OAuth login initiated","request_id":"a28f663c0083dff12268e78631ae9526","trace_id":"a28f663c0083dff12268e78631ae9526","span_id":"3d270dded48b2893","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/login","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"rest/oauth_handler.go:84","message":"Google OAuth login validation passed","request_id":"a28f663c0083dff12268e78631ae9526","trace_id":"a28f663c0083dff12268e78631ae9526","span_id":"3d270dded48b2893","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","tenant_id":"tenant-123","redirect_uri":"https://custom.example.com/callback"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"a28f663c0083dff12268e78631ae9526","trace_id":"a28f663c0083dff12268e78631ae9526","span_id":"3d270dded48b2893","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"a28f663c0083dff12268e78631ae9526","trace_id":"a28f663c0083dff12268e78631ae9526","span_id":"3d270dded48b2893","provider":"google","step":"login_initiated","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"rest/oauth_handler.go:101","message":"Business event","request_id":"a28f663c0083dff12268e78631ae9526","trace_id":"a28f663c0083dff12268e78631ae9526","span_id":"3d270dded48b2893","event_type":"oauth_login_initiated","user_id":"","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","provider":"google","redirect_uri":"https://custom.example.com/callback","duration_ms":0}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"a28f663c0083dff12268e78631ae9526","trace_id":"a28f663c0083dff12268e78631ae9526","span_id":"3d270dded48b2893","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"a28f663c0083dff12268e78631ae9526","trace_id":"a28f663c0083dff12268e78631ae9526","span_id":"3d270dded48b2893","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.000220292}
--- PASS: TestOAuthHandler_GoogleLogin_WithCustomRedirectURI (0.00s)
=== RUN   TestOAuthHandler_GoogleLogin_MissingTenantID
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"dd63420b3f4ef7cf5d545b650b1e3019","trace_id":"dd63420b3f4ef7cf5d545b650b1e3019","span_id":"1d110a3ccd2309b1","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"dd63420b3f4ef7cf5d545b650b1e3019","trace_id":"dd63420b3f4ef7cf5d545b650b1e3019","span_id":"1d110a3ccd2309b1","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"rest/oauth_handler.go:65","message":"Google OAuth login initiated","request_id":"dd63420b3f4ef7cf5d545b650b1e3019","trace_id":"dd63420b3f4ef7cf5d545b650b1e3019","span_id":"1d110a3ccd2309b1","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/login","method":"GET"}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.018+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"dd63420b3f4ef7cf5d545b650b1e3019","trace_id":"dd63420b3f4ef7cf5d545b650b1e3019","span_id":"1d110a3ccd2309b1","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"dd63420b3f4ef7cf5d545b650b1e3019","trace_id":"dd63420b3f4ef7cf5d545b650b1e3019","span_id":"1d110a3ccd2309b1","user_id":"","tenant_id":"","auth_method":"google_oauth","reason":"missing_tenant_id","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).GoogleLogin\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:74\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleLogin_MissingTenantID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleLogin_MissingTenantID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:115\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.018+0530","caller":"rest/oauth_handler.go:75","message":"Google OAuth login failed - missing tenant ID","request_id":"dd63420b3f4ef7cf5d545b650b1e3019","trace_id":"dd63420b3f4ef7cf5d545b650b1e3019","span_id":"1d110a3ccd2309b1","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).GoogleLogin\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:75\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleLogin_MissingTenantID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleLogin_MissingTenantID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:115\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"dd63420b3f4ef7cf5d545b650b1e3019","trace_id":"dd63420b3f4ef7cf5d545b650b1e3019","span_id":"1d110a3ccd2309b1","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"dd63420b3f4ef7cf5d545b650b1e3019","trace_id":"dd63420b3f4ef7cf5d545b650b1e3019","span_id":"1d110a3ccd2309b1","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000092958}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.018+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"dd63420b3f4ef7cf5d545b650b1e3019","trace_id":"dd63420b3f4ef7cf5d545b650b1e3019","span_id":"1d110a3ccd2309b1","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_GoogleLogin_MissingTenantID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleLogin_MissingTenantID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:115\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_GoogleLogin_MissingTenantID (0.00s)
=== RUN   TestOAuthHandler_GoogleCallback_Success
{"level":"INFO","timestamp":"2025-06-26T13:02:15.018+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"56a1ed0cf94247289556c59dc9bfec27","trace_id":"56a1ed0cf94247289556c59dc9bfec27","span_id":"b3236bc4cf809b8b","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"56a1ed0cf94247289556c59dc9bfec27","trace_id":"56a1ed0cf94247289556c59dc9bfec27","span_id":"b3236bc4cf809b8b","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.019+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"56a1ed0cf94247289556c59dc9bfec27","trace_id":"56a1ed0cf94247289556c59dc9bfec27","span_id":"b3236bc4cf809b8b","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.019+0530","caller":"rest/oauth_handler.go:174","message":"Google OAuth callback validation passed","request_id":"56a1ed0cf94247289556c59dc9bfec27","trace_id":"56a1ed0cf94247289556c59dc9bfec27","span_id":"b3236bc4cf809b8b","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","tenant_id":"tenant-123","code_prefix":"test-auth-..."}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.072+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"56a1ed0cf94247289556c59dc9bfec27","trace_id":"56a1ed0cf94247289556c59dc9bfec27","span_id":"b3236bc4cf809b8b","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"56a1ed0cf94247289556c59dc9bfec27","trace_id":"56a1ed0cf94247289556c59dc9bfec27","span_id":"b3236bc4cf809b8b","user_id":"google-user-123","tenant_id":"tenant-123","auth_method":"google_oauth","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.073+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"56a1ed0cf94247289556c59dc9bfec27","trace_id":"56a1ed0cf94247289556c59dc9bfec27","span_id":"b3236bc4cf809b8b","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"56a1ed0cf94247289556c59dc9bfec27","trace_id":"56a1ed0cf94247289556c59dc9bfec27","span_id":"b3236bc4cf809b8b","provider":"google","step":"callback_success","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.073+0530","caller":"rest/oauth_handler.go:209","message":"Business event","request_id":"56a1ed0cf94247289556c59dc9bfec27","trace_id":"56a1ed0cf94247289556c59dc9bfec27","span_id":"b3236bc4cf809b8b","event_type":"oauth_login_completed","user_id":"google-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","provider":"google","duration_ms":54}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.073+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"56a1ed0cf94247289556c59dc9bfec27","trace_id":"56a1ed0cf94247289556c59dc9bfec27","span_id":"b3236bc4cf809b8b","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"56a1ed0cf94247289556c59dc9bfec27","trace_id":"56a1ed0cf94247289556c59dc9bfec27","span_id":"b3236bc4cf809b8b","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.054147417}
--- PASS: TestOAuthHandler_GoogleCallback_Success (0.05s)
=== RUN   TestOAuthHandler_GoogleCallback_MissingCode
{"level":"INFO","timestamp":"2025-06-26T13:02:15.073+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"c44943711bec84fc800e052ed326b720","trace_id":"c44943711bec84fc800e052ed326b720","span_id":"589b8dcbcd9679f5","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"c44943711bec84fc800e052ed326b720","trace_id":"c44943711bec84fc800e052ed326b720","span_id":"589b8dcbcd9679f5","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.073+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"c44943711bec84fc800e052ed326b720","trace_id":"c44943711bec84fc800e052ed326b720","span_id":"589b8dcbcd9679f5","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.073+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"c44943711bec84fc800e052ed326b720","trace_id":"c44943711bec84fc800e052ed326b720","span_id":"589b8dcbcd9679f5","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"c44943711bec84fc800e052ed326b720","trace_id":"c44943711bec84fc800e052ed326b720","span_id":"589b8dcbcd9679f5","user_id":"","tenant_id":"tenant-123","auth_method":"google_oauth","reason":"missing_code","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).GoogleCallback\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:164\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_MissingCode.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_MissingCode\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:171\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.073+0530","caller":"rest/oauth_handler.go:165","message":"Google OAuth callback failed - missing authorization code","request_id":"c44943711bec84fc800e052ed326b720","trace_id":"c44943711bec84fc800e052ed326b720","span_id":"589b8dcbcd9679f5","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).GoogleCallback\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:165\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_MissingCode.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_MissingCode\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:171\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.073+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"c44943711bec84fc800e052ed326b720","trace_id":"c44943711bec84fc800e052ed326b720","span_id":"589b8dcbcd9679f5","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"c44943711bec84fc800e052ed326b720","trace_id":"c44943711bec84fc800e052ed326b720","span_id":"589b8dcbcd9679f5","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.00015625}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.073+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"c44943711bec84fc800e052ed326b720","trace_id":"c44943711bec84fc800e052ed326b720","span_id":"589b8dcbcd9679f5","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_MissingCode.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_MissingCode\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:171\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_GoogleCallback_MissingCode (0.00s)
=== RUN   TestOAuthHandler_GoogleCallback_OAuthError
{"level":"INFO","timestamp":"2025-06-26T13:02:15.073+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"b8ada567984a35b2f7be8d4a150599c1","trace_id":"b8ada567984a35b2f7be8d4a150599c1","span_id":"c1d29b4a0cf3eb22","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"b8ada567984a35b2f7be8d4a150599c1","trace_id":"b8ada567984a35b2f7be8d4a150599c1","span_id":"c1d29b4a0cf3eb22","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.073+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"b8ada567984a35b2f7be8d4a150599c1","trace_id":"b8ada567984a35b2f7be8d4a150599c1","span_id":"c1d29b4a0cf3eb22","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.073+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"b8ada567984a35b2f7be8d4a150599c1","trace_id":"b8ada567984a35b2f7be8d4a150599c1","span_id":"c1d29b4a0cf3eb22","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"b8ada567984a35b2f7be8d4a150599c1","trace_id":"b8ada567984a35b2f7be8d4a150599c1","span_id":"c1d29b4a0cf3eb22","user_id":"","tenant_id":"tenant-123","auth_method":"google_oauth","reason":"oauth_error","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).GoogleCallback\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:153\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_OAuthError.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_OAuthError\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:197\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.073+0530","caller":"logger/logger.go:225","message":"OAuth flow failed","request_id":"b8ada567984a35b2f7be8d4a150599c1","trace_id":"b8ada567984a35b2f7be8d4a150599c1","span_id":"c1d29b4a0cf3eb22","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"b8ada567984a35b2f7be8d4a150599c1","trace_id":"b8ada567984a35b2f7be8d4a150599c1","span_id":"c1d29b4a0cf3eb22","provider":"google","step":"callback_error","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","error":"oauth error: access_denied","stacktrace":"auth-service/internal/logger.(*RequestLogger).OAuthFlow\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:225\nauth-service/internal/handler/rest.(*OAuthHandler).GoogleCallback\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:154\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_OAuthError.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_OAuthError\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:197\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.073+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"b8ada567984a35b2f7be8d4a150599c1","trace_id":"b8ada567984a35b2f7be8d4a150599c1","span_id":"c1d29b4a0cf3eb22","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"b8ada567984a35b2f7be8d4a150599c1","trace_id":"b8ada567984a35b2f7be8d4a150599c1","span_id":"c1d29b4a0cf3eb22","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000107833}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.073+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"b8ada567984a35b2f7be8d4a150599c1","trace_id":"b8ada567984a35b2f7be8d4a150599c1","span_id":"c1d29b4a0cf3eb22","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_OAuthError.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_OAuthError\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:197\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_GoogleCallback_OAuthError (0.00s)
=== RUN   TestOAuthHandler_ClientCredentials_Success
{"level":"INFO","timestamp":"2025-06-26T13:02:15.073+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"9a04d341dd8258e0c446520205e01bed","trace_id":"9a04d341dd8258e0c446520205e01bed","span_id":"42bd1d0b90b6c4b2","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"9a04d341dd8258e0c446520205e01bed","trace_id":"9a04d341dd8258e0c446520205e01bed","span_id":"42bd1d0b90b6c4b2","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.073+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"9a04d341dd8258e0c446520205e01bed","trace_id":"9a04d341dd8258e0c446520205e01bed","span_id":"42bd1d0b90b6c4b2","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.073+0530","caller":"rest/oauth_handler.go:277","message":"Client credentials validation passed","request_id":"9a04d341dd8258e0c446520205e01bed","trace_id":"9a04d341dd8258e0c446520205e01bed","span_id":"42bd1d0b90b6c4b2","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","client_id":"service-client-123","grant_type":"client_credentials","scope":"read:users write:users"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.094+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"9a04d341dd8258e0c446520205e01bed","trace_id":"9a04d341dd8258e0c446520205e01bed","span_id":"42bd1d0b90b6c4b2","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"9a04d341dd8258e0c446520205e01bed","trace_id":"9a04d341dd8258e0c446520205e01bed","span_id":"42bd1d0b90b6c4b2","user_id":"service-client-123","tenant_id":"","auth_method":"client_credentials","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.095+0530","caller":"rest/oauth_handler.go:310","message":"Business event","request_id":"9a04d341dd8258e0c446520205e01bed","trace_id":"9a04d341dd8258e0c446520205e01bed","span_id":"42bd1d0b90b6c4b2","event_type":"client_credentials_success","user_id":"service-client-123","tenant_id":"","client_ip":"192.0.2.1:1234","scope":"read:users write:users","duration_ms":21}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.095+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"9a04d341dd8258e0c446520205e01bed","trace_id":"9a04d341dd8258e0c446520205e01bed","span_id":"42bd1d0b90b6c4b2","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"9a04d341dd8258e0c446520205e01bed","trace_id":"9a04d341dd8258e0c446520205e01bed","span_id":"42bd1d0b90b6c4b2","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.0212505}
--- PASS: TestOAuthHandler_ClientCredentials_Success (0.02s)
=== RUN   TestOAuthHandler_ClientCredentials_UnsupportedGrantType
{"level":"INFO","timestamp":"2025-06-26T13:02:15.095+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"1bdd83fd37405eb940b0ddd3f0371e0a","trace_id":"1bdd83fd37405eb940b0ddd3f0371e0a","span_id":"3159b33e0ffacc8c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"1bdd83fd37405eb940b0ddd3f0371e0a","trace_id":"1bdd83fd37405eb940b0ddd3f0371e0a","span_id":"3159b33e0ffacc8c","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.095+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"1bdd83fd37405eb940b0ddd3f0371e0a","trace_id":"1bdd83fd37405eb940b0ddd3f0371e0a","span_id":"3159b33e0ffacc8c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.095+0530","caller":"rest/oauth_handler.go:277","message":"Client credentials validation passed","request_id":"1bdd83fd37405eb940b0ddd3f0371e0a","trace_id":"1bdd83fd37405eb940b0ddd3f0371e0a","span_id":"3159b33e0ffacc8c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","client_id":"service-client-123","grant_type":"authorization_code","scope":"read:users write:users"}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.095+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"1bdd83fd37405eb940b0ddd3f0371e0a","trace_id":"1bdd83fd37405eb940b0ddd3f0371e0a","span_id":"3159b33e0ffacc8c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"1bdd83fd37405eb940b0ddd3f0371e0a","trace_id":"1bdd83fd37405eb940b0ddd3f0371e0a","span_id":"3159b33e0ffacc8c","user_id":"service-client-123","tenant_id":"","auth_method":"client_credentials","reason":"unsupported_grant_type","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).ClientCredentials\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:284\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_UnsupportedGrantType.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_UnsupportedGrantType\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:273\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.095+0530","caller":"rest/oauth_handler.go:285","message":"Unsupported grant type","request_id":"1bdd83fd37405eb940b0ddd3f0371e0a","trace_id":"1bdd83fd37405eb940b0ddd3f0371e0a","span_id":"3159b33e0ffacc8c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","grant_type":"authorization_code","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).ClientCredentials\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:285\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_UnsupportedGrantType.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_UnsupportedGrantType\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:273\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.095+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"1bdd83fd37405eb940b0ddd3f0371e0a","trace_id":"1bdd83fd37405eb940b0ddd3f0371e0a","span_id":"3159b33e0ffacc8c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"1bdd83fd37405eb940b0ddd3f0371e0a","trace_id":"1bdd83fd37405eb940b0ddd3f0371e0a","span_id":"3159b33e0ffacc8c","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.00018075}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.095+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"1bdd83fd37405eb940b0ddd3f0371e0a","trace_id":"1bdd83fd37405eb940b0ddd3f0371e0a","span_id":"3159b33e0ffacc8c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":138,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_UnsupportedGrantType.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_UnsupportedGrantType\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:273\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_ClientCredentials_UnsupportedGrantType (0.00s)
=== RUN   TestOAuthHandler_ClientCredentials_InvalidJSON
{"level":"INFO","timestamp":"2025-06-26T13:02:15.095+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"3424c2740ac498c55e008673ae3b0f5b","trace_id":"3424c2740ac498c55e008673ae3b0f5b","span_id":"bf2d783426d44280","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"3424c2740ac498c55e008673ae3b0f5b","trace_id":"3424c2740ac498c55e008673ae3b0f5b","span_id":"bf2d783426d44280","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.095+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"3424c2740ac498c55e008673ae3b0f5b","trace_id":"3424c2740ac498c55e008673ae3b0f5b","span_id":"bf2d783426d44280","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.095+0530","caller":"rest/oauth_handler.go:268","message":"Client credentials validation failed","request_id":"3424c2740ac498c55e008673ae3b0f5b","trace_id":"3424c2740ac498c55e008673ae3b0f5b","span_id":"bf2d783426d44280","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","error":"unexpected EOF","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).ClientCredentials\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:268\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_InvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_InvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:303\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.095+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"3424c2740ac498c55e008673ae3b0f5b","trace_id":"3424c2740ac498c55e008673ae3b0f5b","span_id":"bf2d783426d44280","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"3424c2740ac498c55e008673ae3b0f5b","trace_id":"3424c2740ac498c55e008673ae3b0f5b","span_id":"bf2d783426d44280","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.00008875}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.095+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"3424c2740ac498c55e008673ae3b0f5b","trace_id":"3424c2740ac498c55e008673ae3b0f5b","span_id":"bf2d783426d44280","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":70,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_InvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_InvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:303\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_ClientCredentials_InvalidJSON (0.00s)
=== RUN   TestOAuthHandler_CreateOneTimeToken_Success
{"level":"INFO","timestamp":"2025-06-26T13:02:15.095+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"ab24cf036d667b059c1c74d58e1b62cb","trace_id":"ab24cf036d667b059c1c74d58e1b62cb","span_id":"590ac450cb0841f8","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"ab24cf036d667b059c1c74d58e1b62cb","trace_id":"ab24cf036d667b059c1c74d58e1b62cb","span_id":"590ac450cb0841f8","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.095+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"ab24cf036d667b059c1c74d58e1b62cb","trace_id":"ab24cf036d667b059c1c74d58e1b62cb","span_id":"590ac450cb0841f8","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.095+0530","caller":"rest/oauth_handler.go:380","message":"One-time token validation passed","request_id":"ab24cf036d667b059c1c74d58e1b62cb","trace_id":"ab24cf036d667b059c1c74d58e1b62cb","span_id":"590ac450cb0841f8","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","url":"https://app.example.com/survey/123","session_id":"survey-session-456","expires_in":3600,"max_uses":1}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.112+0530","caller":"rest/oauth_handler.go:421","message":"Business event","request_id":"ab24cf036d667b059c1c74d58e1b62cb","trace_id":"ab24cf036d667b059c1c74d58e1b62cb","span_id":"590ac450cb0841f8","event_type":"one_time_token_created","user_id":"","tenant_id":"","client_ip":"192.0.2.1:1234","max_uses":1,"duration_ms":16,"session_id":"survey-session-456","expires_in":3600}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.112+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"ab24cf036d667b059c1c74d58e1b62cb","trace_id":"ab24cf036d667b059c1c74d58e1b62cb","span_id":"590ac450cb0841f8","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"ab24cf036d667b059c1c74d58e1b62cb","trace_id":"ab24cf036d667b059c1c74d58e1b62cb","span_id":"590ac450cb0841f8","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":201,"duration":0.016408083}
--- PASS: TestOAuthHandler_CreateOneTimeToken_Success (0.02s)
=== RUN   TestOAuthHandler_CreateOneTimeToken_MissingURL
{"level":"INFO","timestamp":"2025-06-26T13:02:15.113+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"c15cc47c2dea2e8813a053675c6a683e","trace_id":"c15cc47c2dea2e8813a053675c6a683e","span_id":"7a8b8e9e1c952a09","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"c15cc47c2dea2e8813a053675c6a683e","trace_id":"c15cc47c2dea2e8813a053675c6a683e","span_id":"7a8b8e9e1c952a09","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.113+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"c15cc47c2dea2e8813a053675c6a683e","trace_id":"c15cc47c2dea2e8813a053675c6a683e","span_id":"7a8b8e9e1c952a09","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.113+0530","caller":"rest/oauth_handler.go:371","message":"One-time token validation failed","request_id":"c15cc47c2dea2e8813a053675c6a683e","trace_id":"c15cc47c2dea2e8813a053675c6a683e","span_id":"7a8b8e9e1c952a09","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","error":"Key: 'OneTimeTokenRequest.URL' Error:Field validation for 'URL' failed on the 'required' tag","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).CreateOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:371\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_MissingURL.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_MissingURL\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:385\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.113+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"c15cc47c2dea2e8813a053675c6a683e","trace_id":"c15cc47c2dea2e8813a053675c6a683e","span_id":"7a8b8e9e1c952a09","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"c15cc47c2dea2e8813a053675c6a683e","trace_id":"c15cc47c2dea2e8813a053675c6a683e","span_id":"7a8b8e9e1c952a09","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.00036675}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.113+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"c15cc47c2dea2e8813a053675c6a683e","trace_id":"c15cc47c2dea2e8813a053675c6a683e","span_id":"7a8b8e9e1c952a09","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":87,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_MissingURL.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_MissingURL\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:385\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_CreateOneTimeToken_MissingURL (0.00s)
=== RUN   TestOAuthHandler_VerifyOneTimeToken_Success
{"level":"INFO","timestamp":"2025-06-26T13:02:15.114+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"72690059f31680a959c5c990102e46ca","trace_id":"72690059f31680a959c5c990102e46ca","span_id":"f1c304c15209fe13","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"72690059f31680a959c5c990102e46ca","trace_id":"72690059f31680a959c5c990102e46ca","span_id":"f1c304c15209fe13","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.114+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"72690059f31680a959c5c990102e46ca","trace_id":"72690059f31680a959c5c990102e46ca","span_id":"f1c304c15209fe13","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.114+0530","caller":"rest/oauth_handler.go:488","message":"One-time token verification validation passed","request_id":"72690059f31680a959c5c990102e46ca","trace_id":"72690059f31680a959c5c990102e46ca","span_id":"f1c304c15209fe13","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","token_prefix":"one-time-t...","session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.124+0530","caller":"rest/oauth_handler.go:542","message":"Business event","request_id":"72690059f31680a959c5c990102e46ca","trace_id":"72690059f31680a959c5c990102e46ca","span_id":"f1c304c15209fe13","event_type":"one_time_token_verified","user_id":"anonymous-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","is_valid":true,"duration_ms":10}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.125+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"72690059f31680a959c5c990102e46ca","trace_id":"72690059f31680a959c5c990102e46ca","span_id":"f1c304c15209fe13","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"72690059f31680a959c5c990102e46ca","trace_id":"72690059f31680a959c5c990102e46ca","span_id":"f1c304c15209fe13","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.010952125}
--- PASS: TestOAuthHandler_VerifyOneTimeToken_Success (0.01s)
=== RUN   TestOAuthHandler_VerifyOneTimeToken_MissingToken
{"level":"INFO","timestamp":"2025-06-26T13:02:15.127+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"8baf642a48a83b49cab8590646e4becd","trace_id":"8baf642a48a83b49cab8590646e4becd","span_id":"97c12c4077098d0d","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"8baf642a48a83b49cab8590646e4becd","trace_id":"8baf642a48a83b49cab8590646e4becd","span_id":"97c12c4077098d0d","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.127+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"8baf642a48a83b49cab8590646e4becd","trace_id":"8baf642a48a83b49cab8590646e4becd","span_id":"97c12c4077098d0d","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.127+0530","caller":"rest/oauth_handler.go:469","message":"One-time token verification failed - missing token","request_id":"8baf642a48a83b49cab8590646e4becd","trace_id":"8baf642a48a83b49cab8590646e4becd","span_id":"97c12c4077098d0d","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).VerifyOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:469\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_MissingToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_MissingToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:440\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.127+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"8baf642a48a83b49cab8590646e4becd","trace_id":"8baf642a48a83b49cab8590646e4becd","span_id":"97c12c4077098d0d","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"8baf642a48a83b49cab8590646e4becd","trace_id":"8baf642a48a83b49cab8590646e4becd","span_id":"97c12c4077098d0d","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.00017375}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.127+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"8baf642a48a83b49cab8590646e4becd","trace_id":"8baf642a48a83b49cab8590646e4becd","span_id":"97c12c4077098d0d","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_MissingToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_MissingToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:440\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_VerifyOneTimeToken_MissingToken (0.00s)
=== RUN   TestOAuthHandler_VerifyOneTimeToken_InvalidToken
{"level":"INFO","timestamp":"2025-06-26T13:02:15.128+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"a1a51f19b199e7abfbd2580cb1e1d456","trace_id":"a1a51f19b199e7abfbd2580cb1e1d456","span_id":"9f9a4dc328e275ae","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"a1a51f19b199e7abfbd2580cb1e1d456","trace_id":"a1a51f19b199e7abfbd2580cb1e1d456","span_id":"9f9a4dc328e275ae","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.128+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"a1a51f19b199e7abfbd2580cb1e1d456","trace_id":"a1a51f19b199e7abfbd2580cb1e1d456","span_id":"9f9a4dc328e275ae","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.128+0530","caller":"rest/oauth_handler.go:488","message":"One-time token verification validation passed","request_id":"a1a51f19b199e7abfbd2580cb1e1d456","trace_id":"a1a51f19b199e7abfbd2580cb1e1d456","span_id":"9f9a4dc328e275ae","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","token_prefix":"invalid-to...","session_id":"session-123"}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.139+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"a1a51f19b199e7abfbd2580cb1e1d456","trace_id":"a1a51f19b199e7abfbd2580cb1e1d456","span_id":"9f9a4dc328e275ae","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"a1a51f19b199e7abfbd2580cb1e1d456","trace_id":"a1a51f19b199e7abfbd2580cb1e1d456","span_id":"9f9a4dc328e275ae","user_id":"","tenant_id":"","auth_method":"one_time_token","reason":"invalid_token","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).VerifyOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:513\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_InvalidToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_InvalidToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:466\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.139+0530","caller":"rest/oauth_handler.go:514","message":"One-time token verification failed - invalid token or session","request_id":"a1a51f19b199e7abfbd2580cb1e1d456","trace_id":"a1a51f19b199e7abfbd2580cb1e1d456","span_id":"9f9a4dc328e275ae","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).VerifyOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:514\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_InvalidToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_InvalidToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:466\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.139+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"a1a51f19b199e7abfbd2580cb1e1d456","trace_id":"a1a51f19b199e7abfbd2580cb1e1d456","span_id":"9f9a4dc328e275ae","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"a1a51f19b199e7abfbd2580cb1e1d456","trace_id":"a1a51f19b199e7abfbd2580cb1e1d456","span_id":"9f9a4dc328e275ae","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":401,"duration":0.011647708}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.139+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"a1a51f19b199e7abfbd2580cb1e1d456","trace_id":"a1a51f19b199e7abfbd2580cb1e1d456","span_id":"9f9a4dc328e275ae","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_InvalidToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_InvalidToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:466\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_VerifyOneTimeToken_InvalidToken (0.01s)
=== RUN   TestOAuthHandler_RefreshSession_Success
{"level":"INFO","timestamp":"2025-06-26T13:02:15.140+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"d6ef3fa275950ac876359814e04ee9a8","trace_id":"d6ef3fa275950ac876359814e04ee9a8","span_id":"c55b5bbfe3b24039","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"d6ef3fa275950ac876359814e04ee9a8","trace_id":"d6ef3fa275950ac876359814e04ee9a8","span_id":"c55b5bbfe3b24039","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.140+0530","caller":"rest/oauth_handler.go:580","message":"Session refresh initiated","request_id":"d6ef3fa275950ac876359814e04ee9a8","trace_id":"d6ef3fa275950ac876359814e04ee9a8","span_id":"c55b5bbfe3b24039","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/oauth/refresh","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.140+0530","caller":"rest/oauth_handler.go:598","message":"Session refresh validation passed","request_id":"d6ef3fa275950ac876359814e04ee9a8","trace_id":"d6ef3fa275950ac876359814e04ee9a8","span_id":"c55b5bbfe3b24039","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","token_prefix":"one-time-t...","session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.148+0530","caller":"rest/oauth_handler.go:637","message":"Business event","request_id":"d6ef3fa275950ac876359814e04ee9a8","trace_id":"d6ef3fa275950ac876359814e04ee9a8","span_id":"c55b5bbfe3b24039","event_type":"session_refreshed","user_id":"anonymous-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","duration_ms":8}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.148+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"d6ef3fa275950ac876359814e04ee9a8","trace_id":"d6ef3fa275950ac876359814e04ee9a8","span_id":"c55b5bbfe3b24039","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"d6ef3fa275950ac876359814e04ee9a8","trace_id":"d6ef3fa275950ac876359814e04ee9a8","span_id":"c55b5bbfe3b24039","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.008682375}
--- PASS: TestOAuthHandler_RefreshSession_Success (0.01s)
=== RUN   TestOAuthHandler_RefreshSession_MissingSessionID
{"level":"INFO","timestamp":"2025-06-26T13:02:15.149+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"5a08daac7edafd759b300dce902daecb","trace_id":"5a08daac7edafd759b300dce902daecb","span_id":"06d9142089d92adf","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"5a08daac7edafd759b300dce902daecb","trace_id":"5a08daac7edafd759b300dce902daecb","span_id":"06d9142089d92adf","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.149+0530","caller":"rest/oauth_handler.go:580","message":"Session refresh initiated","request_id":"5a08daac7edafd759b300dce902daecb","trace_id":"5a08daac7edafd759b300dce902daecb","span_id":"06d9142089d92adf","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/oauth/refresh","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.149+0530","caller":"rest/oauth_handler.go:589","message":"Session refresh failed - missing parameters","request_id":"5a08daac7edafd759b300dce902daecb","trace_id":"5a08daac7edafd759b300dce902daecb","span_id":"06d9142089d92adf","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).RefreshSession\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:589\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_MissingSessionID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_MissingSessionID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:522\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.149+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"5a08daac7edafd759b300dce902daecb","trace_id":"5a08daac7edafd759b300dce902daecb","span_id":"06d9142089d92adf","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"5a08daac7edafd759b300dce902daecb","trace_id":"5a08daac7edafd759b300dce902daecb","span_id":"06d9142089d92adf","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000087875}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.149+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"5a08daac7edafd759b300dce902daecb","trace_id":"5a08daac7edafd759b300dce902daecb","span_id":"06d9142089d92adf","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_MissingSessionID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_MissingSessionID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:522\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_RefreshSession_MissingSessionID (0.00s)
=== RUN   TestOAuthHandler_NewOAuthHandler
--- PASS: TestOAuthHandler_NewOAuthHandler (0.00s)
=== RUN   TestOAuthHandler_CreateOneTimeToken_WithAllFields
{"level":"INFO","timestamp":"2025-06-26T13:02:15.149+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"3de81dbac2d240868e03868d1bde6cd8","trace_id":"3de81dbac2d240868e03868d1bde6cd8","span_id":"f7cc9693422bc45e","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"3de81dbac2d240868e03868d1bde6cd8","trace_id":"3de81dbac2d240868e03868d1bde6cd8","span_id":"f7cc9693422bc45e","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.149+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"3de81dbac2d240868e03868d1bde6cd8","trace_id":"3de81dbac2d240868e03868d1bde6cd8","span_id":"f7cc9693422bc45e","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.149+0530","caller":"rest/oauth_handler.go:380","message":"One-time token validation passed","request_id":"3de81dbac2d240868e03868d1bde6cd8","trace_id":"3de81dbac2d240868e03868d1bde6cd8","span_id":"f7cc9693422bc45e","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","url":"https://app.example.com/survey/123","session_id":"survey-session-456","expires_in":7200,"max_uses":5}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.164+0530","caller":"rest/oauth_handler.go:421","message":"Business event","request_id":"3de81dbac2d240868e03868d1bde6cd8","trace_id":"3de81dbac2d240868e03868d1bde6cd8","span_id":"f7cc9693422bc45e","event_type":"one_time_token_created","user_id":"","tenant_id":"","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","expires_in":7200,"max_uses":5,"duration_ms":15}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.165+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"3de81dbac2d240868e03868d1bde6cd8","trace_id":"3de81dbac2d240868e03868d1bde6cd8","span_id":"f7cc9693422bc45e","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"3de81dbac2d240868e03868d1bde6cd8","trace_id":"3de81dbac2d240868e03868d1bde6cd8","span_id":"f7cc9693422bc45e","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":201,"duration":0.015848333}
--- PASS: TestOAuthHandler_CreateOneTimeToken_WithAllFields (0.02s)
=== RUN   TestOAuthHandler_CreateOneTimeToken_WithDefaultValues
{"level":"INFO","timestamp":"2025-06-26T13:02:15.165+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"675236bb4c93421d2a5e3f5c84345223","trace_id":"675236bb4c93421d2a5e3f5c84345223","span_id":"14ce80c4b048a1e4","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"675236bb4c93421d2a5e3f5c84345223","trace_id":"675236bb4c93421d2a5e3f5c84345223","span_id":"14ce80c4b048a1e4","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.165+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"675236bb4c93421d2a5e3f5c84345223","trace_id":"675236bb4c93421d2a5e3f5c84345223","span_id":"14ce80c4b048a1e4","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.165+0530","caller":"rest/oauth_handler.go:380","message":"One-time token validation passed","request_id":"675236bb4c93421d2a5e3f5c84345223","trace_id":"675236bb4c93421d2a5e3f5c84345223","span_id":"14ce80c4b048a1e4","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","url":"https://app.example.com/survey/123","session_id":"survey-session-456","expires_in":0,"max_uses":0}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.181+0530","caller":"rest/oauth_handler.go:421","message":"Business event","request_id":"675236bb4c93421d2a5e3f5c84345223","trace_id":"675236bb4c93421d2a5e3f5c84345223","span_id":"14ce80c4b048a1e4","event_type":"one_time_token_created","user_id":"","tenant_id":"","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","expires_in":0,"max_uses":0,"duration_ms":16}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.181+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"675236bb4c93421d2a5e3f5c84345223","trace_id":"675236bb4c93421d2a5e3f5c84345223","span_id":"14ce80c4b048a1e4","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"675236bb4c93421d2a5e3f5c84345223","trace_id":"675236bb4c93421d2a5e3f5c84345223","span_id":"14ce80c4b048a1e4","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":201,"duration":0.016642792}
--- PASS: TestOAuthHandler_CreateOneTimeToken_WithDefaultValues (0.02s)
=== RUN   TestOAuthHandler_CreateOneTimeToken_WithInvalidJSON
{"level":"INFO","timestamp":"2025-06-26T13:02:15.182+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"a26ff70139551d555e686e49b0e424ed","trace_id":"a26ff70139551d555e686e49b0e424ed","span_id":"c6f2e47d10884267","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"a26ff70139551d555e686e49b0e424ed","trace_id":"a26ff70139551d555e686e49b0e424ed","span_id":"c6f2e47d10884267","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.182+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"a26ff70139551d555e686e49b0e424ed","trace_id":"a26ff70139551d555e686e49b0e424ed","span_id":"c6f2e47d10884267","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.182+0530","caller":"rest/oauth_handler.go:371","message":"One-time token validation failed","request_id":"a26ff70139551d555e686e49b0e424ed","trace_id":"a26ff70139551d555e686e49b0e424ed","span_id":"c6f2e47d10884267","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","error":"unexpected EOF","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).CreateOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:371\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithInvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithInvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:638\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.182+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"a26ff70139551d555e686e49b0e424ed","trace_id":"a26ff70139551d555e686e49b0e424ed","span_id":"c6f2e47d10884267","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"a26ff70139551d555e686e49b0e424ed","trace_id":"a26ff70139551d555e686e49b0e424ed","span_id":"c6f2e47d10884267","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000104041}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.182+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"a26ff70139551d555e686e49b0e424ed","trace_id":"a26ff70139551d555e686e49b0e424ed","span_id":"c6f2e47d10884267","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":44,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithInvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithInvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:638\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_CreateOneTimeToken_WithInvalidJSON (0.00s)
=== RUN   TestOAuthHandler_CreateOneTimeToken_WithEmptyBody
{"level":"INFO","timestamp":"2025-06-26T13:02:15.182+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"7cc8175d2a9f5f579ebe1426af0e945c","trace_id":"7cc8175d2a9f5f579ebe1426af0e945c","span_id":"a06466033fd10a28","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"7cc8175d2a9f5f579ebe1426af0e945c","trace_id":"7cc8175d2a9f5f579ebe1426af0e945c","span_id":"a06466033fd10a28","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.182+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"7cc8175d2a9f5f579ebe1426af0e945c","trace_id":"7cc8175d2a9f5f579ebe1426af0e945c","span_id":"a06466033fd10a28","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.182+0530","caller":"rest/oauth_handler.go:371","message":"One-time token validation failed","request_id":"7cc8175d2a9f5f579ebe1426af0e945c","trace_id":"7cc8175d2a9f5f579ebe1426af0e945c","span_id":"a06466033fd10a28","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","error":"EOF","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).CreateOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:371\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithEmptyBody.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithEmptyBody\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:665\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.182+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"7cc8175d2a9f5f579ebe1426af0e945c","trace_id":"7cc8175d2a9f5f579ebe1426af0e945c","span_id":"a06466033fd10a28","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"7cc8175d2a9f5f579ebe1426af0e945c","trace_id":"7cc8175d2a9f5f579ebe1426af0e945c","span_id":"a06466033fd10a28","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000083416}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.182+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"7cc8175d2a9f5f579ebe1426af0e945c","trace_id":"7cc8175d2a9f5f579ebe1426af0e945c","span_id":"a06466033fd10a28","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithEmptyBody.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithEmptyBody\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:665\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_CreateOneTimeToken_WithEmptyBody (0.00s)
=== RUN   TestOAuthHandler_VerifyOneTimeToken_WithAllFields
{"level":"INFO","timestamp":"2025-06-26T13:02:15.182+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"52d46bce0abe7590407972e40af5b2a9","trace_id":"52d46bce0abe7590407972e40af5b2a9","span_id":"e14891d9b5de1674","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"52d46bce0abe7590407972e40af5b2a9","trace_id":"52d46bce0abe7590407972e40af5b2a9","span_id":"e14891d9b5de1674","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.182+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"52d46bce0abe7590407972e40af5b2a9","trace_id":"52d46bce0abe7590407972e40af5b2a9","span_id":"e14891d9b5de1674","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.182+0530","caller":"rest/oauth_handler.go:488","message":"One-time token verification validation passed","request_id":"52d46bce0abe7590407972e40af5b2a9","trace_id":"52d46bce0abe7590407972e40af5b2a9","span_id":"e14891d9b5de1674","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","token_prefix":"one-time-t...","session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.192+0530","caller":"rest/oauth_handler.go:542","message":"Business event","request_id":"52d46bce0abe7590407972e40af5b2a9","trace_id":"52d46bce0abe7590407972e40af5b2a9","span_id":"e14891d9b5de1674","event_type":"one_time_token_verified","user_id":"anonymous-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","is_valid":true,"duration_ms":10}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.192+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"52d46bce0abe7590407972e40af5b2a9","trace_id":"52d46bce0abe7590407972e40af5b2a9","span_id":"e14891d9b5de1674","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"52d46bce0abe7590407972e40af5b2a9","trace_id":"52d46bce0abe7590407972e40af5b2a9","span_id":"e14891d9b5de1674","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.010267}
--- PASS: TestOAuthHandler_VerifyOneTimeToken_WithAllFields (0.01s)
=== RUN   TestOAuthHandler_VerifyOneTimeToken_WithMissingSessionID
{"level":"INFO","timestamp":"2025-06-26T13:02:15.192+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"f3e9fe29d66c27545211c714d038f324","trace_id":"f3e9fe29d66c27545211c714d038f324","span_id":"dcce84c1674ca190","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"f3e9fe29d66c27545211c714d038f324","trace_id":"f3e9fe29d66c27545211c714d038f324","span_id":"dcce84c1674ca190","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.192+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"f3e9fe29d66c27545211c714d038f324","trace_id":"f3e9fe29d66c27545211c714d038f324","span_id":"dcce84c1674ca190","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.192+0530","caller":"rest/oauth_handler.go:479","message":"One-time token verification failed - missing session ID","request_id":"f3e9fe29d66c27545211c714d038f324","trace_id":"f3e9fe29d66c27545211c714d038f324","span_id":"dcce84c1674ca190","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).VerifyOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:479\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithMissingSessionID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithMissingSessionID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:723\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.192+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"f3e9fe29d66c27545211c714d038f324","trace_id":"f3e9fe29d66c27545211c714d038f324","span_id":"dcce84c1674ca190","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"f3e9fe29d66c27545211c714d038f324","trace_id":"f3e9fe29d66c27545211c714d038f324","span_id":"dcce84c1674ca190","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000086541}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.192+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"f3e9fe29d66c27545211c714d038f324","trace_id":"f3e9fe29d66c27545211c714d038f324","span_id":"dcce84c1674ca190","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithMissingSessionID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithMissingSessionID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:723\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_VerifyOneTimeToken_WithMissingSessionID (0.00s)
=== RUN   TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken
{"level":"INFO","timestamp":"2025-06-26T13:02:15.193+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"50221e6b20100c28b7609d8eebbcc922","trace_id":"50221e6b20100c28b7609d8eebbcc922","span_id":"47fef2ca805e240f","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"50221e6b20100c28b7609d8eebbcc922","trace_id":"50221e6b20100c28b7609d8eebbcc922","span_id":"47fef2ca805e240f","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.193+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"50221e6b20100c28b7609d8eebbcc922","trace_id":"50221e6b20100c28b7609d8eebbcc922","span_id":"47fef2ca805e240f","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.193+0530","caller":"rest/oauth_handler.go:488","message":"One-time token verification validation passed","request_id":"50221e6b20100c28b7609d8eebbcc922","trace_id":"50221e6b20100c28b7609d8eebbcc922","span_id":"47fef2ca805e240f","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","token_prefix":"invalid-to...","session_id":"invalid-session"}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.204+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"50221e6b20100c28b7609d8eebbcc922","trace_id":"50221e6b20100c28b7609d8eebbcc922","span_id":"47fef2ca805e240f","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"50221e6b20100c28b7609d8eebbcc922","trace_id":"50221e6b20100c28b7609d8eebbcc922","span_id":"47fef2ca805e240f","user_id":"","tenant_id":"","auth_method":"one_time_token","reason":"invalid_token","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).VerifyOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:513\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:750\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.204+0530","caller":"rest/oauth_handler.go:514","message":"One-time token verification failed - invalid token or session","request_id":"50221e6b20100c28b7609d8eebbcc922","trace_id":"50221e6b20100c28b7609d8eebbcc922","span_id":"47fef2ca805e240f","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).VerifyOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:514\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:750\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.204+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"50221e6b20100c28b7609d8eebbcc922","trace_id":"50221e6b20100c28b7609d8eebbcc922","span_id":"47fef2ca805e240f","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"50221e6b20100c28b7609d8eebbcc922","trace_id":"50221e6b20100c28b7609d8eebbcc922","span_id":"47fef2ca805e240f","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":401,"duration":0.011347208}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.204+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"50221e6b20100c28b7609d8eebbcc922","trace_id":"50221e6b20100c28b7609d8eebbcc922","span_id":"47fef2ca805e240f","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:750\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken (0.01s)
=== RUN   TestOAuthHandler_RefreshSession_WithAllFields
{"level":"INFO","timestamp":"2025-06-26T13:02:15.204+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"137c010bccca71375384aa7ad293c160","trace_id":"137c010bccca71375384aa7ad293c160","span_id":"87e8f0792ac17aa4","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"137c010bccca71375384aa7ad293c160","trace_id":"137c010bccca71375384aa7ad293c160","span_id":"87e8f0792ac17aa4","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.204+0530","caller":"rest/oauth_handler.go:580","message":"Session refresh initiated","request_id":"137c010bccca71375384aa7ad293c160","trace_id":"137c010bccca71375384aa7ad293c160","span_id":"87e8f0792ac17aa4","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/oauth/refresh","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.204+0530","caller":"rest/oauth_handler.go:598","message":"Session refresh validation passed","request_id":"137c010bccca71375384aa7ad293c160","trace_id":"137c010bccca71375384aa7ad293c160","span_id":"87e8f0792ac17aa4","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","token_prefix":"one-time-t...","session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.213+0530","caller":"rest/oauth_handler.go:637","message":"Business event","request_id":"137c010bccca71375384aa7ad293c160","trace_id":"137c010bccca71375384aa7ad293c160","span_id":"87e8f0792ac17aa4","event_type":"session_refreshed","user_id":"anonymous-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","duration_ms":9,"session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.213+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"137c010bccca71375384aa7ad293c160","trace_id":"137c010bccca71375384aa7ad293c160","span_id":"87e8f0792ac17aa4","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"137c010bccca71375384aa7ad293c160","trace_id":"137c010bccca71375384aa7ad293c160","span_id":"87e8f0792ac17aa4","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.009180625}
--- PASS: TestOAuthHandler_RefreshSession_WithAllFields (0.01s)
=== RUN   TestOAuthHandler_RefreshSession_WithInvalidJSON
{"level":"INFO","timestamp":"2025-06-26T13:02:15.214+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"c519b9bd123b25bccb45491c6e09e253","trace_id":"c519b9bd123b25bccb45491c6e09e253","span_id":"7c45e4a0a269ed02","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"c519b9bd123b25bccb45491c6e09e253","trace_id":"c519b9bd123b25bccb45491c6e09e253","span_id":"7c45e4a0a269ed02","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.214+0530","caller":"rest/oauth_handler.go:580","message":"Session refresh initiated","request_id":"c519b9bd123b25bccb45491c6e09e253","trace_id":"c519b9bd123b25bccb45491c6e09e253","span_id":"7c45e4a0a269ed02","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/oauth/refresh","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.214+0530","caller":"rest/oauth_handler.go:589","message":"Session refresh failed - missing parameters","request_id":"c519b9bd123b25bccb45491c6e09e253","trace_id":"c519b9bd123b25bccb45491c6e09e253","span_id":"7c45e4a0a269ed02","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).RefreshSession\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:589\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithInvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithInvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:810\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.214+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"c519b9bd123b25bccb45491c6e09e253","trace_id":"c519b9bd123b25bccb45491c6e09e253","span_id":"7c45e4a0a269ed02","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"c519b9bd123b25bccb45491c6e09e253","trace_id":"c519b9bd123b25bccb45491c6e09e253","span_id":"7c45e4a0a269ed02","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000321708}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.214+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"c519b9bd123b25bccb45491c6e09e253","trace_id":"c519b9bd123b25bccb45491c6e09e253","span_id":"7c45e4a0a269ed02","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":33,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithInvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithInvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:810\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_RefreshSession_WithInvalidJSON (0.00s)
=== RUN   TestOAuthHandler_RefreshSession_WithEmptyBody
{"level":"INFO","timestamp":"2025-06-26T13:02:15.214+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"b53d29b0dd876355175094c5133befaa","trace_id":"b53d29b0dd876355175094c5133befaa","span_id":"25b185d097b13523","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"b53d29b0dd876355175094c5133befaa","trace_id":"b53d29b0dd876355175094c5133befaa","span_id":"25b185d097b13523","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.214+0530","caller":"rest/oauth_handler.go:580","message":"Session refresh initiated","request_id":"b53d29b0dd876355175094c5133befaa","trace_id":"b53d29b0dd876355175094c5133befaa","span_id":"25b185d097b13523","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/oauth/refresh","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.214+0530","caller":"rest/oauth_handler.go:589","message":"Session refresh failed - missing parameters","request_id":"b53d29b0dd876355175094c5133befaa","trace_id":"b53d29b0dd876355175094c5133befaa","span_id":"25b185d097b13523","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).RefreshSession\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:589\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithEmptyBody.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithEmptyBody\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:837\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.214+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"b53d29b0dd876355175094c5133befaa","trace_id":"b53d29b0dd876355175094c5133befaa","span_id":"25b185d097b13523","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"b53d29b0dd876355175094c5133befaa","trace_id":"b53d29b0dd876355175094c5133befaa","span_id":"25b185d097b13523","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000080375}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.214+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"b53d29b0dd876355175094c5133befaa","trace_id":"b53d29b0dd876355175094c5133befaa","span_id":"25b185d097b13523","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithEmptyBody.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithEmptyBody\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:837\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_RefreshSession_WithEmptyBody (0.00s)
=== RUN   TestOAuthHandler_ClientCredentials_WithScope
{"level":"INFO","timestamp":"2025-06-26T13:02:15.214+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"f26645344b5bc44b78fb117d9f5e0bb6","trace_id":"f26645344b5bc44b78fb117d9f5e0bb6","span_id":"79945aa12a7e4f00","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"f26645344b5bc44b78fb117d9f5e0bb6","trace_id":"f26645344b5bc44b78fb117d9f5e0bb6","span_id":"79945aa12a7e4f00","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.214+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"f26645344b5bc44b78fb117d9f5e0bb6","trace_id":"f26645344b5bc44b78fb117d9f5e0bb6","span_id":"79945aa12a7e4f00","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.214+0530","caller":"rest/oauth_handler.go:277","message":"Client credentials validation passed","request_id":"f26645344b5bc44b78fb117d9f5e0bb6","trace_id":"f26645344b5bc44b78fb117d9f5e0bb6","span_id":"79945aa12a7e4f00","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","client_id":"test-client-id","grant_type":"client_credentials","scope":"read:users write:users"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.235+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"f26645344b5bc44b78fb117d9f5e0bb6","trace_id":"f26645344b5bc44b78fb117d9f5e0bb6","span_id":"79945aa12a7e4f00","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"f26645344b5bc44b78fb117d9f5e0bb6","trace_id":"f26645344b5bc44b78fb117d9f5e0bb6","span_id":"79945aa12a7e4f00","user_id":"test-client-id","tenant_id":"","auth_method":"client_credentials","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.235+0530","caller":"rest/oauth_handler.go:310","message":"Business event","request_id":"f26645344b5bc44b78fb117d9f5e0bb6","trace_id":"f26645344b5bc44b78fb117d9f5e0bb6","span_id":"79945aa12a7e4f00","event_type":"client_credentials_success","user_id":"test-client-id","tenant_id":"","client_ip":"192.0.2.1:1234","scope":"read:users write:users","duration_ms":21}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.236+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"f26645344b5bc44b78fb117d9f5e0bb6","trace_id":"f26645344b5bc44b78fb117d9f5e0bb6","span_id":"79945aa12a7e4f00","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"f26645344b5bc44b78fb117d9f5e0bb6","trace_id":"f26645344b5bc44b78fb117d9f5e0bb6","span_id":"79945aa12a7e4f00","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.0213695}
--- PASS: TestOAuthHandler_ClientCredentials_WithScope (0.02s)
=== RUN   TestOAuthHandler_ClientCredentials_WithoutScope
{"level":"INFO","timestamp":"2025-06-26T13:02:15.236+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"4dc3688ca88d28bb4690d9f7dcc6d123","trace_id":"4dc3688ca88d28bb4690d9f7dcc6d123","span_id":"64ea0bf56efb8f46","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"4dc3688ca88d28bb4690d9f7dcc6d123","trace_id":"4dc3688ca88d28bb4690d9f7dcc6d123","span_id":"64ea0bf56efb8f46","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.236+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"4dc3688ca88d28bb4690d9f7dcc6d123","trace_id":"4dc3688ca88d28bb4690d9f7dcc6d123","span_id":"64ea0bf56efb8f46","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.236+0530","caller":"rest/oauth_handler.go:277","message":"Client credentials validation passed","request_id":"4dc3688ca88d28bb4690d9f7dcc6d123","trace_id":"4dc3688ca88d28bb4690d9f7dcc6d123","span_id":"64ea0bf56efb8f46","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","client_id":"test-client-id","grant_type":"client_credentials","scope":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.256+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"4dc3688ca88d28bb4690d9f7dcc6d123","trace_id":"4dc3688ca88d28bb4690d9f7dcc6d123","span_id":"64ea0bf56efb8f46","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"4dc3688ca88d28bb4690d9f7dcc6d123","trace_id":"4dc3688ca88d28bb4690d9f7dcc6d123","span_id":"64ea0bf56efb8f46","user_id":"test-client-id","tenant_id":"","auth_method":"client_credentials","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.257+0530","caller":"rest/oauth_handler.go:310","message":"Business event","request_id":"4dc3688ca88d28bb4690d9f7dcc6d123","trace_id":"4dc3688ca88d28bb4690d9f7dcc6d123","span_id":"64ea0bf56efb8f46","event_type":"client_credentials_success","user_id":"test-client-id","tenant_id":"","client_ip":"192.0.2.1:1234","scope":"","duration_ms":20}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.257+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"4dc3688ca88d28bb4690d9f7dcc6d123","trace_id":"4dc3688ca88d28bb4690d9f7dcc6d123","span_id":"64ea0bf56efb8f46","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"4dc3688ca88d28bb4690d9f7dcc6d123","trace_id":"4dc3688ca88d28bb4690d9f7dcc6d123","span_id":"64ea0bf56efb8f46","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.020665208}
--- PASS: TestOAuthHandler_ClientCredentials_WithoutScope (0.02s)
=== RUN   TestOAuthHandler_ClientCredentials_WithEmptyScope
{"level":"INFO","timestamp":"2025-06-26T13:02:15.257+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"acf3983a41c0983108dde7a6b447967c","trace_id":"acf3983a41c0983108dde7a6b447967c","span_id":"1b67ffd222afaa2e","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"acf3983a41c0983108dde7a6b447967c","trace_id":"acf3983a41c0983108dde7a6b447967c","span_id":"1b67ffd222afaa2e","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.257+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"acf3983a41c0983108dde7a6b447967c","trace_id":"acf3983a41c0983108dde7a6b447967c","span_id":"1b67ffd222afaa2e","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.257+0530","caller":"rest/oauth_handler.go:277","message":"Client credentials validation passed","request_id":"acf3983a41c0983108dde7a6b447967c","trace_id":"acf3983a41c0983108dde7a6b447967c","span_id":"1b67ffd222afaa2e","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","client_id":"test-client-id","grant_type":"client_credentials","scope":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.278+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"acf3983a41c0983108dde7a6b447967c","trace_id":"acf3983a41c0983108dde7a6b447967c","span_id":"1b67ffd222afaa2e","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"acf3983a41c0983108dde7a6b447967c","trace_id":"acf3983a41c0983108dde7a6b447967c","span_id":"1b67ffd222afaa2e","user_id":"test-client-id","tenant_id":"","auth_method":"client_credentials","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.278+0530","caller":"rest/oauth_handler.go:310","message":"Business event","request_id":"acf3983a41c0983108dde7a6b447967c","trace_id":"acf3983a41c0983108dde7a6b447967c","span_id":"1b67ffd222afaa2e","event_type":"client_credentials_success","user_id":"test-client-id","tenant_id":"","client_ip":"192.0.2.1:1234","scope":"","duration_ms":21}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.279+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"acf3983a41c0983108dde7a6b447967c","trace_id":"acf3983a41c0983108dde7a6b447967c","span_id":"1b67ffd222afaa2e","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"acf3983a41c0983108dde7a6b447967c","trace_id":"acf3983a41c0983108dde7a6b447967c","span_id":"1b67ffd222afaa2e","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.021828125}
--- PASS: TestOAuthHandler_ClientCredentials_WithEmptyScope (0.02s)
=== RUN   TestOAuthHandler_GoogleLogin_WithEmptyRedirectURI
{"level":"INFO","timestamp":"2025-06-26T13:02:15.279+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"a12c788bdf01bddf5519dc3c809307b9","trace_id":"a12c788bdf01bddf5519dc3c809307b9","span_id":"ef0b062fb58cfa7b","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"a12c788bdf01bddf5519dc3c809307b9","trace_id":"a12c788bdf01bddf5519dc3c809307b9","span_id":"ef0b062fb58cfa7b","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.279+0530","caller":"rest/oauth_handler.go:65","message":"Google OAuth login initiated","request_id":"a12c788bdf01bddf5519dc3c809307b9","trace_id":"a12c788bdf01bddf5519dc3c809307b9","span_id":"ef0b062fb58cfa7b","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/login","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.279+0530","caller":"rest/oauth_handler.go:84","message":"Google OAuth login validation passed","request_id":"a12c788bdf01bddf5519dc3c809307b9","trace_id":"a12c788bdf01bddf5519dc3c809307b9","span_id":"ef0b062fb58cfa7b","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","tenant_id":"tenant-123","redirect_uri":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.279+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"a12c788bdf01bddf5519dc3c809307b9","trace_id":"a12c788bdf01bddf5519dc3c809307b9","span_id":"ef0b062fb58cfa7b","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"a12c788bdf01bddf5519dc3c809307b9","trace_id":"a12c788bdf01bddf5519dc3c809307b9","span_id":"ef0b062fb58cfa7b","provider":"google","step":"login_initiated","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.279+0530","caller":"rest/oauth_handler.go:101","message":"Business event","request_id":"a12c788bdf01bddf5519dc3c809307b9","trace_id":"a12c788bdf01bddf5519dc3c809307b9","span_id":"ef0b062fb58cfa7b","event_type":"oauth_login_initiated","user_id":"","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","redirect_uri":"http://localhost:8080/api/v1/oauth/google/callback","duration_ms":0,"provider":"google"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.279+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"a12c788bdf01bddf5519dc3c809307b9","trace_id":"a12c788bdf01bddf5519dc3c809307b9","span_id":"ef0b062fb58cfa7b","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"a12c788bdf01bddf5519dc3c809307b9","trace_id":"a12c788bdf01bddf5519dc3c809307b9","span_id":"ef0b062fb58cfa7b","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.000194875}
--- PASS: TestOAuthHandler_GoogleLogin_WithEmptyRedirectURI (0.00s)
=== RUN   TestOAuthHandler_GoogleCallback_WithEmptyState
{"level":"INFO","timestamp":"2025-06-26T13:02:15.280+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"66e6451715f91d02ad5256592afa14da","trace_id":"66e6451715f91d02ad5256592afa14da","span_id":"e62fa2b001acfb77","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"66e6451715f91d02ad5256592afa14da","trace_id":"66e6451715f91d02ad5256592afa14da","span_id":"e62fa2b001acfb77","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.280+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"66e6451715f91d02ad5256592afa14da","trace_id":"66e6451715f91d02ad5256592afa14da","span_id":"e62fa2b001acfb77","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.280+0530","caller":"rest/oauth_handler.go:174","message":"Google OAuth callback validation passed","request_id":"66e6451715f91d02ad5256592afa14da","trace_id":"66e6451715f91d02ad5256592afa14da","span_id":"e62fa2b001acfb77","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","tenant_id":"","code_prefix":"test-auth-..."}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.331+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"66e6451715f91d02ad5256592afa14da","trace_id":"66e6451715f91d02ad5256592afa14da","span_id":"e62fa2b001acfb77","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"66e6451715f91d02ad5256592afa14da","trace_id":"66e6451715f91d02ad5256592afa14da","span_id":"e62fa2b001acfb77","user_id":"google-user-123","tenant_id":"","auth_method":"google_oauth","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.331+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"66e6451715f91d02ad5256592afa14da","trace_id":"66e6451715f91d02ad5256592afa14da","span_id":"e62fa2b001acfb77","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"66e6451715f91d02ad5256592afa14da","trace_id":"66e6451715f91d02ad5256592afa14da","span_id":"e62fa2b001acfb77","provider":"google","step":"callback_success","tenant_id":"","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.331+0530","caller":"rest/oauth_handler.go:209","message":"Business event","request_id":"66e6451715f91d02ad5256592afa14da","trace_id":"66e6451715f91d02ad5256592afa14da","span_id":"e62fa2b001acfb77","event_type":"oauth_login_completed","user_id":"google-user-123","tenant_id":"","client_ip":"192.0.2.1:1234","provider":"google","duration_ms":51}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.331+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"66e6451715f91d02ad5256592afa14da","trace_id":"66e6451715f91d02ad5256592afa14da","span_id":"e62fa2b001acfb77","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"66e6451715f91d02ad5256592afa14da","trace_id":"66e6451715f91d02ad5256592afa14da","span_id":"e62fa2b001acfb77","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.051831}
--- PASS: TestOAuthHandler_GoogleCallback_WithEmptyState (0.05s)
=== RUN   TestOAuthHandler_GoogleCallback_WithOnlyCode
{"level":"INFO","timestamp":"2025-06-26T13:02:15.332+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"0595ec1bca078c469c72c9403c301d59","trace_id":"0595ec1bca078c469c72c9403c301d59","span_id":"9f0b979f79958c73","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"0595ec1bca078c469c72c9403c301d59","trace_id":"0595ec1bca078c469c72c9403c301d59","span_id":"9f0b979f79958c73","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.332+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"0595ec1bca078c469c72c9403c301d59","trace_id":"0595ec1bca078c469c72c9403c301d59","span_id":"9f0b979f79958c73","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.332+0530","caller":"rest/oauth_handler.go:174","message":"Google OAuth callback validation passed","request_id":"0595ec1bca078c469c72c9403c301d59","trace_id":"0595ec1bca078c469c72c9403c301d59","span_id":"9f0b979f79958c73","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","tenant_id":"","code_prefix":"test-auth-..."}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.382+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"0595ec1bca078c469c72c9403c301d59","trace_id":"0595ec1bca078c469c72c9403c301d59","span_id":"9f0b979f79958c73","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"0595ec1bca078c469c72c9403c301d59","trace_id":"0595ec1bca078c469c72c9403c301d59","span_id":"9f0b979f79958c73","user_id":"google-user-123","tenant_id":"","auth_method":"google_oauth","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.382+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"0595ec1bca078c469c72c9403c301d59","trace_id":"0595ec1bca078c469c72c9403c301d59","span_id":"9f0b979f79958c73","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"0595ec1bca078c469c72c9403c301d59","trace_id":"0595ec1bca078c469c72c9403c301d59","span_id":"9f0b979f79958c73","provider":"google","step":"callback_success","tenant_id":"","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.382+0530","caller":"rest/oauth_handler.go:209","message":"Business event","request_id":"0595ec1bca078c469c72c9403c301d59","trace_id":"0595ec1bca078c469c72c9403c301d59","span_id":"9f0b979f79958c73","event_type":"oauth_login_completed","user_id":"google-user-123","tenant_id":"","client_ip":"192.0.2.1:1234","provider":"google","duration_ms":50}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.382+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"0595ec1bca078c469c72c9403c301d59","trace_id":"0595ec1bca078c469c72c9403c301d59","span_id":"9f0b979f79958c73","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"0595ec1bca078c469c72c9403c301d59","trace_id":"0595ec1bca078c469c72c9403c301d59","span_id":"9f0b979f79958c73","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.050434208}
--- PASS: TestOAuthHandler_GoogleCallback_WithOnlyCode (0.05s)
=== RUN   TestOAuthHandler_GoogleCallback_WithOnlyError
{"level":"INFO","timestamp":"2025-06-26T13:02:15.382+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"3d7f945e3624ac8f3bfeea0883d76087","trace_id":"3d7f945e3624ac8f3bfeea0883d76087","span_id":"86b5dccfe8a6e998","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"3d7f945e3624ac8f3bfeea0883d76087","trace_id":"3d7f945e3624ac8f3bfeea0883d76087","span_id":"86b5dccfe8a6e998","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.382+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"3d7f945e3624ac8f3bfeea0883d76087","trace_id":"3d7f945e3624ac8f3bfeea0883d76087","span_id":"86b5dccfe8a6e998","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.382+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"3d7f945e3624ac8f3bfeea0883d76087","trace_id":"3d7f945e3624ac8f3bfeea0883d76087","span_id":"86b5dccfe8a6e998","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"3d7f945e3624ac8f3bfeea0883d76087","trace_id":"3d7f945e3624ac8f3bfeea0883d76087","span_id":"86b5dccfe8a6e998","user_id":"","tenant_id":"","auth_method":"google_oauth","reason":"oauth_error","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).GoogleCallback\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:153\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_WithOnlyError.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_WithOnlyError\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:1063\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:15.382+0530","caller":"logger/logger.go:225","message":"OAuth flow failed","request_id":"3d7f945e3624ac8f3bfeea0883d76087","trace_id":"3d7f945e3624ac8f3bfeea0883d76087","span_id":"86b5dccfe8a6e998","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"3d7f945e3624ac8f3bfeea0883d76087","trace_id":"3d7f945e3624ac8f3bfeea0883d76087","span_id":"86b5dccfe8a6e998","provider":"google","step":"callback_error","tenant_id":"","client_ip":"192.0.2.1:1234","error":"oauth error: access_denied","stacktrace":"auth-service/internal/logger.(*RequestLogger).OAuthFlow\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:225\nauth-service/internal/handler/rest.(*OAuthHandler).GoogleCallback\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:154\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_WithOnlyError.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_WithOnlyError\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:1063\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.382+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"3d7f945e3624ac8f3bfeea0883d76087","trace_id":"3d7f945e3624ac8f3bfeea0883d76087","span_id":"86b5dccfe8a6e998","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"3d7f945e3624ac8f3bfeea0883d76087","trace_id":"3d7f945e3624ac8f3bfeea0883d76087","span_id":"86b5dccfe8a6e998","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000070666}
{"level":"WARN","timestamp":"2025-06-26T13:02:15.382+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"3d7f945e3624ac8f3bfeea0883d76087","trace_id":"3d7f945e3624ac8f3bfeea0883d76087","span_id":"86b5dccfe8a6e998","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_WithOnlyError.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_WithOnlyError\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:1063\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_GoogleCallback_WithOnlyError (0.00s)
=== RUN   TestOAuthHandler_Integration
=== RUN   TestOAuthHandler_Integration/GoogleLogin
{"level":"INFO","timestamp":"2025-06-26T13:02:15.383+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"f040ebf42aabad11b72c2b9ad971ff72","trace_id":"f040ebf42aabad11b72c2b9ad971ff72","span_id":"9e8f148b5b25320b","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"f040ebf42aabad11b72c2b9ad971ff72","trace_id":"f040ebf42aabad11b72c2b9ad971ff72","span_id":"9e8f148b5b25320b","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.383+0530","caller":"rest/oauth_handler.go:65","message":"Google OAuth login initiated","request_id":"f040ebf42aabad11b72c2b9ad971ff72","trace_id":"f040ebf42aabad11b72c2b9ad971ff72","span_id":"9e8f148b5b25320b","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/login","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.383+0530","caller":"rest/oauth_handler.go:84","message":"Google OAuth login validation passed","request_id":"f040ebf42aabad11b72c2b9ad971ff72","trace_id":"f040ebf42aabad11b72c2b9ad971ff72","span_id":"9e8f148b5b25320b","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","tenant_id":"tenant-123","redirect_uri":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.383+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"f040ebf42aabad11b72c2b9ad971ff72","trace_id":"f040ebf42aabad11b72c2b9ad971ff72","span_id":"9e8f148b5b25320b","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"f040ebf42aabad11b72c2b9ad971ff72","trace_id":"f040ebf42aabad11b72c2b9ad971ff72","span_id":"9e8f148b5b25320b","provider":"google","step":"login_initiated","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.383+0530","caller":"rest/oauth_handler.go:101","message":"Business event","request_id":"f040ebf42aabad11b72c2b9ad971ff72","trace_id":"f040ebf42aabad11b72c2b9ad971ff72","span_id":"9e8f148b5b25320b","event_type":"oauth_login_initiated","user_id":"","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","provider":"google","redirect_uri":"http://localhost:8080/api/v1/oauth/google/callback","duration_ms":0}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.383+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"f040ebf42aabad11b72c2b9ad971ff72","trace_id":"f040ebf42aabad11b72c2b9ad971ff72","span_id":"9e8f148b5b25320b","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"f040ebf42aabad11b72c2b9ad971ff72","trace_id":"f040ebf42aabad11b72c2b9ad971ff72","span_id":"9e8f148b5b25320b","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.000039167}
=== RUN   TestOAuthHandler_Integration/GoogleCallback
{"level":"INFO","timestamp":"2025-06-26T13:02:15.383+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"9f70c22464af5caa6f7898641777b03a","trace_id":"9f70c22464af5caa6f7898641777b03a","span_id":"7b1744465a7f5edc","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"9f70c22464af5caa6f7898641777b03a","trace_id":"9f70c22464af5caa6f7898641777b03a","span_id":"7b1744465a7f5edc","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.383+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"9f70c22464af5caa6f7898641777b03a","trace_id":"9f70c22464af5caa6f7898641777b03a","span_id":"7b1744465a7f5edc","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.383+0530","caller":"rest/oauth_handler.go:174","message":"Google OAuth callback validation passed","request_id":"9f70c22464af5caa6f7898641777b03a","trace_id":"9f70c22464af5caa6f7898641777b03a","span_id":"7b1744465a7f5edc","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","tenant_id":"tenant-123","code_prefix":"test-code..."}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.434+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"9f70c22464af5caa6f7898641777b03a","trace_id":"9f70c22464af5caa6f7898641777b03a","span_id":"7b1744465a7f5edc","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"9f70c22464af5caa6f7898641777b03a","trace_id":"9f70c22464af5caa6f7898641777b03a","span_id":"7b1744465a7f5edc","user_id":"google-user-123","tenant_id":"tenant-123","auth_method":"google_oauth","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.434+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"9f70c22464af5caa6f7898641777b03a","trace_id":"9f70c22464af5caa6f7898641777b03a","span_id":"7b1744465a7f5edc","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"9f70c22464af5caa6f7898641777b03a","trace_id":"9f70c22464af5caa6f7898641777b03a","span_id":"7b1744465a7f5edc","provider":"google","step":"callback_success","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.434+0530","caller":"rest/oauth_handler.go:209","message":"Business event","request_id":"9f70c22464af5caa6f7898641777b03a","trace_id":"9f70c22464af5caa6f7898641777b03a","span_id":"7b1744465a7f5edc","event_type":"oauth_login_completed","user_id":"google-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","provider":"google","duration_ms":51}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.434+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"9f70c22464af5caa6f7898641777b03a","trace_id":"9f70c22464af5caa6f7898641777b03a","span_id":"7b1744465a7f5edc","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"9f70c22464af5caa6f7898641777b03a","trace_id":"9f70c22464af5caa6f7898641777b03a","span_id":"7b1744465a7f5edc","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.051151834}
=== RUN   TestOAuthHandler_Integration/ClientCredentials
{"level":"INFO","timestamp":"2025-06-26T13:02:15.434+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"f24c3cee9ef0b7ae3549664736a79f38","trace_id":"f24c3cee9ef0b7ae3549664736a79f38","span_id":"85a1538c2ec71aa5","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"f24c3cee9ef0b7ae3549664736a79f38","trace_id":"f24c3cee9ef0b7ae3549664736a79f38","span_id":"85a1538c2ec71aa5","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.434+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"f24c3cee9ef0b7ae3549664736a79f38","trace_id":"f24c3cee9ef0b7ae3549664736a79f38","span_id":"85a1538c2ec71aa5","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.434+0530","caller":"rest/oauth_handler.go:277","message":"Client credentials validation passed","request_id":"f24c3cee9ef0b7ae3549664736a79f38","trace_id":"f24c3cee9ef0b7ae3549664736a79f38","span_id":"85a1538c2ec71aa5","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","client_id":"test-client-id","grant_type":"client_credentials","scope":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.455+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"f24c3cee9ef0b7ae3549664736a79f38","trace_id":"f24c3cee9ef0b7ae3549664736a79f38","span_id":"85a1538c2ec71aa5","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"f24c3cee9ef0b7ae3549664736a79f38","trace_id":"f24c3cee9ef0b7ae3549664736a79f38","span_id":"85a1538c2ec71aa5","user_id":"test-client-id","tenant_id":"","auth_method":"client_credentials","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.455+0530","caller":"rest/oauth_handler.go:310","message":"Business event","request_id":"f24c3cee9ef0b7ae3549664736a79f38","trace_id":"f24c3cee9ef0b7ae3549664736a79f38","span_id":"85a1538c2ec71aa5","event_type":"client_credentials_success","user_id":"test-client-id","tenant_id":"","client_ip":"192.0.2.1:1234","scope":"","duration_ms":21}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.455+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"f24c3cee9ef0b7ae3549664736a79f38","trace_id":"f24c3cee9ef0b7ae3549664736a79f38","span_id":"85a1538c2ec71aa5","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"f24c3cee9ef0b7ae3549664736a79f38","trace_id":"f24c3cee9ef0b7ae3549664736a79f38","span_id":"85a1538c2ec71aa5","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.021150291}
=== RUN   TestOAuthHandler_Integration/CreateOneTimeToken
{"level":"INFO","timestamp":"2025-06-26T13:02:15.455+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"bff045ba98cfa3c49b5adb6bea8f8a5a","trace_id":"bff045ba98cfa3c49b5adb6bea8f8a5a","span_id":"c453bfbb94e25f41","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"bff045ba98cfa3c49b5adb6bea8f8a5a","trace_id":"bff045ba98cfa3c49b5adb6bea8f8a5a","span_id":"c453bfbb94e25f41","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.455+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"bff045ba98cfa3c49b5adb6bea8f8a5a","trace_id":"bff045ba98cfa3c49b5adb6bea8f8a5a","span_id":"c453bfbb94e25f41","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.455+0530","caller":"rest/oauth_handler.go:380","message":"One-time token validation passed","request_id":"bff045ba98cfa3c49b5adb6bea8f8a5a","trace_id":"bff045ba98cfa3c49b5adb6bea8f8a5a","span_id":"c453bfbb94e25f41","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","url":"https://app.example.com/survey/123","session_id":"survey-session-456","expires_in":0,"max_uses":0}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.471+0530","caller":"rest/oauth_handler.go:421","message":"Business event","request_id":"bff045ba98cfa3c49b5adb6bea8f8a5a","trace_id":"bff045ba98cfa3c49b5adb6bea8f8a5a","span_id":"c453bfbb94e25f41","event_type":"one_time_token_created","user_id":"","tenant_id":"","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","expires_in":0,"max_uses":0,"duration_ms":16}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.471+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"bff045ba98cfa3c49b5adb6bea8f8a5a","trace_id":"bff045ba98cfa3c49b5adb6bea8f8a5a","span_id":"c453bfbb94e25f41","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"bff045ba98cfa3c49b5adb6bea8f8a5a","trace_id":"bff045ba98cfa3c49b5adb6bea8f8a5a","span_id":"c453bfbb94e25f41","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":201,"duration":0.016237209}
=== RUN   TestOAuthHandler_Integration/VerifyOneTimeToken
{"level":"INFO","timestamp":"2025-06-26T13:02:15.471+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"e4f8f5476bccd8849a833aa58e9c96b7","trace_id":"e4f8f5476bccd8849a833aa58e9c96b7","span_id":"0b528bca2f8f0d01","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"e4f8f5476bccd8849a833aa58e9c96b7","trace_id":"e4f8f5476bccd8849a833aa58e9c96b7","span_id":"0b528bca2f8f0d01","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.471+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"e4f8f5476bccd8849a833aa58e9c96b7","trace_id":"e4f8f5476bccd8849a833aa58e9c96b7","span_id":"0b528bca2f8f0d01","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.471+0530","caller":"rest/oauth_handler.go:488","message":"One-time token verification validation passed","request_id":"e4f8f5476bccd8849a833aa58e9c96b7","trace_id":"e4f8f5476bccd8849a833aa58e9c96b7","span_id":"0b528bca2f8f0d01","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","token_prefix":"one-time-t...","session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.482+0530","caller":"rest/oauth_handler.go:542","message":"Business event","request_id":"e4f8f5476bccd8849a833aa58e9c96b7","trace_id":"e4f8f5476bccd8849a833aa58e9c96b7","span_id":"0b528bca2f8f0d01","event_type":"one_time_token_verified","user_id":"anonymous-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","is_valid":true,"duration_ms":10}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.482+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"e4f8f5476bccd8849a833aa58e9c96b7","trace_id":"e4f8f5476bccd8849a833aa58e9c96b7","span_id":"0b528bca2f8f0d01","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"e4f8f5476bccd8849a833aa58e9c96b7","trace_id":"e4f8f5476bccd8849a833aa58e9c96b7","span_id":"0b528bca2f8f0d01","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.010541542}
=== RUN   TestOAuthHandler_Integration/RefreshSession
{"level":"INFO","timestamp":"2025-06-26T13:02:15.482+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"e7e3a559f8253bb8e389e2d46f03edaf","trace_id":"e7e3a559f8253bb8e389e2d46f03edaf","span_id":"edc4f47afaa00602","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"e7e3a559f8253bb8e389e2d46f03edaf","trace_id":"e7e3a559f8253bb8e389e2d46f03edaf","span_id":"edc4f47afaa00602","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.482+0530","caller":"rest/oauth_handler.go:580","message":"Session refresh initiated","request_id":"e7e3a559f8253bb8e389e2d46f03edaf","trace_id":"e7e3a559f8253bb8e389e2d46f03edaf","span_id":"edc4f47afaa00602","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/oauth/refresh","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.482+0530","caller":"rest/oauth_handler.go:598","message":"Session refresh validation passed","request_id":"e7e3a559f8253bb8e389e2d46f03edaf","trace_id":"e7e3a559f8253bb8e389e2d46f03edaf","span_id":"edc4f47afaa00602","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","token_prefix":"one-time-t...","session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.491+0530","caller":"rest/oauth_handler.go:637","message":"Business event","request_id":"e7e3a559f8253bb8e389e2d46f03edaf","trace_id":"e7e3a559f8253bb8e389e2d46f03edaf","span_id":"edc4f47afaa00602","event_type":"session_refreshed","user_id":"anonymous-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","duration_ms":8}
{"level":"INFO","timestamp":"2025-06-26T13:02:15.491+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"e7e3a559f8253bb8e389e2d46f03edaf","trace_id":"e7e3a559f8253bb8e389e2d46f03edaf","span_id":"edc4f47afaa00602","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"e7e3a559f8253bb8e389e2d46f03edaf","trace_id":"e7e3a559f8253bb8e389e2d46f03edaf","span_id":"edc4f47afaa00602","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.008997042}
--- PASS: TestOAuthHandler_Integration (0.11s)
    --- PASS: TestOAuthHandler_Integration/GoogleLogin (0.00s)
    --- PASS: TestOAuthHandler_Integration/GoogleCallback (0.05s)
    --- PASS: TestOAuthHandler_Integration/ClientCredentials (0.02s)
    --- PASS: TestOAuthHandler_Integration/CreateOneTimeToken (0.02s)
    --- PASS: TestOAuthHandler_Integration/VerifyOneTimeToken (0.01s)
    --- PASS: TestOAuthHandler_Integration/RefreshSession (0.01s)
PASS
coverage: 37.9% of statements
ok  	auth-service/internal/handler/rest	1.946s	coverage: 37.9% of statements
=== RUN   TestNewLogger
--- PASS: TestNewLogger (0.00s)
=== RUN   TestLogger_WithRequest
--- PASS: TestLogger_WithRequest (0.00s)
=== RUN   TestLogger_WithRequest_NoHeaders
--- PASS: TestLogger_WithRequest_NoHeaders (0.00s)
=== RUN   TestRequestLogger_Methods
{"level":"INFO","timestamp":"2025-06-26T13:02:13.937+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"35a32bc346a774e86cdd9c9dafe21cf7","trace_id":"35a32bc346a774e86cdd9c9dafe21cf7","span_id":"e03c9c5631dd961c","method":"GET","path":"/test","client_ip":"192.0.2.1:1234","request_id":"35a32bc346a774e86cdd9c9dafe21cf7","trace_id":"35a32bc346a774e86cdd9c9dafe21cf7","span_id":"e03c9c5631dd961c","parent_span_id":"","method":"GET","path":"/test","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T13:02:13.937+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"35a32bc346a774e86cdd9c9dafe21cf7","trace_id":"35a32bc346a774e86cdd9c9dafe21cf7","span_id":"e03c9c5631dd961c","method":"GET","path":"/test","client_ip":"192.0.2.1:1234","request_id":"35a32bc346a774e86cdd9c9dafe21cf7","trace_id":"35a32bc346a774e86cdd9c9dafe21cf7","span_id":"e03c9c5631dd961c","parent_span_id":"","method":"GET","path":"/test","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.0000001}
{"level":"INFO","timestamp":"2025-06-26T13:02:13.937+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"35a32bc346a774e86cdd9c9dafe21cf7","trace_id":"35a32bc346a774e86cdd9c9dafe21cf7","span_id":"e03c9c5631dd961c","method":"GET","path":"/test","client_ip":"192.0.2.1:1234","request_id":"35a32bc346a774e86cdd9c9dafe21cf7","trace_id":"35a32bc346a774e86cdd9c9dafe21cf7","span_id":"e03c9c5631dd961c","user_id":"user-123","tenant_id":"tenant-123","auth_method":"password","client_ip":"192.0.2.1:1234"}
{"level":"WARN","timestamp":"2025-06-26T13:02:13.937+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"35a32bc346a774e86cdd9c9dafe21cf7","trace_id":"35a32bc346a774e86cdd9c9dafe21cf7","span_id":"e03c9c5631dd961c","method":"GET","path":"/test","client_ip":"192.0.2.1:1234","request_id":"35a32bc346a774e86cdd9c9dafe21cf7","trace_id":"35a32bc346a774e86cdd9c9dafe21cf7","span_id":"e03c9c5631dd961c","user_id":"user-123","tenant_id":"tenant-123","auth_method":"password","reason":"invalid_credentials","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/logger.TestRequestLogger_Methods\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger_test.go:94\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:13.937+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"35a32bc346a774e86cdd9c9dafe21cf7","trace_id":"35a32bc346a774e86cdd9c9dafe21cf7","span_id":"e03c9c5631dd961c","method":"GET","path":"/test","client_ip":"192.0.2.1:1234","request_id":"35a32bc346a774e86cdd9c9dafe21cf7","trace_id":"35a32bc346a774e86cdd9c9dafe21cf7","span_id":"e03c9c5631dd961c","provider":"google","step":"login_initiated","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"WARN","timestamp":"2025-06-26T13:02:13.937+0530","caller":"logger/logger_test.go:98","message":"Security event","request_id":"35a32bc346a774e86cdd9c9dafe21cf7","trace_id":"35a32bc346a774e86cdd9c9dafe21cf7","span_id":"e03c9c5631dd961c","event_type":"login_attempt","user_id":"user-123","tenant_id":"tenant-123","details":"Multiple failed attempts","severity":"medium","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.TestRequestLogger_Methods\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger_test.go:98\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T13:02:13.937+0530","caller":"logger/logger_test.go:99","message":"Business event","request_id":"35a32bc346a774e86cdd9c9dafe21cf7","trace_id":"35a32bc346a774e86cdd9c9dafe21cf7","span_id":"e03c9c5631dd961c","event_type":"user_login","user_id":"user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","login_method":"password","success":true}
{"level":"INFO","timestamp":"2025-06-26T13:02:13.937+0530","caller":"logger/logger_test.go:103","message":"Test info message","request_id":"35a32bc346a774e86cdd9c9dafe21cf7","trace_id":"35a32bc346a774e86cdd9c9dafe21cf7","span_id":"e03c9c5631dd961c","method":"GET","path":"/test","client_ip":"192.0.2.1:1234"}
{"level":"WARN","timestamp":"2025-06-26T13:02:13.937+0530","caller":"logger/logger_test.go:104","message":"Test warning message","request_id":"35a32bc346a774e86cdd9c9dafe21cf7","trace_id":"35a32bc346a774e86cdd9c9dafe21cf7","span_id":"e03c9c5631dd961c","method":"GET","path":"/test","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.TestRequestLogger_Methods\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger_test.go:104\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T13:02:13.937+0530","caller":"logger/logger_test.go:105","message":"Test error message","request_id":"35a32bc346a774e86cdd9c9dafe21cf7","trace_id":"35a32bc346a774e86cdd9c9dafe21cf7","span_id":"e03c9c5631dd961c","method":"GET","path":"/test","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.TestRequestLogger_Methods\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger_test.go:105\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestRequestLogger_Methods (0.00s)
PASS
coverage: 62.7% of statements
ok  	auth-service/internal/logger	0.393s	coverage: 62.7% of statements
=== RUN   TestActuatorMiddleware
--- PASS: TestActuatorMiddleware (0.00s)
=== RUN   TestHealthCheckMiddleware
--- PASS: TestHealthCheckMiddleware (0.00s)
=== RUN   TestRBACMiddleware_UserHasPermission_Success
--- PASS: TestRBACMiddleware_UserHasPermission_Success (0.00s)
=== RUN   TestRBACMiddleware_UserDoesNotHavePermission
--- PASS: TestRBACMiddleware_UserDoesNotHavePermission (0.00s)
=== RUN   TestRBACMiddleware_MissingUserID
--- PASS: TestRBACMiddleware_MissingUserID (0.00s)
=== RUN   TestRBACMiddleware_MissingTenantID
--- PASS: TestRBACMiddleware_MissingTenantID (0.00s)
=== RUN   TestRBACMiddleware_RBACServiceError
--- PASS: TestRBACMiddleware_RBACServiceError (0.00s)
=== RUN   TestRBACMiddleware_DifferentPermissions
--- PASS: TestRBACMiddleware_DifferentPermissions (0.00s)
=== RUN   TestRBACMiddleware_DifferentUsers
--- PASS: TestRBACMiddleware_DifferentUsers (0.00s)
=== RUN   TestRBACMiddleware_DifferentTenants
--- PASS: TestRBACMiddleware_DifferentTenants (0.00s)
PASS
coverage: 20.9% of statements
ok  	auth-service/internal/middleware	2.187s	coverage: 20.9% of statements
=== RUN   TestRole_Structure
--- PASS: TestRole_Structure (0.00s)
=== RUN   TestRole_DefaultRole
--- PASS: TestRole_DefaultRole (0.00s)
=== RUN   TestPermission_Structure
--- PASS: TestPermission_Structure (0.00s)
=== RUN   TestRolePermission_Structure
--- PASS: TestRolePermission_Structure (0.00s)
=== RUN   TestUserRole_Structure
--- PASS: TestUserRole_Structure (0.00s)
=== RUN   TestServiceRole_Structure
--- PASS: TestServiceRole_Structure (0.00s)
=== RUN   TestRole_EmptyFields
--- PASS: TestRole_EmptyFields (0.00s)
=== RUN   TestPermission_EmptyFields
--- PASS: TestPermission_EmptyFields (0.00s)
=== RUN   TestRolePermission_EmptyFields
--- PASS: TestRolePermission_EmptyFields (0.00s)
=== RUN   TestUserRole_EmptyFields
--- PASS: TestUserRole_EmptyFields (0.00s)
=== RUN   TestServiceRole_EmptyFields
--- PASS: TestServiceRole_EmptyFields (0.00s)
=== RUN   TestRole_ComplexName
--- PASS: TestRole_ComplexName (0.00s)
=== RUN   TestPermission_ComplexName
--- PASS: TestPermission_ComplexName (0.00s)
=== RUN   TestRole_WithSpecialCharacters
--- PASS: TestRole_WithSpecialCharacters (0.00s)
=== RUN   TestPermission_WithSpecialCharacters
--- PASS: TestPermission_WithSpecialCharacters (0.00s)
=== RUN   TestRolePermission_WithSpecialCharacters
--- PASS: TestRolePermission_WithSpecialCharacters (0.00s)
=== RUN   TestUserRole_WithSpecialCharacters
--- PASS: TestUserRole_WithSpecialCharacters (0.00s)
=== RUN   TestServiceRole_WithSpecialCharacters
--- PASS: TestServiceRole_WithSpecialCharacters (0.00s)
=== RUN   TestRole_Validation
=== RUN   TestRole_Validation/Valid_role
=== RUN   TestRole_Validation/Empty_ID
=== RUN   TestRole_Validation/Empty_TenantID
=== RUN   TestRole_Validation/Empty_Name
--- PASS: TestRole_Validation (0.00s)
    --- PASS: TestRole_Validation/Valid_role (0.00s)
    --- PASS: TestRole_Validation/Empty_ID (0.00s)
    --- PASS: TestRole_Validation/Empty_TenantID (0.00s)
    --- PASS: TestRole_Validation/Empty_Name (0.00s)
=== RUN   TestPermission_Validation
=== RUN   TestPermission_Validation/Valid_permission
=== RUN   TestPermission_Validation/Empty_ID
=== RUN   TestPermission_Validation/Empty_Name
--- PASS: TestPermission_Validation (0.00s)
    --- PASS: TestPermission_Validation/Valid_permission (0.00s)
    --- PASS: TestPermission_Validation/Empty_ID (0.00s)
    --- PASS: TestPermission_Validation/Empty_Name (0.00s)
=== RUN   TestRolePermission_Validation
=== RUN   TestRolePermission_Validation/Valid_role_permission
=== RUN   TestRolePermission_Validation/Empty_RoleID
=== RUN   TestRolePermission_Validation/Empty_PermissionID
--- PASS: TestRolePermission_Validation (0.00s)
    --- PASS: TestRolePermission_Validation/Valid_role_permission (0.00s)
    --- PASS: TestRolePermission_Validation/Empty_RoleID (0.00s)
    --- PASS: TestRolePermission_Validation/Empty_PermissionID (0.00s)
=== RUN   TestUserRole_Validation
=== RUN   TestUserRole_Validation/Valid_user_role
=== RUN   TestUserRole_Validation/Empty_UserID
=== RUN   TestUserRole_Validation/Empty_RoleID
=== RUN   TestUserRole_Validation/Empty_TenantID
--- PASS: TestUserRole_Validation (0.00s)
    --- PASS: TestUserRole_Validation/Valid_user_role (0.00s)
    --- PASS: TestUserRole_Validation/Empty_UserID (0.00s)
    --- PASS: TestUserRole_Validation/Empty_RoleID (0.00s)
    --- PASS: TestUserRole_Validation/Empty_TenantID (0.00s)
=== RUN   TestServiceRole_Validation
=== RUN   TestServiceRole_Validation/Valid_service_role
=== RUN   TestServiceRole_Validation/Empty_ServiceID
=== RUN   TestServiceRole_Validation/Empty_RoleID
=== RUN   TestServiceRole_Validation/Empty_TenantID
--- PASS: TestServiceRole_Validation (0.00s)
    --- PASS: TestServiceRole_Validation/Valid_service_role (0.00s)
    --- PASS: TestServiceRole_Validation/Empty_ServiceID (0.00s)
    --- PASS: TestServiceRole_Validation/Empty_RoleID (0.00s)
    --- PASS: TestServiceRole_Validation/Empty_TenantID (0.00s)
PASS
coverage: 0.0% of statements
ok  	auth-service/internal/models	2.519s	coverage: 0.0% of statements
=== RUN   TestTenantBasedOTPDigitLength
=== RUN   TestTenantBasedOTPDigitLength/Basic_tenant_should_have_4-digit_OTP
2025/06/26 13:02:16 [OTP-EMAIL] Sent OTP 1235 to test@example.com (tenant: tenant-basic)
=== RUN   TestTenantBasedOTPDigitLength/Pro_tenant_should_have_6-digit_OTP
2025/06/26 13:02:16 [OTP-EMAIL] Sent OTP 100037 to test@example.com (tenant: tenant-pro)
=== RUN   TestTenantBasedOTPDigitLength/Enterprise_tenant_should_have_8-digit_OTP
2025/06/26 13:02:16 [OTP-EMAIL] Sent OTP 10000189 to test@example.com (tenant: tenant-enterprise)
=== RUN   TestTenantBasedOTPDigitLength/Unknown_tenant_should_default_to_6-digit_OTP
2025/06/26 13:02:16 [OTP-EMAIL] Sent OTP 100045 to test@example.com (tenant: unknown-tenant)
--- PASS: TestTenantBasedOTPDigitLength (0.00s)
    --- PASS: TestTenantBasedOTPDigitLength/Basic_tenant_should_have_4-digit_OTP (0.00s)
    --- PASS: TestTenantBasedOTPDigitLength/Pro_tenant_should_have_6-digit_OTP (0.00s)
    --- PASS: TestTenantBasedOTPDigitLength/Enterprise_tenant_should_have_8-digit_OTP (0.00s)
    --- PASS: TestTenantBasedOTPDigitLength/Unknown_tenant_should_default_to_6-digit_OTP (0.00s)
=== RUN   TestOTPDigitLengthValidation
=== RUN   TestOTPDigitLengthValidation/Invalid_length_0
=== RUN   TestOTPDigitLengthValidation/Invalid_length_1
=== RUN   TestOTPDigitLengthValidation/Invalid_length_2
=== RUN   TestOTPDigitLengthValidation/Invalid_length_3
=== RUN   TestOTPDigitLengthValidation/Invalid_length_11
=== RUN   TestOTPDigitLengthValidation/Invalid_length_15
=== RUN   TestOTPDigitLengthValidation/Valid_length_4
2025/06/26 13:02:16 [OTP-EMAIL] Sent OTP 1142 to test@example.com (tenant: test-tenant)
=== RUN   TestOTPDigitLengthValidation/Valid_length_6
2025/06/26 13:02:16 [OTP-EMAIL] Sent OTP 100091 to test@example.com (tenant: test-tenant)
=== RUN   TestOTPDigitLengthValidation/Valid_length_8
2025/06/26 13:02:16 [OTP-EMAIL] Sent OTP 10000077 to test@example.com (tenant: test-tenant)
=== RUN   TestOTPDigitLengthValidation/Valid_length_10
2025/06/26 13:02:16 [OTP-EMAIL] Sent OTP 1000000030 to test@example.com (tenant: test-tenant)
--- PASS: TestOTPDigitLengthValidation (0.00s)
    --- PASS: TestOTPDigitLengthValidation/Invalid_length_0 (0.00s)
    --- PASS: TestOTPDigitLengthValidation/Invalid_length_1 (0.00s)
    --- PASS: TestOTPDigitLengthValidation/Invalid_length_2 (0.00s)
    --- PASS: TestOTPDigitLengthValidation/Invalid_length_3 (0.00s)
    --- PASS: TestOTPDigitLengthValidation/Invalid_length_11 (0.00s)
    --- PASS: TestOTPDigitLengthValidation/Invalid_length_15 (0.00s)
    --- PASS: TestOTPDigitLengthValidation/Valid_length_4 (0.00s)
    --- PASS: TestOTPDigitLengthValidation/Valid_length_6 (0.00s)
    --- PASS: TestOTPDigitLengthValidation/Valid_length_8 (0.00s)
    --- PASS: TestOTPDigitLengthValidation/Valid_length_10 (0.00s)
=== RUN   TestOTPGenerationWithDifferentLengths
=== RUN   TestOTPGenerationWithDifferentLengths/Length_4
2025/06/26 13:02:16 [OTP-EMAIL] Sent OTP 1126 to test@example.com (tenant: test-tenant)
=== RUN   TestOTPGenerationWithDifferentLengths/Length_6
2025/06/26 13:02:16 [OTP-EMAIL] Sent OTP 100043 to test@example.com (tenant: test-tenant)
=== RUN   TestOTPGenerationWithDifferentLengths/Length_8
2025/06/26 13:02:16 [OTP-EMAIL] Sent OTP 10000079 to test@example.com (tenant: test-tenant)
--- PASS: TestOTPGenerationWithDifferentLengths (0.00s)
    --- PASS: TestOTPGenerationWithDifferentLengths/Length_4 (0.00s)
    --- PASS: TestOTPGenerationWithDifferentLengths/Length_6 (0.00s)
    --- PASS: TestOTPGenerationWithDifferentLengths/Length_8 (0.00s)
=== RUN   TestTriggerTwoFactorAuth
=== RUN   TestTriggerTwoFactorAuth/Successful_2FA_trigger
2025/06/26 13:02:16 [2FA] Triggered EMAIL 2FA for user user-123 (client: tenant-pro, message_id: test-message-id)
=== RUN   TestTriggerTwoFactorAuth/Invalid_subscription
=== RUN   TestTriggerTwoFactorAuth/Feature_disabled
=== RUN   TestTriggerTwoFactorAuth/Quota_exceeded
=== RUN   TestTriggerTwoFactorAuth/Invalid_channel
=== RUN   TestTriggerTwoFactorAuth/Subscription_service_error
=== RUN   TestTriggerTwoFactorAuth/Notification_service_error
=== RUN   TestTriggerTwoFactorAuth/Different_tenant_configurations
=== RUN   TestTriggerTwoFactorAuth/Different_tenant_configurations/Tenant_tenant-basic
2025/06/26 13:02:16 [2FA] Triggered EMAIL 2FA for user user-123 (client: tenant-basic, message_id: test-message-id)
=== RUN   TestTriggerTwoFactorAuth/Different_tenant_configurations/Tenant_tenant-pro
2025/06/26 13:02:16 [2FA] Triggered EMAIL 2FA for user user-123 (client: tenant-pro, message_id: test-message-id)
=== RUN   TestTriggerTwoFactorAuth/Different_tenant_configurations/Tenant_tenant-enterprise
2025/06/26 13:02:16 [2FA] Triggered EMAIL 2FA for user user-123 (client: tenant-enterprise, message_id: test-message-id)
=== RUN   TestTriggerTwoFactorAuth/Different_tenant_configurations/Tenant_unknown-tenant
2025/06/26 13:02:16 [2FA] Triggered EMAIL 2FA for user user-123 (client: unknown-tenant, message_id: test-message-id)
--- PASS: TestTriggerTwoFactorAuth (0.00s)
    --- PASS: TestTriggerTwoFactorAuth/Successful_2FA_trigger (0.00s)
    --- PASS: TestTriggerTwoFactorAuth/Invalid_subscription (0.00s)
    --- PASS: TestTriggerTwoFactorAuth/Feature_disabled (0.00s)
    --- PASS: TestTriggerTwoFactorAuth/Quota_exceeded (0.00s)
    --- PASS: TestTriggerTwoFactorAuth/Invalid_channel (0.00s)
    --- PASS: TestTriggerTwoFactorAuth/Subscription_service_error (0.00s)
    --- PASS: TestTriggerTwoFactorAuth/Notification_service_error (0.00s)
    --- PASS: TestTriggerTwoFactorAuth/Different_tenant_configurations (0.00s)
        --- PASS: TestTriggerTwoFactorAuth/Different_tenant_configurations/Tenant_tenant-basic (0.00s)
        --- PASS: TestTriggerTwoFactorAuth/Different_tenant_configurations/Tenant_tenant-pro (0.00s)
        --- PASS: TestTriggerTwoFactorAuth/Different_tenant_configurations/Tenant_tenant-enterprise (0.00s)
        --- PASS: TestTriggerTwoFactorAuth/Different_tenant_configurations/Tenant_unknown-tenant (0.00s)
=== RUN   TestRBACService_AssignRoleToUser_Success
--- PASS: TestRBACService_AssignRoleToUser_Success (0.00s)
=== RUN   TestRBACService_AssignRoleToUser_Error
--- PASS: TestRBACService_AssignRoleToUser_Error (0.00s)
=== RUN   TestRBACService_AssignRoleToService_Success
--- PASS: TestRBACService_AssignRoleToService_Success (0.00s)
=== RUN   TestRBACService_AssignRoleToService_Error
--- PASS: TestRBACService_AssignRoleToService_Error (0.00s)
=== RUN   TestRBACService_AssignPermissionToRole_Success
--- PASS: TestRBACService_AssignPermissionToRole_Success (0.00s)
=== RUN   TestRBACService_AssignPermissionToRole_Error
--- PASS: TestRBACService_AssignPermissionToRole_Error (0.00s)
=== RUN   TestRBACService_UserHasPermission_Success
--- PASS: TestRBACService_UserHasPermission_Success (0.00s)
=== RUN   TestRBACService_UserHasPermission_NoPermission
--- PASS: TestRBACService_UserHasPermission_NoPermission (0.00s)
=== RUN   TestRBACService_UserHasPermission_Error
--- PASS: TestRBACService_UserHasPermission_Error (0.00s)
=== RUN   TestRBACService_ServiceHasPermission_Success
--- PASS: TestRBACService_ServiceHasPermission_Success (0.00s)
=== RUN   TestRBACService_ServiceHasPermission_NoPermission
--- PASS: TestRBACService_ServiceHasPermission_NoPermission (0.00s)
=== RUN   TestRBACService_ServiceHasPermission_Error
--- PASS: TestRBACService_ServiceHasPermission_Error (0.00s)
=== RUN   TestRBACService_GetUserRoles_Success
--- PASS: TestRBACService_GetUserRoles_Success (0.00s)
=== RUN   TestRBACService_GetUserRoles_Error
--- PASS: TestRBACService_GetUserRoles_Error (0.00s)
=== RUN   TestRBACService_GetRolePermissions_Success
--- PASS: TestRBACService_GetRolePermissions_Success (0.00s)
=== RUN   TestRBACService_GetRolePermissions_Error
--- PASS: TestRBACService_GetRolePermissions_Error (0.00s)
=== RUN   TestRBACService_Integration_UserRoleAssignment
--- PASS: TestRBACService_Integration_UserRoleAssignment (0.00s)
=== RUN   TestRBACService_Integration_ServiceRoleAssignment
--- PASS: TestRBACService_Integration_ServiceRoleAssignment (0.00s)
PASS
coverage: 32.4% of statements
ok  	auth-service/internal/service	2.569s	coverage: 32.4% of statements
=== RUN   TestExtractTracingFromRequest_StandardHeaders
--- PASS: TestExtractTracingFromRequest_StandardHeaders (0.00s)
=== RUN   TestExtractTracingFromRequest_XRayHeaders
--- PASS: TestExtractTracingFromRequest_XRayHeaders (0.00s)
=== RUN   TestExtractTracingFromRequest_CloudTraceHeaders
--- PASS: TestExtractTracingFromRequest_CloudTraceHeaders (0.00s)
=== RUN   TestExtractTracingFromRequest_RequestIDFallback
--- PASS: TestExtractTracingFromRequest_RequestIDFallback (0.00s)
=== RUN   TestExtractTracingFromRequest_NoHeaders
--- PASS: TestExtractTracingFromRequest_NoHeaders (0.00s)
=== RUN   TestExtractXRayTraceID
=== RUN   TestExtractXRayTraceID/valid_xray_header
=== RUN   TestExtractXRayTraceID/xray_header_without_parent
=== RUN   TestExtractXRayTraceID/invalid_xray_header
=== RUN   TestExtractXRayTraceID/empty_header
--- PASS: TestExtractXRayTraceID (0.00s)
    --- PASS: TestExtractXRayTraceID/valid_xray_header (0.00s)
    --- PASS: TestExtractXRayTraceID/xray_header_without_parent (0.00s)
    --- PASS: TestExtractXRayTraceID/invalid_xray_header (0.00s)
    --- PASS: TestExtractXRayTraceID/empty_header (0.00s)
=== RUN   TestExtractXRaySpanID
=== RUN   TestExtractXRaySpanID/valid_xray_header_with_parent
=== RUN   TestExtractXRaySpanID/xray_header_without_parent
=== RUN   TestExtractXRaySpanID/invalid_xray_header
--- PASS: TestExtractXRaySpanID (0.00s)
    --- PASS: TestExtractXRaySpanID/valid_xray_header_with_parent (0.00s)
    --- PASS: TestExtractXRaySpanID/xray_header_without_parent (0.00s)
    --- PASS: TestExtractXRaySpanID/invalid_xray_header (0.00s)
=== RUN   TestExtractCloudTraceID
=== RUN   TestExtractCloudTraceID/valid_cloud_trace_header
=== RUN   TestExtractCloudTraceID/cloud_trace_header_without_span
=== RUN   TestExtractCloudTraceID/invalid_cloud_trace_header
=== RUN   TestExtractCloudTraceID/empty_header
--- PASS: TestExtractCloudTraceID (0.00s)
    --- PASS: TestExtractCloudTraceID/valid_cloud_trace_header (0.00s)
    --- PASS: TestExtractCloudTraceID/cloud_trace_header_without_span (0.00s)
    --- PASS: TestExtractCloudTraceID/invalid_cloud_trace_header (0.00s)
    --- PASS: TestExtractCloudTraceID/empty_header (0.00s)
=== RUN   TestGenerateTraceID
--- PASS: TestGenerateTraceID (0.00s)
=== RUN   TestGenerateSpanID
--- PASS: TestGenerateSpanID (0.00s)
=== RUN   TestAddTracingHeaders
--- PASS: TestAddTracingHeaders (0.00s)
=== RUN   TestGetTracingContextFromContext
--- PASS: TestGetTracingContextFromContext (0.00s)
=== RUN   TestCreateSpan
--- PASS: TestCreateSpan (0.00s)
=== RUN   TestPropagateTracing
--- PASS: TestPropagateTracing (0.00s)
=== RUN   TestTracingContext_String
--- PASS: TestTracingContext_String (0.00s)
=== RUN   TestExtractTracingFromRequest_PriorityOrder
--- PASS: TestExtractTracingFromRequest_PriorityOrder (0.00s)
=== RUN   TestExtractTracingFromRequest_RequestIDPriority
--- PASS: TestExtractTracingFromRequest_RequestIDPriority (0.00s)
PASS
coverage: 89.7% of statements
ok  	auth-service/internal/tracing	2.457s	coverage: 89.7% of statements
