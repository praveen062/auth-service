=== RUN   TestAuthHandler_Login_Success
{"level":"INFO","timestamp":"2025-06-26T01:18:53.958+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"ac10900418eedb0cbb3ad3c61e309095","trace_id":"ac10900418eedb0cbb3ad3c61e309095","span_id":"6bf9fc7e860b8d64","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"ac10900418eedb0cbb3ad3c61e309095","trace_id":"ac10900418eedb0cbb3ad3c61e309095","span_id":"6bf9fc7e860b8d64","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:53.958+0530","caller":"rest/auth_handler.go:95","message":"Login attempt started","request_id":"ac10900418eedb0cbb3ad3c61e309095","trace_id":"ac10900418eedb0cbb3ad3c61e309095","span_id":"6bf9fc7e860b8d64","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","endpoint":"/auth/login","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:53.958+0530","caller":"rest/auth_handler.go:115","message":"Tenant context missing","request_id":"ac10900418eedb0cbb3ad3c61e309095","trace_id":"ac10900418eedb0cbb3ad3c61e309095","span_id":"6bf9fc7e860b8d64","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:115\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_Success.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_Success\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:91\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:53.958+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"ac10900418eedb0cbb3ad3c61e309095","trace_id":"ac10900418eedb0cbb3ad3c61e309095","span_id":"6bf9fc7e860b8d64","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"ac10900418eedb0cbb3ad3c61e309095","trace_id":"ac10900418eedb0cbb3ad3c61e309095","span_id":"6bf9fc7e860b8d64","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":500,"duration":0.000686792}
{"level":"WARN","timestamp":"2025-06-26T01:18:53.958+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"ac10900418eedb0cbb3ad3c61e309095","trace_id":"ac10900418eedb0cbb3ad3c61e309095","span_id":"6bf9fc7e860b8d64","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":78,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Login_Success.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_Success\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:91\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
    auth_handler_test.go:94: 
        	Error Trace:	/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:94
        	Error:      	Not equal: 
        	            	expected: 200
        	            	actual  : 500
        	Test:       	TestAuthHandler_Login_Success
    auth_handler_test.go:100: 
        	Error Trace:	/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:100
        	Error:      	Should NOT be empty, but was 
        	Test:       	TestAuthHandler_Login_Success
    auth_handler_test.go:101: 
        	Error Trace:	/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:101
        	Error:      	Should NOT be empty, but was 
        	Test:       	TestAuthHandler_Login_Success
    auth_handler_test.go:102: 
        	Error Trace:	/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:102
        	Error:      	Not equal: 
        	            	expected: "Bearer"
        	            	actual  : ""
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1 +1 @@
        	            	-Bearer
        	            	+
        	Test:       	TestAuthHandler_Login_Success
    auth_handler_test.go:103: 
        	Error Trace:	/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:103
        	Error:      	Not equal: 
        	            	expected: 3600
        	            	actual  : 0
        	Test:       	TestAuthHandler_Login_Success
    auth_handler_test.go:104: 
        	Error Trace:	/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:104
        	Error:      	Not equal: 
        	            	expected: "test@example.com"
        	            	actual  : ""
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1 +1 @@
        	            	-test@example.com
        	            	+
        	Test:       	TestAuthHandler_Login_Success
    auth_handler_test.go:105: 
        	Error Trace:	/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:105
        	Error:      	Not equal: 
        	            	expected: "tenant-123"
        	            	actual  : ""
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1 +1 @@
        	            	-tenant-123
        	            	+
        	Test:       	TestAuthHandler_Login_Success
    auth_handler_test.go:106: 
        	Error Trace:	/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:106
        	Error:      	"[]" should have 1 item(s), but has 0
        	Test:       	TestAuthHandler_Login_Success
--- FAIL: TestAuthHandler_Login_Success (0.00s)
=== RUN   TestAuthHandler_Login_InvalidEmail
{"level":"INFO","timestamp":"2025-06-26T01:18:53.959+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"1be442fc129182450230819bbd5c6b82","trace_id":"1be442fc129182450230819bbd5c6b82","span_id":"302a039e01125efc","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"1be442fc129182450230819bbd5c6b82","trace_id":"1be442fc129182450230819bbd5c6b82","span_id":"302a039e01125efc","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:53.959+0530","caller":"rest/auth_handler.go:95","message":"Login attempt started","request_id":"1be442fc129182450230819bbd5c6b82","trace_id":"1be442fc129182450230819bbd5c6b82","span_id":"302a039e01125efc","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","endpoint":"/auth/login","method":"POST"}
{"level":"WARN","timestamp":"2025-06-26T01:18:53.959+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"1be442fc129182450230819bbd5c6b82","trace_id":"1be442fc129182450230819bbd5c6b82","span_id":"302a039e01125efc","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"1be442fc129182450230819bbd5c6b82","trace_id":"1be442fc129182450230819bbd5c6b82","span_id":"302a039e01125efc","user_id":"","tenant_id":"","auth_method":"password","reason":"validation_error","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:102\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidEmail.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidEmail\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:134\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:53.959+0530","caller":"rest/auth_handler.go:103","message":"Login validation failed","request_id":"1be442fc129182450230819bbd5c6b82","trace_id":"1be442fc129182450230819bbd5c6b82","span_id":"302a039e01125efc","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","error":"Key: 'LoginRequest.Email' Error:Field validation for 'Email' failed on the 'email' tag","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:103\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidEmail.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidEmail\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:134\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:53.959+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"1be442fc129182450230819bbd5c6b82","trace_id":"1be442fc129182450230819bbd5c6b82","span_id":"302a039e01125efc","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"1be442fc129182450230819bbd5c6b82","trace_id":"1be442fc129182450230819bbd5c6b82","span_id":"302a039e01125efc","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000072958}
{"level":"WARN","timestamp":"2025-06-26T01:18:53.959+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"1be442fc129182450230819bbd5c6b82","trace_id":"1be442fc129182450230819bbd5c6b82","span_id":"302a039e01125efc","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":75,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Login_InvalidEmail.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidEmail\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:134\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_Login_InvalidEmail (0.00s)
=== RUN   TestAuthHandler_Login_MissingFields
{"level":"INFO","timestamp":"2025-06-26T01:18:53.959+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"0348ca7a4392a9a51a064e50481f40a8","trace_id":"0348ca7a4392a9a51a064e50481f40a8","span_id":"65a2b3e7c31b6099","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"0348ca7a4392a9a51a064e50481f40a8","trace_id":"0348ca7a4392a9a51a064e50481f40a8","span_id":"65a2b3e7c31b6099","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:53.959+0530","caller":"rest/auth_handler.go:95","message":"Login attempt started","request_id":"0348ca7a4392a9a51a064e50481f40a8","trace_id":"0348ca7a4392a9a51a064e50481f40a8","span_id":"65a2b3e7c31b6099","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","endpoint":"/auth/login","method":"POST"}
{"level":"WARN","timestamp":"2025-06-26T01:18:53.959+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"0348ca7a4392a9a51a064e50481f40a8","trace_id":"0348ca7a4392a9a51a064e50481f40a8","span_id":"65a2b3e7c31b6099","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"0348ca7a4392a9a51a064e50481f40a8","trace_id":"0348ca7a4392a9a51a064e50481f40a8","span_id":"65a2b3e7c31b6099","user_id":"","tenant_id":"","auth_method":"password","reason":"validation_error","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:102\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_MissingFields.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_MissingFields\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:171\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:53.959+0530","caller":"rest/auth_handler.go:103","message":"Login validation failed","request_id":"0348ca7a4392a9a51a064e50481f40a8","trace_id":"0348ca7a4392a9a51a064e50481f40a8","span_id":"65a2b3e7c31b6099","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","error":"Key: 'LoginRequest.Password' Error:Field validation for 'Password' failed on the 'required' tag","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:103\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_MissingFields.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_MissingFields\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:171\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:53.959+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"0348ca7a4392a9a51a064e50481f40a8","trace_id":"0348ca7a4392a9a51a064e50481f40a8","span_id":"65a2b3e7c31b6099","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"0348ca7a4392a9a51a064e50481f40a8","trace_id":"0348ca7a4392a9a51a064e50481f40a8","span_id":"65a2b3e7c31b6099","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000054333}
{"level":"WARN","timestamp":"2025-06-26T01:18:53.959+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"0348ca7a4392a9a51a064e50481f40a8","trace_id":"0348ca7a4392a9a51a064e50481f40a8","span_id":"65a2b3e7c31b6099","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":28,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Login_MissingFields.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_MissingFields\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:171\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_Login_MissingFields (0.00s)
=== RUN   TestAuthHandler_Register_Success
{"level":"INFO","timestamp":"2025-06-26T01:18:53.959+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"111813532b3d3b316e61e76fa02d052d","trace_id":"111813532b3d3b316e61e76fa02d052d","span_id":"5ccee0c4010cf6c4","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"111813532b3d3b316e61e76fa02d052d","trace_id":"111813532b3d3b316e61e76fa02d052d","span_id":"5ccee0c4010cf6c4","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:53.959+0530","caller":"rest/auth_handler.go:235","message":"Registration attempt started","request_id":"111813532b3d3b316e61e76fa02d052d","trace_id":"111813532b3d3b316e61e76fa02d052d","span_id":"5ccee0c4010cf6c4","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","endpoint":"/auth/register","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T01:18:53.959+0530","caller":"rest/auth_handler.go:251","message":"Registration validation passed","request_id":"111813532b3d3b316e61e76fa02d052d","trace_id":"111813532b3d3b316e61e76fa02d052d","span_id":"5ccee0c4010cf6c4","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","email":"newuser@example.com","tenant_id":"tenant-123","first_name":"John","last_name":"Doe"}
{"level":"INFO","timestamp":"2025-06-26T01:18:53.996+0530","caller":"rest/auth_handler.go:280","message":"Business event","request_id":"111813532b3d3b316e61e76fa02d052d","trace_id":"111813532b3d3b316e61e76fa02d052d","span_id":"5ccee0c4010cf6c4","event_type":"user_registration","user_id":"user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","last_name":"Doe","duration_ms":37,"email":"newuser@example.com","first_name":"John"}
{"level":"INFO","timestamp":"2025-06-26T01:18:53.996+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"111813532b3d3b316e61e76fa02d052d","trace_id":"111813532b3d3b316e61e76fa02d052d","span_id":"5ccee0c4010cf6c4","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"111813532b3d3b316e61e76fa02d052d","trace_id":"111813532b3d3b316e61e76fa02d052d","span_id":"5ccee0c4010cf6c4","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":201,"duration":0.037264375}
--- PASS: TestAuthHandler_Register_Success (0.04s)
=== RUN   TestAuthHandler_Register_InvalidEmail
{"level":"INFO","timestamp":"2025-06-26T01:18:53.997+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"d4fa66350240abc04eca25baf1ca4ed5","trace_id":"d4fa66350240abc04eca25baf1ca4ed5","span_id":"ad9a56ffef06b4a8","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"d4fa66350240abc04eca25baf1ca4ed5","trace_id":"d4fa66350240abc04eca25baf1ca4ed5","span_id":"ad9a56ffef06b4a8","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:53.997+0530","caller":"rest/auth_handler.go:235","message":"Registration attempt started","request_id":"d4fa66350240abc04eca25baf1ca4ed5","trace_id":"d4fa66350240abc04eca25baf1ca4ed5","span_id":"ad9a56ffef06b4a8","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","endpoint":"/auth/register","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:53.997+0530","caller":"rest/auth_handler.go:242","message":"Registration validation failed","request_id":"d4fa66350240abc04eca25baf1ca4ed5","trace_id":"d4fa66350240abc04eca25baf1ca4ed5","span_id":"ad9a56ffef06b4a8","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","error":"Key: 'RegisterRequest.Email' Error:Field validation for 'Email' failed on the 'email' tag","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Register\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:242\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Register_InvalidEmail.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Register_InvalidEmail\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:252\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:53.997+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"d4fa66350240abc04eca25baf1ca4ed5","trace_id":"d4fa66350240abc04eca25baf1ca4ed5","span_id":"ad9a56ffef06b4a8","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"d4fa66350240abc04eca25baf1ca4ed5","trace_id":"d4fa66350240abc04eca25baf1ca4ed5","span_id":"ad9a56ffef06b4a8","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000134916}
{"level":"WARN","timestamp":"2025-06-26T01:18:53.997+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"d4fa66350240abc04eca25baf1ca4ed5","trace_id":"d4fa66350240abc04eca25baf1ca4ed5","span_id":"ad9a56ffef06b4a8","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":113,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Register_InvalidEmail.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Register_InvalidEmail\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:252\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_Register_InvalidEmail (0.00s)
=== RUN   TestAuthHandler_Register_MissingFields
{"level":"INFO","timestamp":"2025-06-26T01:18:53.997+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"39be29188a931484213183c051c9b60d","trace_id":"39be29188a931484213183c051c9b60d","span_id":"98bc0bd4a9a1c9c3","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"39be29188a931484213183c051c9b60d","trace_id":"39be29188a931484213183c051c9b60d","span_id":"98bc0bd4a9a1c9c3","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:53.997+0530","caller":"rest/auth_handler.go:235","message":"Registration attempt started","request_id":"39be29188a931484213183c051c9b60d","trace_id":"39be29188a931484213183c051c9b60d","span_id":"98bc0bd4a9a1c9c3","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","endpoint":"/auth/register","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:53.997+0530","caller":"rest/auth_handler.go:242","message":"Registration validation failed","request_id":"39be29188a931484213183c051c9b60d","trace_id":"39be29188a931484213183c051c9b60d","span_id":"98bc0bd4a9a1c9c3","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","error":"Key: 'RegisterRequest.Password' Error:Field validation for 'Password' failed on the 'required' tag\nKey: 'RegisterRequest.TenantID' Error:Field validation for 'TenantID' failed on the 'required' tag\nKey: 'RegisterRequest.FirstName' Error:Field validation for 'FirstName' failed on the 'required' tag\nKey: 'RegisterRequest.LastName' Error:Field validation for 'LastName' failed on the 'required' tag","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Register\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:242\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Register_MissingFields.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Register_MissingFields\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:289\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:53.997+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"39be29188a931484213183c051c9b60d","trace_id":"39be29188a931484213183c051c9b60d","span_id":"98bc0bd4a9a1c9c3","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"39be29188a931484213183c051c9b60d","trace_id":"39be29188a931484213183c051c9b60d","span_id":"98bc0bd4a9a1c9c3","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000050666}
{"level":"WARN","timestamp":"2025-06-26T01:18:53.997+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"39be29188a931484213183c051c9b60d","trace_id":"39be29188a931484213183c051c9b60d","span_id":"98bc0bd4a9a1c9c3","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":28,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Register_MissingFields.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Register_MissingFields\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:289\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_Register_MissingFields (0.00s)
=== RUN   TestAuthHandler_RefreshToken_Success
{"level":"INFO","timestamp":"2025-06-26T01:18:53.997+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"8fdeb2705636c67a180eea0ade3cab91","trace_id":"8fdeb2705636c67a180eea0ade3cab91","span_id":"62af23efa846b432","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"8fdeb2705636c67a180eea0ade3cab91","trace_id":"8fdeb2705636c67a180eea0ade3cab91","span_id":"62af23efa846b432","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:53.997+0530","caller":"rest/auth_handler.go:323","message":"Token refresh attempt started","request_id":"8fdeb2705636c67a180eea0ade3cab91","trace_id":"8fdeb2705636c67a180eea0ade3cab91","span_id":"62af23efa846b432","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/auth/refresh","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T01:18:53.997+0530","caller":"rest/auth_handler.go:339","message":"Token refresh validation passed","request_id":"8fdeb2705636c67a180eea0ade3cab91","trace_id":"8fdeb2705636c67a180eea0ade3cab91","span_id":"62af23efa846b432","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","refresh_token_prefix":"valid-refr..."}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.002+0530","caller":"rest/auth_handler.go:366","message":"Business event","request_id":"8fdeb2705636c67a180eea0ade3cab91","trace_id":"8fdeb2705636c67a180eea0ade3cab91","span_id":"62af23efa846b432","event_type":"token_refresh","user_id":"user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","duration_ms":5}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.002+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"8fdeb2705636c67a180eea0ade3cab91","trace_id":"8fdeb2705636c67a180eea0ade3cab91","span_id":"62af23efa846b432","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"8fdeb2705636c67a180eea0ade3cab91","trace_id":"8fdeb2705636c67a180eea0ade3cab91","span_id":"62af23efa846b432","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.005388834}
--- PASS: TestAuthHandler_RefreshToken_Success (0.01s)
=== RUN   TestAuthHandler_RefreshToken_MissingToken
{"level":"INFO","timestamp":"2025-06-26T01:18:54.002+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"3f884165677652449304cdc57cbb8059","trace_id":"3f884165677652449304cdc57cbb8059","span_id":"792fab8feca23bfa","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"3f884165677652449304cdc57cbb8059","trace_id":"3f884165677652449304cdc57cbb8059","span_id":"792fab8feca23bfa","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.002+0530","caller":"rest/auth_handler.go:323","message":"Token refresh attempt started","request_id":"3f884165677652449304cdc57cbb8059","trace_id":"3f884165677652449304cdc57cbb8059","span_id":"792fab8feca23bfa","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/auth/refresh","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.002+0530","caller":"rest/auth_handler.go:330","message":"Token refresh validation failed","request_id":"3f884165677652449304cdc57cbb8059","trace_id":"3f884165677652449304cdc57cbb8059","span_id":"792fab8feca23bfa","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","error":"Key: 'RefreshTokenRequest.RefreshToken' Error:Field validation for 'RefreshToken' failed on the 'required' tag","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).RefreshToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:330\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_RefreshToken_MissingToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_RefreshToken_MissingToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:362\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.002+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"3f884165677652449304cdc57cbb8059","trace_id":"3f884165677652449304cdc57cbb8059","span_id":"792fab8feca23bfa","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"3f884165677652449304cdc57cbb8059","trace_id":"3f884165677652449304cdc57cbb8059","span_id":"792fab8feca23bfa","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000079417}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.002+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"3f884165677652449304cdc57cbb8059","trace_id":"3f884165677652449304cdc57cbb8059","span_id":"792fab8feca23bfa","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":2,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_RefreshToken_MissingToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_RefreshToken_MissingToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:362\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_RefreshToken_MissingToken (0.00s)
=== RUN   TestAuthHandler_Logout_Success
{"level":"INFO","timestamp":"2025-06-26T01:18:54.002+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"70e72e030635fc3d462b17515d4f970a","trace_id":"70e72e030635fc3d462b17515d4f970a","span_id":"87c1216844c4f00d","method":"POST","path":"/logout","client_ip":"192.0.2.1:1234","request_id":"70e72e030635fc3d462b17515d4f970a","trace_id":"70e72e030635fc3d462b17515d4f970a","span_id":"87c1216844c4f00d","parent_span_id":"","method":"POST","path":"/logout","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.002+0530","caller":"rest/auth_handler.go:400","message":"Logout attempt started","request_id":"70e72e030635fc3d462b17515d4f970a","trace_id":"70e72e030635fc3d462b17515d4f970a","span_id":"87c1216844c4f00d","method":"POST","path":"/logout","client_ip":"192.0.2.1:1234","endpoint":"/auth/logout","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"rest/auth_handler.go:413","message":"Business event","request_id":"70e72e030635fc3d462b17515d4f970a","trace_id":"70e72e030635fc3d462b17515d4f970a","span_id":"87c1216844c4f00d","event_type":"user_logout","user_id":"user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","duration_ms":11}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"70e72e030635fc3d462b17515d4f970a","trace_id":"70e72e030635fc3d462b17515d4f970a","span_id":"87c1216844c4f00d","method":"POST","path":"/logout","client_ip":"192.0.2.1:1234","request_id":"70e72e030635fc3d462b17515d4f970a","trace_id":"70e72e030635fc3d462b17515d4f970a","span_id":"87c1216844c4f00d","parent_span_id":"","method":"POST","path":"/logout","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.011117375}
--- PASS: TestAuthHandler_Logout_Success (0.01s)
=== RUN   TestAuthHandler_Login_InvalidJSON
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"deba411ce938faa82261e3d954c037aa","trace_id":"deba411ce938faa82261e3d954c037aa","span_id":"5fbb154b7b55ded4","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"deba411ce938faa82261e3d954c037aa","trace_id":"deba411ce938faa82261e3d954c037aa","span_id":"5fbb154b7b55ded4","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"rest/auth_handler.go:95","message":"Login attempt started","request_id":"deba411ce938faa82261e3d954c037aa","trace_id":"deba411ce938faa82261e3d954c037aa","span_id":"5fbb154b7b55ded4","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","endpoint":"/auth/login","method":"POST"}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.014+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"deba411ce938faa82261e3d954c037aa","trace_id":"deba411ce938faa82261e3d954c037aa","span_id":"5fbb154b7b55ded4","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"deba411ce938faa82261e3d954c037aa","trace_id":"deba411ce938faa82261e3d954c037aa","span_id":"5fbb154b7b55ded4","user_id":"","tenant_id":"","auth_method":"password","reason":"validation_error","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:102\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:421\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.014+0530","caller":"rest/auth_handler.go:103","message":"Login validation failed","request_id":"deba411ce938faa82261e3d954c037aa","trace_id":"deba411ce938faa82261e3d954c037aa","span_id":"5fbb154b7b55ded4","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","error":"unexpected EOF","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Login\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:103\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:421\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"deba411ce938faa82261e3d954c037aa","trace_id":"deba411ce938faa82261e3d954c037aa","span_id":"5fbb154b7b55ded4","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","request_id":"deba411ce938faa82261e3d954c037aa","trace_id":"deba411ce938faa82261e3d954c037aa","span_id":"5fbb154b7b55ded4","parent_span_id":"","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000079667}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.014+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"deba411ce938faa82261e3d954c037aa","trace_id":"deba411ce938faa82261e3d954c037aa","span_id":"5fbb154b7b55ded4","method":"POST","path":"/login","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":82,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Login_InvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Login_InvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:421\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_Login_InvalidJSON (0.00s)
=== RUN   TestAuthHandler_Register_EmptyPassword
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"06560054ed5d2cfc15646721e364c488","trace_id":"06560054ed5d2cfc15646721e364c488","span_id":"486101f22b51a6a5","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"06560054ed5d2cfc15646721e364c488","trace_id":"06560054ed5d2cfc15646721e364c488","span_id":"486101f22b51a6a5","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"rest/auth_handler.go:235","message":"Registration attempt started","request_id":"06560054ed5d2cfc15646721e364c488","trace_id":"06560054ed5d2cfc15646721e364c488","span_id":"486101f22b51a6a5","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","endpoint":"/auth/register","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.014+0530","caller":"rest/auth_handler.go:242","message":"Registration validation failed","request_id":"06560054ed5d2cfc15646721e364c488","trace_id":"06560054ed5d2cfc15646721e364c488","span_id":"486101f22b51a6a5","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","error":"Key: 'RegisterRequest.Password' Error:Field validation for 'Password' failed on the 'required' tag","stacktrace":"auth-service/internal/handler/rest.(*AuthHandler).Register\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler.go:242\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestAuthHandler_Register_EmptyPassword.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Register_EmptyPassword\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:460\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"06560054ed5d2cfc15646721e364c488","trace_id":"06560054ed5d2cfc15646721e364c488","span_id":"486101f22b51a6a5","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","request_id":"06560054ed5d2cfc15646721e364c488","trace_id":"06560054ed5d2cfc15646721e364c488","span_id":"486101f22b51a6a5","parent_span_id":"","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.00008175}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.014+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"06560054ed5d2cfc15646721e364c488","trace_id":"06560054ed5d2cfc15646721e364c488","span_id":"486101f22b51a6a5","method":"POST","path":"/register","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":105,"stacktrace":"auth-service/internal/handler/rest.TestAuthHandler_Register_EmptyPassword.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestAuthHandler_Register_EmptyPassword\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/auth_handler_test.go:460\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestAuthHandler_Register_EmptyPassword (0.00s)
=== RUN   TestAuthHandler_NewAuthHandler
--- PASS: TestAuthHandler_NewAuthHandler (0.00s)
=== RUN   TestOAuthHandler_GoogleLogin_Success
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"cd98e745b9f3c74878e4fda38a140595","trace_id":"cd98e745b9f3c74878e4fda38a140595","span_id":"4f932eae7fe198e7","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"cd98e745b9f3c74878e4fda38a140595","trace_id":"cd98e745b9f3c74878e4fda38a140595","span_id":"4f932eae7fe198e7","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"rest/oauth_handler.go:65","message":"Google OAuth login initiated","request_id":"cd98e745b9f3c74878e4fda38a140595","trace_id":"cd98e745b9f3c74878e4fda38a140595","span_id":"4f932eae7fe198e7","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/login","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"rest/oauth_handler.go:84","message":"Google OAuth login validation passed","request_id":"cd98e745b9f3c74878e4fda38a140595","trace_id":"cd98e745b9f3c74878e4fda38a140595","span_id":"4f932eae7fe198e7","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","tenant_id":"tenant-123","redirect_uri":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"cd98e745b9f3c74878e4fda38a140595","trace_id":"cd98e745b9f3c74878e4fda38a140595","span_id":"4f932eae7fe198e7","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"cd98e745b9f3c74878e4fda38a140595","trace_id":"cd98e745b9f3c74878e4fda38a140595","span_id":"4f932eae7fe198e7","provider":"google","step":"login_initiated","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"rest/oauth_handler.go:101","message":"Business event","request_id":"cd98e745b9f3c74878e4fda38a140595","trace_id":"cd98e745b9f3c74878e4fda38a140595","span_id":"4f932eae7fe198e7","event_type":"oauth_login_initiated","user_id":"","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","redirect_uri":"http://localhost:8080/api/v1/oauth/google/callback","duration_ms":0,"provider":"google"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"cd98e745b9f3c74878e4fda38a140595","trace_id":"cd98e745b9f3c74878e4fda38a140595","span_id":"4f932eae7fe198e7","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"cd98e745b9f3c74878e4fda38a140595","trace_id":"cd98e745b9f3c74878e4fda38a140595","span_id":"4f932eae7fe198e7","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.000047875}
--- PASS: TestOAuthHandler_GoogleLogin_Success (0.00s)
=== RUN   TestOAuthHandler_GoogleLogin_WithCustomRedirectURI
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"f9405060a80a0da3fc88d3fc99db11fe","trace_id":"f9405060a80a0da3fc88d3fc99db11fe","span_id":"6dddc415bec64d26","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"f9405060a80a0da3fc88d3fc99db11fe","trace_id":"f9405060a80a0da3fc88d3fc99db11fe","span_id":"6dddc415bec64d26","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"rest/oauth_handler.go:65","message":"Google OAuth login initiated","request_id":"f9405060a80a0da3fc88d3fc99db11fe","trace_id":"f9405060a80a0da3fc88d3fc99db11fe","span_id":"6dddc415bec64d26","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/login","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"rest/oauth_handler.go:84","message":"Google OAuth login validation passed","request_id":"f9405060a80a0da3fc88d3fc99db11fe","trace_id":"f9405060a80a0da3fc88d3fc99db11fe","span_id":"6dddc415bec64d26","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","tenant_id":"tenant-123","redirect_uri":"https://custom.example.com/callback"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"f9405060a80a0da3fc88d3fc99db11fe","trace_id":"f9405060a80a0da3fc88d3fc99db11fe","span_id":"6dddc415bec64d26","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"f9405060a80a0da3fc88d3fc99db11fe","trace_id":"f9405060a80a0da3fc88d3fc99db11fe","span_id":"6dddc415bec64d26","provider":"google","step":"login_initiated","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"rest/oauth_handler.go:101","message":"Business event","request_id":"f9405060a80a0da3fc88d3fc99db11fe","trace_id":"f9405060a80a0da3fc88d3fc99db11fe","span_id":"6dddc415bec64d26","event_type":"oauth_login_initiated","user_id":"","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","redirect_uri":"https://custom.example.com/callback","duration_ms":0,"provider":"google"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"f9405060a80a0da3fc88d3fc99db11fe","trace_id":"f9405060a80a0da3fc88d3fc99db11fe","span_id":"6dddc415bec64d26","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"f9405060a80a0da3fc88d3fc99db11fe","trace_id":"f9405060a80a0da3fc88d3fc99db11fe","span_id":"6dddc415bec64d26","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.000047917}
--- PASS: TestOAuthHandler_GoogleLogin_WithCustomRedirectURI (0.00s)
=== RUN   TestOAuthHandler_GoogleLogin_MissingTenantID
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"57d8a121130774cea1a55bf004b2fc6d","trace_id":"57d8a121130774cea1a55bf004b2fc6d","span_id":"df3d3d4b1814a97d","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"57d8a121130774cea1a55bf004b2fc6d","trace_id":"57d8a121130774cea1a55bf004b2fc6d","span_id":"df3d3d4b1814a97d","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"rest/oauth_handler.go:65","message":"Google OAuth login initiated","request_id":"57d8a121130774cea1a55bf004b2fc6d","trace_id":"57d8a121130774cea1a55bf004b2fc6d","span_id":"df3d3d4b1814a97d","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/login","method":"GET"}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.014+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"57d8a121130774cea1a55bf004b2fc6d","trace_id":"57d8a121130774cea1a55bf004b2fc6d","span_id":"df3d3d4b1814a97d","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"57d8a121130774cea1a55bf004b2fc6d","trace_id":"57d8a121130774cea1a55bf004b2fc6d","span_id":"df3d3d4b1814a97d","user_id":"","tenant_id":"","auth_method":"google_oauth","reason":"missing_tenant_id","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).GoogleLogin\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:74\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleLogin_MissingTenantID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleLogin_MissingTenantID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:115\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.014+0530","caller":"rest/oauth_handler.go:75","message":"Google OAuth login failed - missing tenant ID","request_id":"57d8a121130774cea1a55bf004b2fc6d","trace_id":"57d8a121130774cea1a55bf004b2fc6d","span_id":"df3d3d4b1814a97d","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).GoogleLogin\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:75\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleLogin_MissingTenantID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleLogin_MissingTenantID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:115\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"57d8a121130774cea1a55bf004b2fc6d","trace_id":"57d8a121130774cea1a55bf004b2fc6d","span_id":"df3d3d4b1814a97d","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"57d8a121130774cea1a55bf004b2fc6d","trace_id":"57d8a121130774cea1a55bf004b2fc6d","span_id":"df3d3d4b1814a97d","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000048458}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.014+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"57d8a121130774cea1a55bf004b2fc6d","trace_id":"57d8a121130774cea1a55bf004b2fc6d","span_id":"df3d3d4b1814a97d","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_GoogleLogin_MissingTenantID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleLogin_MissingTenantID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:115\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_GoogleLogin_MissingTenantID (0.00s)
=== RUN   TestOAuthHandler_GoogleCallback_Success
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"a25499754e9290274f7a81e7b3a47084","trace_id":"a25499754e9290274f7a81e7b3a47084","span_id":"3048f3218f25a4ed","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"a25499754e9290274f7a81e7b3a47084","trace_id":"a25499754e9290274f7a81e7b3a47084","span_id":"3048f3218f25a4ed","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"a25499754e9290274f7a81e7b3a47084","trace_id":"a25499754e9290274f7a81e7b3a47084","span_id":"3048f3218f25a4ed","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.014+0530","caller":"rest/oauth_handler.go:174","message":"Google OAuth callback validation passed","request_id":"a25499754e9290274f7a81e7b3a47084","trace_id":"a25499754e9290274f7a81e7b3a47084","span_id":"3048f3218f25a4ed","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","tenant_id":"tenant-123","code_prefix":"test-auth-..."}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.065+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"a25499754e9290274f7a81e7b3a47084","trace_id":"a25499754e9290274f7a81e7b3a47084","span_id":"3048f3218f25a4ed","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"a25499754e9290274f7a81e7b3a47084","trace_id":"a25499754e9290274f7a81e7b3a47084","span_id":"3048f3218f25a4ed","user_id":"google-user-123","tenant_id":"tenant-123","auth_method":"google_oauth","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.065+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"a25499754e9290274f7a81e7b3a47084","trace_id":"a25499754e9290274f7a81e7b3a47084","span_id":"3048f3218f25a4ed","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"a25499754e9290274f7a81e7b3a47084","trace_id":"a25499754e9290274f7a81e7b3a47084","span_id":"3048f3218f25a4ed","provider":"google","step":"callback_success","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.065+0530","caller":"rest/oauth_handler.go:209","message":"Business event","request_id":"a25499754e9290274f7a81e7b3a47084","trace_id":"a25499754e9290274f7a81e7b3a47084","span_id":"3048f3218f25a4ed","event_type":"oauth_login_completed","user_id":"google-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","provider":"google","duration_ms":51}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.065+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"a25499754e9290274f7a81e7b3a47084","trace_id":"a25499754e9290274f7a81e7b3a47084","span_id":"3048f3218f25a4ed","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"a25499754e9290274f7a81e7b3a47084","trace_id":"a25499754e9290274f7a81e7b3a47084","span_id":"3048f3218f25a4ed","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.051140583}
--- PASS: TestOAuthHandler_GoogleCallback_Success (0.05s)
=== RUN   TestOAuthHandler_GoogleCallback_MissingCode
{"level":"INFO","timestamp":"2025-06-26T01:18:54.066+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"5b64b4855e13499b0229058323798bb3","trace_id":"5b64b4855e13499b0229058323798bb3","span_id":"b7cce71f7cf18025","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"5b64b4855e13499b0229058323798bb3","trace_id":"5b64b4855e13499b0229058323798bb3","span_id":"b7cce71f7cf18025","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.066+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"5b64b4855e13499b0229058323798bb3","trace_id":"5b64b4855e13499b0229058323798bb3","span_id":"b7cce71f7cf18025","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.066+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"5b64b4855e13499b0229058323798bb3","trace_id":"5b64b4855e13499b0229058323798bb3","span_id":"b7cce71f7cf18025","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"5b64b4855e13499b0229058323798bb3","trace_id":"5b64b4855e13499b0229058323798bb3","span_id":"b7cce71f7cf18025","user_id":"","tenant_id":"tenant-123","auth_method":"google_oauth","reason":"missing_code","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).GoogleCallback\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:164\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_MissingCode.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_MissingCode\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:171\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.066+0530","caller":"rest/oauth_handler.go:165","message":"Google OAuth callback failed - missing authorization code","request_id":"5b64b4855e13499b0229058323798bb3","trace_id":"5b64b4855e13499b0229058323798bb3","span_id":"b7cce71f7cf18025","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).GoogleCallback\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:165\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_MissingCode.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_MissingCode\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:171\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.066+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"5b64b4855e13499b0229058323798bb3","trace_id":"5b64b4855e13499b0229058323798bb3","span_id":"b7cce71f7cf18025","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"5b64b4855e13499b0229058323798bb3","trace_id":"5b64b4855e13499b0229058323798bb3","span_id":"b7cce71f7cf18025","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000074375}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.066+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"5b64b4855e13499b0229058323798bb3","trace_id":"5b64b4855e13499b0229058323798bb3","span_id":"b7cce71f7cf18025","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_MissingCode.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_MissingCode\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:171\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_GoogleCallback_MissingCode (0.00s)
=== RUN   TestOAuthHandler_GoogleCallback_OAuthError
{"level":"INFO","timestamp":"2025-06-26T01:18:54.066+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"01c26efcd9f52c990f7aa1699c02e34d","trace_id":"01c26efcd9f52c990f7aa1699c02e34d","span_id":"cf07f2217f668618","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"01c26efcd9f52c990f7aa1699c02e34d","trace_id":"01c26efcd9f52c990f7aa1699c02e34d","span_id":"cf07f2217f668618","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.066+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"01c26efcd9f52c990f7aa1699c02e34d","trace_id":"01c26efcd9f52c990f7aa1699c02e34d","span_id":"cf07f2217f668618","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.066+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"01c26efcd9f52c990f7aa1699c02e34d","trace_id":"01c26efcd9f52c990f7aa1699c02e34d","span_id":"cf07f2217f668618","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"01c26efcd9f52c990f7aa1699c02e34d","trace_id":"01c26efcd9f52c990f7aa1699c02e34d","span_id":"cf07f2217f668618","user_id":"","tenant_id":"tenant-123","auth_method":"google_oauth","reason":"oauth_error","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).GoogleCallback\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:153\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_OAuthError.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_OAuthError\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:197\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.066+0530","caller":"logger/logger.go:225","message":"OAuth flow failed","request_id":"01c26efcd9f52c990f7aa1699c02e34d","trace_id":"01c26efcd9f52c990f7aa1699c02e34d","span_id":"cf07f2217f668618","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"01c26efcd9f52c990f7aa1699c02e34d","trace_id":"01c26efcd9f52c990f7aa1699c02e34d","span_id":"cf07f2217f668618","provider":"google","step":"callback_error","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","error":"oauth error: access_denied","stacktrace":"auth-service/internal/logger.(*RequestLogger).OAuthFlow\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:225\nauth-service/internal/handler/rest.(*OAuthHandler).GoogleCallback\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:154\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_OAuthError.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_OAuthError\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:197\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.066+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"01c26efcd9f52c990f7aa1699c02e34d","trace_id":"01c26efcd9f52c990f7aa1699c02e34d","span_id":"cf07f2217f668618","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"01c26efcd9f52c990f7aa1699c02e34d","trace_id":"01c26efcd9f52c990f7aa1699c02e34d","span_id":"cf07f2217f668618","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000064708}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.066+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"01c26efcd9f52c990f7aa1699c02e34d","trace_id":"01c26efcd9f52c990f7aa1699c02e34d","span_id":"cf07f2217f668618","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_OAuthError.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_OAuthError\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:197\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_GoogleCallback_OAuthError (0.00s)
=== RUN   TestOAuthHandler_ClientCredentials_Success
{"level":"INFO","timestamp":"2025-06-26T01:18:54.066+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"2824b3d07bcafb5beac3c2b2f0f4b3ce","trace_id":"2824b3d07bcafb5beac3c2b2f0f4b3ce","span_id":"ea540e6788d9102a","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"2824b3d07bcafb5beac3c2b2f0f4b3ce","trace_id":"2824b3d07bcafb5beac3c2b2f0f4b3ce","span_id":"ea540e6788d9102a","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.066+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"2824b3d07bcafb5beac3c2b2f0f4b3ce","trace_id":"2824b3d07bcafb5beac3c2b2f0f4b3ce","span_id":"ea540e6788d9102a","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.066+0530","caller":"rest/oauth_handler.go:277","message":"Client credentials validation passed","request_id":"2824b3d07bcafb5beac3c2b2f0f4b3ce","trace_id":"2824b3d07bcafb5beac3c2b2f0f4b3ce","span_id":"ea540e6788d9102a","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","client_id":"service-client-123","grant_type":"client_credentials","scope":"read:users write:users"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.087+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"2824b3d07bcafb5beac3c2b2f0f4b3ce","trace_id":"2824b3d07bcafb5beac3c2b2f0f4b3ce","span_id":"ea540e6788d9102a","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"2824b3d07bcafb5beac3c2b2f0f4b3ce","trace_id":"2824b3d07bcafb5beac3c2b2f0f4b3ce","span_id":"ea540e6788d9102a","user_id":"service-client-123","tenant_id":"","auth_method":"client_credentials","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.087+0530","caller":"rest/oauth_handler.go:310","message":"Business event","request_id":"2824b3d07bcafb5beac3c2b2f0f4b3ce","trace_id":"2824b3d07bcafb5beac3c2b2f0f4b3ce","span_id":"ea540e6788d9102a","event_type":"client_credentials_success","user_id":"service-client-123","tenant_id":"","client_ip":"192.0.2.1:1234","duration_ms":21,"scope":"read:users write:users"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.087+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"2824b3d07bcafb5beac3c2b2f0f4b3ce","trace_id":"2824b3d07bcafb5beac3c2b2f0f4b3ce","span_id":"ea540e6788d9102a","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"2824b3d07bcafb5beac3c2b2f0f4b3ce","trace_id":"2824b3d07bcafb5beac3c2b2f0f4b3ce","span_id":"ea540e6788d9102a","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.02120975}
--- PASS: TestOAuthHandler_ClientCredentials_Success (0.02s)
=== RUN   TestOAuthHandler_ClientCredentials_UnsupportedGrantType
{"level":"INFO","timestamp":"2025-06-26T01:18:54.087+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"8e535212a4a6b3e87ee3b7290aac66db","trace_id":"8e535212a4a6b3e87ee3b7290aac66db","span_id":"35f6ab7655de83e2","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"8e535212a4a6b3e87ee3b7290aac66db","trace_id":"8e535212a4a6b3e87ee3b7290aac66db","span_id":"35f6ab7655de83e2","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.087+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"8e535212a4a6b3e87ee3b7290aac66db","trace_id":"8e535212a4a6b3e87ee3b7290aac66db","span_id":"35f6ab7655de83e2","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.087+0530","caller":"rest/oauth_handler.go:277","message":"Client credentials validation passed","request_id":"8e535212a4a6b3e87ee3b7290aac66db","trace_id":"8e535212a4a6b3e87ee3b7290aac66db","span_id":"35f6ab7655de83e2","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","client_id":"service-client-123","grant_type":"authorization_code","scope":"read:users write:users"}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.087+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"8e535212a4a6b3e87ee3b7290aac66db","trace_id":"8e535212a4a6b3e87ee3b7290aac66db","span_id":"35f6ab7655de83e2","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"8e535212a4a6b3e87ee3b7290aac66db","trace_id":"8e535212a4a6b3e87ee3b7290aac66db","span_id":"35f6ab7655de83e2","user_id":"service-client-123","tenant_id":"","auth_method":"client_credentials","reason":"unsupported_grant_type","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).ClientCredentials\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:284\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_UnsupportedGrantType.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_UnsupportedGrantType\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:273\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.087+0530","caller":"rest/oauth_handler.go:285","message":"Unsupported grant type","request_id":"8e535212a4a6b3e87ee3b7290aac66db","trace_id":"8e535212a4a6b3e87ee3b7290aac66db","span_id":"35f6ab7655de83e2","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","grant_type":"authorization_code","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).ClientCredentials\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:285\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_UnsupportedGrantType.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_UnsupportedGrantType\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:273\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.087+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"8e535212a4a6b3e87ee3b7290aac66db","trace_id":"8e535212a4a6b3e87ee3b7290aac66db","span_id":"35f6ab7655de83e2","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"8e535212a4a6b3e87ee3b7290aac66db","trace_id":"8e535212a4a6b3e87ee3b7290aac66db","span_id":"35f6ab7655de83e2","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000088334}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.087+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"8e535212a4a6b3e87ee3b7290aac66db","trace_id":"8e535212a4a6b3e87ee3b7290aac66db","span_id":"35f6ab7655de83e2","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":138,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_UnsupportedGrantType.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_UnsupportedGrantType\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:273\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_ClientCredentials_UnsupportedGrantType (0.00s)
=== RUN   TestOAuthHandler_ClientCredentials_InvalidJSON
{"level":"INFO","timestamp":"2025-06-26T01:18:54.087+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"f2db545d2f25fde96b374a08700dab42","trace_id":"f2db545d2f25fde96b374a08700dab42","span_id":"8cccc14ac9fdbe8c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"f2db545d2f25fde96b374a08700dab42","trace_id":"f2db545d2f25fde96b374a08700dab42","span_id":"8cccc14ac9fdbe8c","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.087+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"f2db545d2f25fde96b374a08700dab42","trace_id":"f2db545d2f25fde96b374a08700dab42","span_id":"8cccc14ac9fdbe8c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.087+0530","caller":"rest/oauth_handler.go:268","message":"Client credentials validation failed","request_id":"f2db545d2f25fde96b374a08700dab42","trace_id":"f2db545d2f25fde96b374a08700dab42","span_id":"8cccc14ac9fdbe8c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","error":"unexpected EOF","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).ClientCredentials\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:268\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_InvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_InvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:303\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.087+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"f2db545d2f25fde96b374a08700dab42","trace_id":"f2db545d2f25fde96b374a08700dab42","span_id":"8cccc14ac9fdbe8c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"f2db545d2f25fde96b374a08700dab42","trace_id":"f2db545d2f25fde96b374a08700dab42","span_id":"8cccc14ac9fdbe8c","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000057709}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.087+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"f2db545d2f25fde96b374a08700dab42","trace_id":"f2db545d2f25fde96b374a08700dab42","span_id":"8cccc14ac9fdbe8c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":70,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_InvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_ClientCredentials_InvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:303\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_ClientCredentials_InvalidJSON (0.00s)
=== RUN   TestOAuthHandler_CreateOneTimeToken_Success
{"level":"INFO","timestamp":"2025-06-26T01:18:54.087+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"0ac1f6cbd6d1495a1ebb266e69879402","trace_id":"0ac1f6cbd6d1495a1ebb266e69879402","span_id":"1b52c73844e9fce5","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"0ac1f6cbd6d1495a1ebb266e69879402","trace_id":"0ac1f6cbd6d1495a1ebb266e69879402","span_id":"1b52c73844e9fce5","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.087+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"0ac1f6cbd6d1495a1ebb266e69879402","trace_id":"0ac1f6cbd6d1495a1ebb266e69879402","span_id":"1b52c73844e9fce5","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.088+0530","caller":"rest/oauth_handler.go:380","message":"One-time token validation passed","request_id":"0ac1f6cbd6d1495a1ebb266e69879402","trace_id":"0ac1f6cbd6d1495a1ebb266e69879402","span_id":"1b52c73844e9fce5","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","url":"https://app.example.com/survey/123","session_id":"survey-session-456","expires_in":3600,"max_uses":1}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.104+0530","caller":"rest/oauth_handler.go:421","message":"Business event","request_id":"0ac1f6cbd6d1495a1ebb266e69879402","trace_id":"0ac1f6cbd6d1495a1ebb266e69879402","span_id":"1b52c73844e9fce5","event_type":"one_time_token_created","user_id":"","tenant_id":"","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","expires_in":3600,"max_uses":1,"duration_ms":16}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.104+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"0ac1f6cbd6d1495a1ebb266e69879402","trace_id":"0ac1f6cbd6d1495a1ebb266e69879402","span_id":"1b52c73844e9fce5","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"0ac1f6cbd6d1495a1ebb266e69879402","trace_id":"0ac1f6cbd6d1495a1ebb266e69879402","span_id":"1b52c73844e9fce5","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":201,"duration":0.01621125}
--- PASS: TestOAuthHandler_CreateOneTimeToken_Success (0.02s)
=== RUN   TestOAuthHandler_CreateOneTimeToken_MissingURL
{"level":"INFO","timestamp":"2025-06-26T01:18:54.104+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"d06df689353ab0d7b2eae2e4867d12d9","trace_id":"d06df689353ab0d7b2eae2e4867d12d9","span_id":"4ed05808118a1b8f","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"d06df689353ab0d7b2eae2e4867d12d9","trace_id":"d06df689353ab0d7b2eae2e4867d12d9","span_id":"4ed05808118a1b8f","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.104+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"d06df689353ab0d7b2eae2e4867d12d9","trace_id":"d06df689353ab0d7b2eae2e4867d12d9","span_id":"4ed05808118a1b8f","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.104+0530","caller":"rest/oauth_handler.go:371","message":"One-time token validation failed","request_id":"d06df689353ab0d7b2eae2e4867d12d9","trace_id":"d06df689353ab0d7b2eae2e4867d12d9","span_id":"4ed05808118a1b8f","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","error":"Key: 'OneTimeTokenRequest.URL' Error:Field validation for 'URL' failed on the 'required' tag","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).CreateOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:371\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_MissingURL.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_MissingURL\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:385\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.104+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"d06df689353ab0d7b2eae2e4867d12d9","trace_id":"d06df689353ab0d7b2eae2e4867d12d9","span_id":"4ed05808118a1b8f","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"d06df689353ab0d7b2eae2e4867d12d9","trace_id":"d06df689353ab0d7b2eae2e4867d12d9","span_id":"4ed05808118a1b8f","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000088875}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.104+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"d06df689353ab0d7b2eae2e4867d12d9","trace_id":"d06df689353ab0d7b2eae2e4867d12d9","span_id":"4ed05808118a1b8f","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":87,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_MissingURL.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_MissingURL\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:385\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_CreateOneTimeToken_MissingURL (0.00s)
=== RUN   TestOAuthHandler_VerifyOneTimeToken_Success
{"level":"INFO","timestamp":"2025-06-26T01:18:54.104+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"8f0490a3bd6f04fb76dec52d3a35e638","trace_id":"8f0490a3bd6f04fb76dec52d3a35e638","span_id":"a49e15a18dab5680","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"8f0490a3bd6f04fb76dec52d3a35e638","trace_id":"8f0490a3bd6f04fb76dec52d3a35e638","span_id":"a49e15a18dab5680","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.104+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"8f0490a3bd6f04fb76dec52d3a35e638","trace_id":"8f0490a3bd6f04fb76dec52d3a35e638","span_id":"a49e15a18dab5680","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.104+0530","caller":"rest/oauth_handler.go:488","message":"One-time token verification validation passed","request_id":"8f0490a3bd6f04fb76dec52d3a35e638","trace_id":"8f0490a3bd6f04fb76dec52d3a35e638","span_id":"a49e15a18dab5680","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","token_prefix":"one-time-t...","session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.115+0530","caller":"rest/oauth_handler.go:542","message":"Business event","request_id":"8f0490a3bd6f04fb76dec52d3a35e638","trace_id":"8f0490a3bd6f04fb76dec52d3a35e638","span_id":"a49e15a18dab5680","event_type":"one_time_token_verified","user_id":"anonymous-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","is_valid":true,"duration_ms":11}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.115+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"8f0490a3bd6f04fb76dec52d3a35e638","trace_id":"8f0490a3bd6f04fb76dec52d3a35e638","span_id":"a49e15a18dab5680","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"8f0490a3bd6f04fb76dec52d3a35e638","trace_id":"8f0490a3bd6f04fb76dec52d3a35e638","span_id":"a49e15a18dab5680","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.011149667}
--- PASS: TestOAuthHandler_VerifyOneTimeToken_Success (0.01s)
=== RUN   TestOAuthHandler_VerifyOneTimeToken_MissingToken
{"level":"INFO","timestamp":"2025-06-26T01:18:54.115+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"8a4a5810afc33e19eb13f893f70a8fc4","trace_id":"8a4a5810afc33e19eb13f893f70a8fc4","span_id":"84db1e3e41c0b0e0","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"8a4a5810afc33e19eb13f893f70a8fc4","trace_id":"8a4a5810afc33e19eb13f893f70a8fc4","span_id":"84db1e3e41c0b0e0","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.115+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"8a4a5810afc33e19eb13f893f70a8fc4","trace_id":"8a4a5810afc33e19eb13f893f70a8fc4","span_id":"84db1e3e41c0b0e0","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.115+0530","caller":"rest/oauth_handler.go:469","message":"One-time token verification failed - missing token","request_id":"8a4a5810afc33e19eb13f893f70a8fc4","trace_id":"8a4a5810afc33e19eb13f893f70a8fc4","span_id":"84db1e3e41c0b0e0","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).VerifyOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:469\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_MissingToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_MissingToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:440\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.115+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"8a4a5810afc33e19eb13f893f70a8fc4","trace_id":"8a4a5810afc33e19eb13f893f70a8fc4","span_id":"84db1e3e41c0b0e0","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"8a4a5810afc33e19eb13f893f70a8fc4","trace_id":"8a4a5810afc33e19eb13f893f70a8fc4","span_id":"84db1e3e41c0b0e0","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000048584}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.115+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"8a4a5810afc33e19eb13f893f70a8fc4","trace_id":"8a4a5810afc33e19eb13f893f70a8fc4","span_id":"84db1e3e41c0b0e0","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_MissingToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_MissingToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:440\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_VerifyOneTimeToken_MissingToken (0.00s)
=== RUN   TestOAuthHandler_VerifyOneTimeToken_InvalidToken
{"level":"INFO","timestamp":"2025-06-26T01:18:54.115+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"e49a3e336d35e1044dab70a390553c93","trace_id":"e49a3e336d35e1044dab70a390553c93","span_id":"fd0b7f1805d60066","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"e49a3e336d35e1044dab70a390553c93","trace_id":"e49a3e336d35e1044dab70a390553c93","span_id":"fd0b7f1805d60066","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.115+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"e49a3e336d35e1044dab70a390553c93","trace_id":"e49a3e336d35e1044dab70a390553c93","span_id":"fd0b7f1805d60066","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.115+0530","caller":"rest/oauth_handler.go:488","message":"One-time token verification validation passed","request_id":"e49a3e336d35e1044dab70a390553c93","trace_id":"e49a3e336d35e1044dab70a390553c93","span_id":"fd0b7f1805d60066","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","token_prefix":"invalid-to...","session_id":"session-123"}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.126+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"e49a3e336d35e1044dab70a390553c93","trace_id":"e49a3e336d35e1044dab70a390553c93","span_id":"fd0b7f1805d60066","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"e49a3e336d35e1044dab70a390553c93","trace_id":"e49a3e336d35e1044dab70a390553c93","span_id":"fd0b7f1805d60066","user_id":"","tenant_id":"","auth_method":"one_time_token","reason":"invalid_token","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).VerifyOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:513\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_InvalidToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_InvalidToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:466\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.126+0530","caller":"rest/oauth_handler.go:514","message":"One-time token verification failed - invalid token or session","request_id":"e49a3e336d35e1044dab70a390553c93","trace_id":"e49a3e336d35e1044dab70a390553c93","span_id":"fd0b7f1805d60066","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).VerifyOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:514\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_InvalidToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_InvalidToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:466\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.126+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"e49a3e336d35e1044dab70a390553c93","trace_id":"e49a3e336d35e1044dab70a390553c93","span_id":"fd0b7f1805d60066","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"e49a3e336d35e1044dab70a390553c93","trace_id":"e49a3e336d35e1044dab70a390553c93","span_id":"fd0b7f1805d60066","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":401,"duration":0.01113875}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.127+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"e49a3e336d35e1044dab70a390553c93","trace_id":"e49a3e336d35e1044dab70a390553c93","span_id":"fd0b7f1805d60066","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_InvalidToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_InvalidToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:466\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_VerifyOneTimeToken_InvalidToken (0.01s)
=== RUN   TestOAuthHandler_RefreshSession_Success
{"level":"INFO","timestamp":"2025-06-26T01:18:54.127+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"e7fa286a6a6fb7be5f52a1942dd5e077","trace_id":"e7fa286a6a6fb7be5f52a1942dd5e077","span_id":"494205fd3bb72c02","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"e7fa286a6a6fb7be5f52a1942dd5e077","trace_id":"e7fa286a6a6fb7be5f52a1942dd5e077","span_id":"494205fd3bb72c02","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.127+0530","caller":"rest/oauth_handler.go:580","message":"Session refresh initiated","request_id":"e7fa286a6a6fb7be5f52a1942dd5e077","trace_id":"e7fa286a6a6fb7be5f52a1942dd5e077","span_id":"494205fd3bb72c02","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/oauth/refresh","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.127+0530","caller":"rest/oauth_handler.go:598","message":"Session refresh validation passed","request_id":"e7fa286a6a6fb7be5f52a1942dd5e077","trace_id":"e7fa286a6a6fb7be5f52a1942dd5e077","span_id":"494205fd3bb72c02","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","token_prefix":"one-time-t...","session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.136+0530","caller":"rest/oauth_handler.go:637","message":"Business event","request_id":"e7fa286a6a6fb7be5f52a1942dd5e077","trace_id":"e7fa286a6a6fb7be5f52a1942dd5e077","span_id":"494205fd3bb72c02","event_type":"session_refreshed","user_id":"anonymous-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","duration_ms":9}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.136+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"e7fa286a6a6fb7be5f52a1942dd5e077","trace_id":"e7fa286a6a6fb7be5f52a1942dd5e077","span_id":"494205fd3bb72c02","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"e7fa286a6a6fb7be5f52a1942dd5e077","trace_id":"e7fa286a6a6fb7be5f52a1942dd5e077","span_id":"494205fd3bb72c02","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.009223167}
--- PASS: TestOAuthHandler_RefreshSession_Success (0.01s)
=== RUN   TestOAuthHandler_RefreshSession_MissingSessionID
{"level":"INFO","timestamp":"2025-06-26T01:18:54.136+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"b8adb9b3f9a00f95314a85b75bbc1eb6","trace_id":"b8adb9b3f9a00f95314a85b75bbc1eb6","span_id":"ab661df453dc6cce","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"b8adb9b3f9a00f95314a85b75bbc1eb6","trace_id":"b8adb9b3f9a00f95314a85b75bbc1eb6","span_id":"ab661df453dc6cce","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.136+0530","caller":"rest/oauth_handler.go:580","message":"Session refresh initiated","request_id":"b8adb9b3f9a00f95314a85b75bbc1eb6","trace_id":"b8adb9b3f9a00f95314a85b75bbc1eb6","span_id":"ab661df453dc6cce","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/oauth/refresh","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.136+0530","caller":"rest/oauth_handler.go:589","message":"Session refresh failed - missing parameters","request_id":"b8adb9b3f9a00f95314a85b75bbc1eb6","trace_id":"b8adb9b3f9a00f95314a85b75bbc1eb6","span_id":"ab661df453dc6cce","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).RefreshSession\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:589\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_MissingSessionID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_MissingSessionID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:522\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.136+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"b8adb9b3f9a00f95314a85b75bbc1eb6","trace_id":"b8adb9b3f9a00f95314a85b75bbc1eb6","span_id":"ab661df453dc6cce","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"b8adb9b3f9a00f95314a85b75bbc1eb6","trace_id":"b8adb9b3f9a00f95314a85b75bbc1eb6","span_id":"ab661df453dc6cce","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000162375}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.137+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"b8adb9b3f9a00f95314a85b75bbc1eb6","trace_id":"b8adb9b3f9a00f95314a85b75bbc1eb6","span_id":"ab661df453dc6cce","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_MissingSessionID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_MissingSessionID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:522\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_RefreshSession_MissingSessionID (0.00s)
=== RUN   TestOAuthHandler_NewOAuthHandler
--- PASS: TestOAuthHandler_NewOAuthHandler (0.00s)
=== RUN   TestOAuthHandler_CreateOneTimeToken_WithAllFields
{"level":"INFO","timestamp":"2025-06-26T01:18:54.137+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"46d8d9ff7af8a486e48fdc34a4e28467","trace_id":"46d8d9ff7af8a486e48fdc34a4e28467","span_id":"fc6c7fa73508a158","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"46d8d9ff7af8a486e48fdc34a4e28467","trace_id":"46d8d9ff7af8a486e48fdc34a4e28467","span_id":"fc6c7fa73508a158","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.137+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"46d8d9ff7af8a486e48fdc34a4e28467","trace_id":"46d8d9ff7af8a486e48fdc34a4e28467","span_id":"fc6c7fa73508a158","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.137+0530","caller":"rest/oauth_handler.go:380","message":"One-time token validation passed","request_id":"46d8d9ff7af8a486e48fdc34a4e28467","trace_id":"46d8d9ff7af8a486e48fdc34a4e28467","span_id":"fc6c7fa73508a158","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","url":"https://app.example.com/survey/123","session_id":"survey-session-456","expires_in":7200,"max_uses":5}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.153+0530","caller":"rest/oauth_handler.go:421","message":"Business event","request_id":"46d8d9ff7af8a486e48fdc34a4e28467","trace_id":"46d8d9ff7af8a486e48fdc34a4e28467","span_id":"fc6c7fa73508a158","event_type":"one_time_token_created","user_id":"","tenant_id":"","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","expires_in":7200,"max_uses":5,"duration_ms":16}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.153+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"46d8d9ff7af8a486e48fdc34a4e28467","trace_id":"46d8d9ff7af8a486e48fdc34a4e28467","span_id":"fc6c7fa73508a158","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"46d8d9ff7af8a486e48fdc34a4e28467","trace_id":"46d8d9ff7af8a486e48fdc34a4e28467","span_id":"fc6c7fa73508a158","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":201,"duration":0.016370041}
--- PASS: TestOAuthHandler_CreateOneTimeToken_WithAllFields (0.02s)
=== RUN   TestOAuthHandler_CreateOneTimeToken_WithDefaultValues
{"level":"INFO","timestamp":"2025-06-26T01:18:54.153+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"60506b1395ed81ba30d72cf2d215631f","trace_id":"60506b1395ed81ba30d72cf2d215631f","span_id":"50d960738520e28b","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"60506b1395ed81ba30d72cf2d215631f","trace_id":"60506b1395ed81ba30d72cf2d215631f","span_id":"50d960738520e28b","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.153+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"60506b1395ed81ba30d72cf2d215631f","trace_id":"60506b1395ed81ba30d72cf2d215631f","span_id":"50d960738520e28b","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.153+0530","caller":"rest/oauth_handler.go:380","message":"One-time token validation passed","request_id":"60506b1395ed81ba30d72cf2d215631f","trace_id":"60506b1395ed81ba30d72cf2d215631f","span_id":"50d960738520e28b","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","url":"https://app.example.com/survey/123","session_id":"survey-session-456","expires_in":0,"max_uses":0}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.169+0530","caller":"rest/oauth_handler.go:421","message":"Business event","request_id":"60506b1395ed81ba30d72cf2d215631f","trace_id":"60506b1395ed81ba30d72cf2d215631f","span_id":"50d960738520e28b","event_type":"one_time_token_created","user_id":"","tenant_id":"","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","expires_in":0,"max_uses":0,"duration_ms":16}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.170+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"60506b1395ed81ba30d72cf2d215631f","trace_id":"60506b1395ed81ba30d72cf2d215631f","span_id":"50d960738520e28b","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"60506b1395ed81ba30d72cf2d215631f","trace_id":"60506b1395ed81ba30d72cf2d215631f","span_id":"50d960738520e28b","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":201,"duration":0.016174042}
--- PASS: TestOAuthHandler_CreateOneTimeToken_WithDefaultValues (0.02s)
=== RUN   TestOAuthHandler_CreateOneTimeToken_WithInvalidJSON
{"level":"INFO","timestamp":"2025-06-26T01:18:54.170+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"5df136cf3a5b366c5fb7999e3f9fdb09","trace_id":"5df136cf3a5b366c5fb7999e3f9fdb09","span_id":"e78e0ddd64dc7253","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"5df136cf3a5b366c5fb7999e3f9fdb09","trace_id":"5df136cf3a5b366c5fb7999e3f9fdb09","span_id":"e78e0ddd64dc7253","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.170+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"5df136cf3a5b366c5fb7999e3f9fdb09","trace_id":"5df136cf3a5b366c5fb7999e3f9fdb09","span_id":"e78e0ddd64dc7253","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.170+0530","caller":"rest/oauth_handler.go:371","message":"One-time token validation failed","request_id":"5df136cf3a5b366c5fb7999e3f9fdb09","trace_id":"5df136cf3a5b366c5fb7999e3f9fdb09","span_id":"e78e0ddd64dc7253","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","error":"unexpected EOF","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).CreateOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:371\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithInvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithInvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:638\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.170+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"5df136cf3a5b366c5fb7999e3f9fdb09","trace_id":"5df136cf3a5b366c5fb7999e3f9fdb09","span_id":"e78e0ddd64dc7253","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"5df136cf3a5b366c5fb7999e3f9fdb09","trace_id":"5df136cf3a5b366c5fb7999e3f9fdb09","span_id":"e78e0ddd64dc7253","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000088708}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.170+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"5df136cf3a5b366c5fb7999e3f9fdb09","trace_id":"5df136cf3a5b366c5fb7999e3f9fdb09","span_id":"e78e0ddd64dc7253","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":44,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithInvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithInvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:638\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_CreateOneTimeToken_WithInvalidJSON (0.00s)
=== RUN   TestOAuthHandler_CreateOneTimeToken_WithEmptyBody
{"level":"INFO","timestamp":"2025-06-26T01:18:54.170+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"566a308468780ef808293001ed6b4810","trace_id":"566a308468780ef808293001ed6b4810","span_id":"87f1f184810c7d07","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"566a308468780ef808293001ed6b4810","trace_id":"566a308468780ef808293001ed6b4810","span_id":"87f1f184810c7d07","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.170+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"566a308468780ef808293001ed6b4810","trace_id":"566a308468780ef808293001ed6b4810","span_id":"87f1f184810c7d07","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.170+0530","caller":"rest/oauth_handler.go:371","message":"One-time token validation failed","request_id":"566a308468780ef808293001ed6b4810","trace_id":"566a308468780ef808293001ed6b4810","span_id":"87f1f184810c7d07","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","error":"EOF","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).CreateOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:371\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithEmptyBody.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithEmptyBody\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:665\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.170+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"566a308468780ef808293001ed6b4810","trace_id":"566a308468780ef808293001ed6b4810","span_id":"87f1f184810c7d07","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"566a308468780ef808293001ed6b4810","trace_id":"566a308468780ef808293001ed6b4810","span_id":"87f1f184810c7d07","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000057416}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.170+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"566a308468780ef808293001ed6b4810","trace_id":"566a308468780ef808293001ed6b4810","span_id":"87f1f184810c7d07","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithEmptyBody.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_CreateOneTimeToken_WithEmptyBody\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:665\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_CreateOneTimeToken_WithEmptyBody (0.00s)
=== RUN   TestOAuthHandler_VerifyOneTimeToken_WithAllFields
{"level":"INFO","timestamp":"2025-06-26T01:18:54.170+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"d678226903b1a77bbb881ff8bca91cfd","trace_id":"d678226903b1a77bbb881ff8bca91cfd","span_id":"8e8ce8187f5111ce","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"d678226903b1a77bbb881ff8bca91cfd","trace_id":"d678226903b1a77bbb881ff8bca91cfd","span_id":"8e8ce8187f5111ce","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.170+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"d678226903b1a77bbb881ff8bca91cfd","trace_id":"d678226903b1a77bbb881ff8bca91cfd","span_id":"8e8ce8187f5111ce","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.170+0530","caller":"rest/oauth_handler.go:488","message":"One-time token verification validation passed","request_id":"d678226903b1a77bbb881ff8bca91cfd","trace_id":"d678226903b1a77bbb881ff8bca91cfd","span_id":"8e8ce8187f5111ce","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","token_prefix":"one-time-t...","session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.181+0530","caller":"rest/oauth_handler.go:542","message":"Business event","request_id":"d678226903b1a77bbb881ff8bca91cfd","trace_id":"d678226903b1a77bbb881ff8bca91cfd","span_id":"8e8ce8187f5111ce","event_type":"one_time_token_verified","user_id":"anonymous-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","is_valid":true,"duration_ms":11}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.181+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"d678226903b1a77bbb881ff8bca91cfd","trace_id":"d678226903b1a77bbb881ff8bca91cfd","span_id":"8e8ce8187f5111ce","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"d678226903b1a77bbb881ff8bca91cfd","trace_id":"d678226903b1a77bbb881ff8bca91cfd","span_id":"8e8ce8187f5111ce","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.011096708}
--- PASS: TestOAuthHandler_VerifyOneTimeToken_WithAllFields (0.01s)
=== RUN   TestOAuthHandler_VerifyOneTimeToken_WithMissingSessionID
{"level":"INFO","timestamp":"2025-06-26T01:18:54.181+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"eb3196994bf9c3a61c649f83fd0b76e9","trace_id":"eb3196994bf9c3a61c649f83fd0b76e9","span_id":"57477af95227228d","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"eb3196994bf9c3a61c649f83fd0b76e9","trace_id":"eb3196994bf9c3a61c649f83fd0b76e9","span_id":"57477af95227228d","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.181+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"eb3196994bf9c3a61c649f83fd0b76e9","trace_id":"eb3196994bf9c3a61c649f83fd0b76e9","span_id":"57477af95227228d","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.181+0530","caller":"rest/oauth_handler.go:479","message":"One-time token verification failed - missing session ID","request_id":"eb3196994bf9c3a61c649f83fd0b76e9","trace_id":"eb3196994bf9c3a61c649f83fd0b76e9","span_id":"57477af95227228d","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).VerifyOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:479\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithMissingSessionID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithMissingSessionID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:723\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.182+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"eb3196994bf9c3a61c649f83fd0b76e9","trace_id":"eb3196994bf9c3a61c649f83fd0b76e9","span_id":"57477af95227228d","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"eb3196994bf9c3a61c649f83fd0b76e9","trace_id":"eb3196994bf9c3a61c649f83fd0b76e9","span_id":"57477af95227228d","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000252042}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.182+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"eb3196994bf9c3a61c649f83fd0b76e9","trace_id":"eb3196994bf9c3a61c649f83fd0b76e9","span_id":"57477af95227228d","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithMissingSessionID.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithMissingSessionID\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:723\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_VerifyOneTimeToken_WithMissingSessionID (0.00s)
=== RUN   TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken
{"level":"INFO","timestamp":"2025-06-26T01:18:54.182+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"079690dbae335439026e8c821c83beb6","trace_id":"079690dbae335439026e8c821c83beb6","span_id":"f6092c6cb21637dc","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"079690dbae335439026e8c821c83beb6","trace_id":"079690dbae335439026e8c821c83beb6","span_id":"f6092c6cb21637dc","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.182+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"079690dbae335439026e8c821c83beb6","trace_id":"079690dbae335439026e8c821c83beb6","span_id":"f6092c6cb21637dc","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.182+0530","caller":"rest/oauth_handler.go:488","message":"One-time token verification validation passed","request_id":"079690dbae335439026e8c821c83beb6","trace_id":"079690dbae335439026e8c821c83beb6","span_id":"f6092c6cb21637dc","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","token_prefix":"invalid-to...","session_id":"invalid-session"}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.192+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"079690dbae335439026e8c821c83beb6","trace_id":"079690dbae335439026e8c821c83beb6","span_id":"f6092c6cb21637dc","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"079690dbae335439026e8c821c83beb6","trace_id":"079690dbae335439026e8c821c83beb6","span_id":"f6092c6cb21637dc","user_id":"","tenant_id":"","auth_method":"one_time_token","reason":"invalid_token","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).VerifyOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:513\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:750\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.192+0530","caller":"rest/oauth_handler.go:514","message":"One-time token verification failed - invalid token or session","request_id":"079690dbae335439026e8c821c83beb6","trace_id":"079690dbae335439026e8c821c83beb6","span_id":"f6092c6cb21637dc","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).VerifyOneTimeToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:514\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:750\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.192+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"079690dbae335439026e8c821c83beb6","trace_id":"079690dbae335439026e8c821c83beb6","span_id":"f6092c6cb21637dc","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"079690dbae335439026e8c821c83beb6","trace_id":"079690dbae335439026e8c821c83beb6","span_id":"f6092c6cb21637dc","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":401,"duration":0.010383208}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.192+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"079690dbae335439026e8c821c83beb6","trace_id":"079690dbae335439026e8c821c83beb6","span_id":"f6092c6cb21637dc","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:750\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_VerifyOneTimeToken_WithInvalidToken (0.01s)
=== RUN   TestOAuthHandler_RefreshSession_WithAllFields
{"level":"INFO","timestamp":"2025-06-26T01:18:54.192+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"f8ca24eda7b02359252768e1734e6554","trace_id":"f8ca24eda7b02359252768e1734e6554","span_id":"eeba72e2f33a0c14","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"f8ca24eda7b02359252768e1734e6554","trace_id":"f8ca24eda7b02359252768e1734e6554","span_id":"eeba72e2f33a0c14","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.192+0530","caller":"rest/oauth_handler.go:580","message":"Session refresh initiated","request_id":"f8ca24eda7b02359252768e1734e6554","trace_id":"f8ca24eda7b02359252768e1734e6554","span_id":"eeba72e2f33a0c14","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/oauth/refresh","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.192+0530","caller":"rest/oauth_handler.go:598","message":"Session refresh validation passed","request_id":"f8ca24eda7b02359252768e1734e6554","trace_id":"f8ca24eda7b02359252768e1734e6554","span_id":"eeba72e2f33a0c14","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","token_prefix":"one-time-t...","session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.201+0530","caller":"rest/oauth_handler.go:637","message":"Business event","request_id":"f8ca24eda7b02359252768e1734e6554","trace_id":"f8ca24eda7b02359252768e1734e6554","span_id":"eeba72e2f33a0c14","event_type":"session_refreshed","user_id":"anonymous-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","duration_ms":9}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.201+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"f8ca24eda7b02359252768e1734e6554","trace_id":"f8ca24eda7b02359252768e1734e6554","span_id":"eeba72e2f33a0c14","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"f8ca24eda7b02359252768e1734e6554","trace_id":"f8ca24eda7b02359252768e1734e6554","span_id":"eeba72e2f33a0c14","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.009124667}
--- PASS: TestOAuthHandler_RefreshSession_WithAllFields (0.01s)
=== RUN   TestOAuthHandler_RefreshSession_WithInvalidJSON
{"level":"INFO","timestamp":"2025-06-26T01:18:54.201+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"3a9c169e63b2de40d5096fb4e3c4a8fc","trace_id":"3a9c169e63b2de40d5096fb4e3c4a8fc","span_id":"274ec8a050e9d58c","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"3a9c169e63b2de40d5096fb4e3c4a8fc","trace_id":"3a9c169e63b2de40d5096fb4e3c4a8fc","span_id":"274ec8a050e9d58c","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.201+0530","caller":"rest/oauth_handler.go:580","message":"Session refresh initiated","request_id":"3a9c169e63b2de40d5096fb4e3c4a8fc","trace_id":"3a9c169e63b2de40d5096fb4e3c4a8fc","span_id":"274ec8a050e9d58c","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/oauth/refresh","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.201+0530","caller":"rest/oauth_handler.go:589","message":"Session refresh failed - missing parameters","request_id":"3a9c169e63b2de40d5096fb4e3c4a8fc","trace_id":"3a9c169e63b2de40d5096fb4e3c4a8fc","span_id":"274ec8a050e9d58c","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).RefreshSession\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:589\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithInvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithInvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:810\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.201+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"3a9c169e63b2de40d5096fb4e3c4a8fc","trace_id":"3a9c169e63b2de40d5096fb4e3c4a8fc","span_id":"274ec8a050e9d58c","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"3a9c169e63b2de40d5096fb4e3c4a8fc","trace_id":"3a9c169e63b2de40d5096fb4e3c4a8fc","span_id":"274ec8a050e9d58c","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000054458}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.201+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"3a9c169e63b2de40d5096fb4e3c4a8fc","trace_id":"3a9c169e63b2de40d5096fb4e3c4a8fc","span_id":"274ec8a050e9d58c","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":33,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithInvalidJSON.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithInvalidJSON\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:810\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_RefreshSession_WithInvalidJSON (0.00s)
=== RUN   TestOAuthHandler_RefreshSession_WithEmptyBody
{"level":"INFO","timestamp":"2025-06-26T01:18:54.201+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"5307e4abb947e2419b20dcf42d2df56b","trace_id":"5307e4abb947e2419b20dcf42d2df56b","span_id":"9ce84022f9decfd5","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"5307e4abb947e2419b20dcf42d2df56b","trace_id":"5307e4abb947e2419b20dcf42d2df56b","span_id":"9ce84022f9decfd5","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.201+0530","caller":"rest/oauth_handler.go:580","message":"Session refresh initiated","request_id":"5307e4abb947e2419b20dcf42d2df56b","trace_id":"5307e4abb947e2419b20dcf42d2df56b","span_id":"9ce84022f9decfd5","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/oauth/refresh","method":"POST"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.201+0530","caller":"rest/oauth_handler.go:589","message":"Session refresh failed - missing parameters","request_id":"5307e4abb947e2419b20dcf42d2df56b","trace_id":"5307e4abb947e2419b20dcf42d2df56b","span_id":"9ce84022f9decfd5","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/handler/rest.(*OAuthHandler).RefreshSession\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:589\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithEmptyBody.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithEmptyBody\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:837\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.201+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"5307e4abb947e2419b20dcf42d2df56b","trace_id":"5307e4abb947e2419b20dcf42d2df56b","span_id":"9ce84022f9decfd5","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"5307e4abb947e2419b20dcf42d2df56b","trace_id":"5307e4abb947e2419b20dcf42d2df56b","span_id":"9ce84022f9decfd5","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000043667}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.201+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"5307e4abb947e2419b20dcf42d2df56b","trace_id":"5307e4abb947e2419b20dcf42d2df56b","span_id":"9ce84022f9decfd5","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithEmptyBody.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_RefreshSession_WithEmptyBody\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:837\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_RefreshSession_WithEmptyBody (0.00s)
=== RUN   TestOAuthHandler_ClientCredentials_WithScope
{"level":"INFO","timestamp":"2025-06-26T01:18:54.202+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"3af9041b3e280c34feeb75a9dda59129","trace_id":"3af9041b3e280c34feeb75a9dda59129","span_id":"1230d5894642f83d","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"3af9041b3e280c34feeb75a9dda59129","trace_id":"3af9041b3e280c34feeb75a9dda59129","span_id":"1230d5894642f83d","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.202+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"3af9041b3e280c34feeb75a9dda59129","trace_id":"3af9041b3e280c34feeb75a9dda59129","span_id":"1230d5894642f83d","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.202+0530","caller":"rest/oauth_handler.go:277","message":"Client credentials validation passed","request_id":"3af9041b3e280c34feeb75a9dda59129","trace_id":"3af9041b3e280c34feeb75a9dda59129","span_id":"1230d5894642f83d","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","client_id":"test-client-id","grant_type":"client_credentials","scope":"read:users write:users"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.223+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"3af9041b3e280c34feeb75a9dda59129","trace_id":"3af9041b3e280c34feeb75a9dda59129","span_id":"1230d5894642f83d","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"3af9041b3e280c34feeb75a9dda59129","trace_id":"3af9041b3e280c34feeb75a9dda59129","span_id":"1230d5894642f83d","user_id":"test-client-id","tenant_id":"","auth_method":"client_credentials","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.223+0530","caller":"rest/oauth_handler.go:310","message":"Business event","request_id":"3af9041b3e280c34feeb75a9dda59129","trace_id":"3af9041b3e280c34feeb75a9dda59129","span_id":"1230d5894642f83d","event_type":"client_credentials_success","user_id":"test-client-id","tenant_id":"","client_ip":"192.0.2.1:1234","scope":"read:users write:users","duration_ms":21}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.223+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"3af9041b3e280c34feeb75a9dda59129","trace_id":"3af9041b3e280c34feeb75a9dda59129","span_id":"1230d5894642f83d","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"3af9041b3e280c34feeb75a9dda59129","trace_id":"3af9041b3e280c34feeb75a9dda59129","span_id":"1230d5894642f83d","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.02113675}
--- PASS: TestOAuthHandler_ClientCredentials_WithScope (0.02s)
=== RUN   TestOAuthHandler_ClientCredentials_WithoutScope
{"level":"INFO","timestamp":"2025-06-26T01:18:54.223+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"6042c4fedfd871b6abd2993ce22d27b8","trace_id":"6042c4fedfd871b6abd2993ce22d27b8","span_id":"b7606abb001d035d","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"6042c4fedfd871b6abd2993ce22d27b8","trace_id":"6042c4fedfd871b6abd2993ce22d27b8","span_id":"b7606abb001d035d","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.223+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"6042c4fedfd871b6abd2993ce22d27b8","trace_id":"6042c4fedfd871b6abd2993ce22d27b8","span_id":"b7606abb001d035d","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.223+0530","caller":"rest/oauth_handler.go:277","message":"Client credentials validation passed","request_id":"6042c4fedfd871b6abd2993ce22d27b8","trace_id":"6042c4fedfd871b6abd2993ce22d27b8","span_id":"b7606abb001d035d","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","client_id":"test-client-id","grant_type":"client_credentials","scope":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.244+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"6042c4fedfd871b6abd2993ce22d27b8","trace_id":"6042c4fedfd871b6abd2993ce22d27b8","span_id":"b7606abb001d035d","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"6042c4fedfd871b6abd2993ce22d27b8","trace_id":"6042c4fedfd871b6abd2993ce22d27b8","span_id":"b7606abb001d035d","user_id":"test-client-id","tenant_id":"","auth_method":"client_credentials","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.244+0530","caller":"rest/oauth_handler.go:310","message":"Business event","request_id":"6042c4fedfd871b6abd2993ce22d27b8","trace_id":"6042c4fedfd871b6abd2993ce22d27b8","span_id":"b7606abb001d035d","event_type":"client_credentials_success","user_id":"test-client-id","tenant_id":"","client_ip":"192.0.2.1:1234","scope":"","duration_ms":21}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.244+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"6042c4fedfd871b6abd2993ce22d27b8","trace_id":"6042c4fedfd871b6abd2993ce22d27b8","span_id":"b7606abb001d035d","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"6042c4fedfd871b6abd2993ce22d27b8","trace_id":"6042c4fedfd871b6abd2993ce22d27b8","span_id":"b7606abb001d035d","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.02115025}
--- PASS: TestOAuthHandler_ClientCredentials_WithoutScope (0.02s)
=== RUN   TestOAuthHandler_ClientCredentials_WithEmptyScope
{"level":"INFO","timestamp":"2025-06-26T01:18:54.244+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"0f6e815046c1850b8cdf0906b524aa57","trace_id":"0f6e815046c1850b8cdf0906b524aa57","span_id":"da7360886cf50e8c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"0f6e815046c1850b8cdf0906b524aa57","trace_id":"0f6e815046c1850b8cdf0906b524aa57","span_id":"da7360886cf50e8c","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.244+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"0f6e815046c1850b8cdf0906b524aa57","trace_id":"0f6e815046c1850b8cdf0906b524aa57","span_id":"da7360886cf50e8c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.244+0530","caller":"rest/oauth_handler.go:277","message":"Client credentials validation passed","request_id":"0f6e815046c1850b8cdf0906b524aa57","trace_id":"0f6e815046c1850b8cdf0906b524aa57","span_id":"da7360886cf50e8c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","client_id":"test-client-id","grant_type":"client_credentials","scope":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.265+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"0f6e815046c1850b8cdf0906b524aa57","trace_id":"0f6e815046c1850b8cdf0906b524aa57","span_id":"da7360886cf50e8c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"0f6e815046c1850b8cdf0906b524aa57","trace_id":"0f6e815046c1850b8cdf0906b524aa57","span_id":"da7360886cf50e8c","user_id":"test-client-id","tenant_id":"","auth_method":"client_credentials","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.265+0530","caller":"rest/oauth_handler.go:310","message":"Business event","request_id":"0f6e815046c1850b8cdf0906b524aa57","trace_id":"0f6e815046c1850b8cdf0906b524aa57","span_id":"da7360886cf50e8c","event_type":"client_credentials_success","user_id":"test-client-id","tenant_id":"","client_ip":"192.0.2.1:1234","duration_ms":21,"scope":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.265+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"0f6e815046c1850b8cdf0906b524aa57","trace_id":"0f6e815046c1850b8cdf0906b524aa57","span_id":"da7360886cf50e8c","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"0f6e815046c1850b8cdf0906b524aa57","trace_id":"0f6e815046c1850b8cdf0906b524aa57","span_id":"da7360886cf50e8c","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.021132459}
--- PASS: TestOAuthHandler_ClientCredentials_WithEmptyScope (0.02s)
=== RUN   TestOAuthHandler_GoogleLogin_WithEmptyRedirectURI
{"level":"INFO","timestamp":"2025-06-26T01:18:54.265+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"7900008b6af29197a770b5dc0b45cbba","trace_id":"7900008b6af29197a770b5dc0b45cbba","span_id":"8d5615618efecebb","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"7900008b6af29197a770b5dc0b45cbba","trace_id":"7900008b6af29197a770b5dc0b45cbba","span_id":"8d5615618efecebb","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.265+0530","caller":"rest/oauth_handler.go:65","message":"Google OAuth login initiated","request_id":"7900008b6af29197a770b5dc0b45cbba","trace_id":"7900008b6af29197a770b5dc0b45cbba","span_id":"8d5615618efecebb","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/login","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.265+0530","caller":"rest/oauth_handler.go:84","message":"Google OAuth login validation passed","request_id":"7900008b6af29197a770b5dc0b45cbba","trace_id":"7900008b6af29197a770b5dc0b45cbba","span_id":"8d5615618efecebb","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","tenant_id":"tenant-123","redirect_uri":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.265+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"7900008b6af29197a770b5dc0b45cbba","trace_id":"7900008b6af29197a770b5dc0b45cbba","span_id":"8d5615618efecebb","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"7900008b6af29197a770b5dc0b45cbba","trace_id":"7900008b6af29197a770b5dc0b45cbba","span_id":"8d5615618efecebb","provider":"google","step":"login_initiated","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.265+0530","caller":"rest/oauth_handler.go:101","message":"Business event","request_id":"7900008b6af29197a770b5dc0b45cbba","trace_id":"7900008b6af29197a770b5dc0b45cbba","span_id":"8d5615618efecebb","event_type":"oauth_login_initiated","user_id":"","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","redirect_uri":"http://localhost:8080/api/v1/oauth/google/callback","duration_ms":0,"provider":"google"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.265+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"7900008b6af29197a770b5dc0b45cbba","trace_id":"7900008b6af29197a770b5dc0b45cbba","span_id":"8d5615618efecebb","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"7900008b6af29197a770b5dc0b45cbba","trace_id":"7900008b6af29197a770b5dc0b45cbba","span_id":"8d5615618efecebb","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.000070334}
--- PASS: TestOAuthHandler_GoogleLogin_WithEmptyRedirectURI (0.00s)
=== RUN   TestOAuthHandler_GoogleCallback_WithEmptyState
{"level":"INFO","timestamp":"2025-06-26T01:18:54.265+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"58077263d1ff707caac56b20b8ea066b","trace_id":"58077263d1ff707caac56b20b8ea066b","span_id":"d1ca1d5bf79701e9","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"58077263d1ff707caac56b20b8ea066b","trace_id":"58077263d1ff707caac56b20b8ea066b","span_id":"d1ca1d5bf79701e9","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.265+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"58077263d1ff707caac56b20b8ea066b","trace_id":"58077263d1ff707caac56b20b8ea066b","span_id":"d1ca1d5bf79701e9","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.265+0530","caller":"rest/oauth_handler.go:174","message":"Google OAuth callback validation passed","request_id":"58077263d1ff707caac56b20b8ea066b","trace_id":"58077263d1ff707caac56b20b8ea066b","span_id":"d1ca1d5bf79701e9","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","tenant_id":"","code_prefix":"test-auth-..."}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.316+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"58077263d1ff707caac56b20b8ea066b","trace_id":"58077263d1ff707caac56b20b8ea066b","span_id":"d1ca1d5bf79701e9","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"58077263d1ff707caac56b20b8ea066b","trace_id":"58077263d1ff707caac56b20b8ea066b","span_id":"d1ca1d5bf79701e9","user_id":"google-user-123","tenant_id":"","auth_method":"google_oauth","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.316+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"58077263d1ff707caac56b20b8ea066b","trace_id":"58077263d1ff707caac56b20b8ea066b","span_id":"d1ca1d5bf79701e9","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"58077263d1ff707caac56b20b8ea066b","trace_id":"58077263d1ff707caac56b20b8ea066b","span_id":"d1ca1d5bf79701e9","provider":"google","step":"callback_success","tenant_id":"","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.316+0530","caller":"rest/oauth_handler.go:209","message":"Business event","request_id":"58077263d1ff707caac56b20b8ea066b","trace_id":"58077263d1ff707caac56b20b8ea066b","span_id":"d1ca1d5bf79701e9","event_type":"oauth_login_completed","user_id":"google-user-123","tenant_id":"","client_ip":"192.0.2.1:1234","provider":"google","duration_ms":51}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.317+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"58077263d1ff707caac56b20b8ea066b","trace_id":"58077263d1ff707caac56b20b8ea066b","span_id":"d1ca1d5bf79701e9","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"58077263d1ff707caac56b20b8ea066b","trace_id":"58077263d1ff707caac56b20b8ea066b","span_id":"d1ca1d5bf79701e9","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.051105792}
--- PASS: TestOAuthHandler_GoogleCallback_WithEmptyState (0.05s)
=== RUN   TestOAuthHandler_GoogleCallback_WithOnlyCode
{"level":"INFO","timestamp":"2025-06-26T01:18:54.317+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"5e703865924d6e2b12034f8178a52038","trace_id":"5e703865924d6e2b12034f8178a52038","span_id":"677d9d6a680f062f","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"5e703865924d6e2b12034f8178a52038","trace_id":"5e703865924d6e2b12034f8178a52038","span_id":"677d9d6a680f062f","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.317+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"5e703865924d6e2b12034f8178a52038","trace_id":"5e703865924d6e2b12034f8178a52038","span_id":"677d9d6a680f062f","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.317+0530","caller":"rest/oauth_handler.go:174","message":"Google OAuth callback validation passed","request_id":"5e703865924d6e2b12034f8178a52038","trace_id":"5e703865924d6e2b12034f8178a52038","span_id":"677d9d6a680f062f","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","tenant_id":"","code_prefix":"test-auth-..."}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.367+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"5e703865924d6e2b12034f8178a52038","trace_id":"5e703865924d6e2b12034f8178a52038","span_id":"677d9d6a680f062f","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"5e703865924d6e2b12034f8178a52038","trace_id":"5e703865924d6e2b12034f8178a52038","span_id":"677d9d6a680f062f","user_id":"google-user-123","tenant_id":"","auth_method":"google_oauth","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.367+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"5e703865924d6e2b12034f8178a52038","trace_id":"5e703865924d6e2b12034f8178a52038","span_id":"677d9d6a680f062f","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"5e703865924d6e2b12034f8178a52038","trace_id":"5e703865924d6e2b12034f8178a52038","span_id":"677d9d6a680f062f","provider":"google","step":"callback_success","tenant_id":"","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.367+0530","caller":"rest/oauth_handler.go:209","message":"Business event","request_id":"5e703865924d6e2b12034f8178a52038","trace_id":"5e703865924d6e2b12034f8178a52038","span_id":"677d9d6a680f062f","event_type":"oauth_login_completed","user_id":"google-user-123","tenant_id":"","client_ip":"192.0.2.1:1234","duration_ms":50,"provider":"google"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.367+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"5e703865924d6e2b12034f8178a52038","trace_id":"5e703865924d6e2b12034f8178a52038","span_id":"677d9d6a680f062f","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"5e703865924d6e2b12034f8178a52038","trace_id":"5e703865924d6e2b12034f8178a52038","span_id":"677d9d6a680f062f","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.050293208}
--- PASS: TestOAuthHandler_GoogleCallback_WithOnlyCode (0.05s)
=== RUN   TestOAuthHandler_GoogleCallback_WithOnlyError
{"level":"INFO","timestamp":"2025-06-26T01:18:54.367+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"e2bd73b68713dda72066c504714268fd","trace_id":"e2bd73b68713dda72066c504714268fd","span_id":"2a88bc2bb989cfc2","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"e2bd73b68713dda72066c504714268fd","trace_id":"e2bd73b68713dda72066c504714268fd","span_id":"2a88bc2bb989cfc2","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.367+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"e2bd73b68713dda72066c504714268fd","trace_id":"e2bd73b68713dda72066c504714268fd","span_id":"2a88bc2bb989cfc2","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.367+0530","caller":"logger/logger.go:199","message":"Authentication failed","request_id":"e2bd73b68713dda72066c504714268fd","trace_id":"e2bd73b68713dda72066c504714268fd","span_id":"2a88bc2bb989cfc2","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"e2bd73b68713dda72066c504714268fd","trace_id":"e2bd73b68713dda72066c504714268fd","span_id":"2a88bc2bb989cfc2","user_id":"","tenant_id":"","auth_method":"google_oauth","reason":"oauth_error","client_ip":"192.0.2.1:1234","stacktrace":"auth-service/internal/logger.(*RequestLogger).AuthFailure\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:199\nauth-service/internal/handler/rest.(*OAuthHandler).GoogleCallback\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:153\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_WithOnlyError.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_WithOnlyError\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:1063\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"ERROR","timestamp":"2025-06-26T01:18:54.367+0530","caller":"logger/logger.go:225","message":"OAuth flow failed","request_id":"e2bd73b68713dda72066c504714268fd","trace_id":"e2bd73b68713dda72066c504714268fd","span_id":"2a88bc2bb989cfc2","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"e2bd73b68713dda72066c504714268fd","trace_id":"e2bd73b68713dda72066c504714268fd","span_id":"2a88bc2bb989cfc2","provider":"google","step":"callback_error","tenant_id":"","client_ip":"192.0.2.1:1234","error":"oauth error: access_denied","stacktrace":"auth-service/internal/logger.(*RequestLogger).OAuthFlow\n\t/Users/Licious/Desktop/repository/auth-service/internal/logger/logger.go:225\nauth-service/internal/handler/rest.(*OAuthHandler).GoogleCallback\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler.go:154\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_WithOnlyError.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:27\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_WithOnlyError\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:1063\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.367+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"e2bd73b68713dda72066c504714268fd","trace_id":"e2bd73b68713dda72066c504714268fd","span_id":"2a88bc2bb989cfc2","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"e2bd73b68713dda72066c504714268fd","trace_id":"e2bd73b68713dda72066c504714268fd","span_id":"2a88bc2bb989cfc2","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":400,"duration":0.000181583}
{"level":"WARN","timestamp":"2025-06-26T01:18:54.367+0530","caller":"middleware/logging_middleware.go:54","message":"Request resulted in error status","request_id":"e2bd73b68713dda72066c504714268fd","trace_id":"e2bd73b68713dda72066c504714268fd","span_id":"2a88bc2bb989cfc2","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_agent":"","referer":"","content_length":0,"stacktrace":"auth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_WithOnlyError.LoggingMiddleware.func1\n\t/Users/Licious/Desktop/repository/auth-service/internal/middleware/logging_middleware.go:54\ngithub.com/gin-gonic/gin.(*Context).Next\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/context.go:174\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:620\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP\n\t/Users/Licious/go/pkg/mod/github.com/gin-gonic/gin@v1.9.1/gin.go:576\nauth-service/internal/handler/rest.TestOAuthHandler_GoogleCallback_WithOnlyError\n\t/Users/Licious/Desktop/repository/auth-service/internal/handler/rest/oauth_handler_test.go:1063\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1690"}
--- PASS: TestOAuthHandler_GoogleCallback_WithOnlyError (0.00s)
=== RUN   TestOAuthHandler_Integration
=== RUN   TestOAuthHandler_Integration/GoogleLogin
{"level":"INFO","timestamp":"2025-06-26T01:18:54.367+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"69745e41e9a8c2f819f1884bf9bb0f56","trace_id":"69745e41e9a8c2f819f1884bf9bb0f56","span_id":"71692e64dd8abf44","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"69745e41e9a8c2f819f1884bf9bb0f56","trace_id":"69745e41e9a8c2f819f1884bf9bb0f56","span_id":"71692e64dd8abf44","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.367+0530","caller":"rest/oauth_handler.go:65","message":"Google OAuth login initiated","request_id":"69745e41e9a8c2f819f1884bf9bb0f56","trace_id":"69745e41e9a8c2f819f1884bf9bb0f56","span_id":"71692e64dd8abf44","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/login","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.367+0530","caller":"rest/oauth_handler.go:84","message":"Google OAuth login validation passed","request_id":"69745e41e9a8c2f819f1884bf9bb0f56","trace_id":"69745e41e9a8c2f819f1884bf9bb0f56","span_id":"71692e64dd8abf44","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","tenant_id":"tenant-123","redirect_uri":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.367+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"69745e41e9a8c2f819f1884bf9bb0f56","trace_id":"69745e41e9a8c2f819f1884bf9bb0f56","span_id":"71692e64dd8abf44","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"69745e41e9a8c2f819f1884bf9bb0f56","trace_id":"69745e41e9a8c2f819f1884bf9bb0f56","span_id":"71692e64dd8abf44","provider":"google","step":"login_initiated","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.367+0530","caller":"rest/oauth_handler.go:101","message":"Business event","request_id":"69745e41e9a8c2f819f1884bf9bb0f56","trace_id":"69745e41e9a8c2f819f1884bf9bb0f56","span_id":"71692e64dd8abf44","event_type":"oauth_login_initiated","user_id":"","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","provider":"google","redirect_uri":"http://localhost:8080/api/v1/oauth/google/callback","duration_ms":0}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.367+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"69745e41e9a8c2f819f1884bf9bb0f56","trace_id":"69745e41e9a8c2f819f1884bf9bb0f56","span_id":"71692e64dd8abf44","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","request_id":"69745e41e9a8c2f819f1884bf9bb0f56","trace_id":"69745e41e9a8c2f819f1884bf9bb0f56","span_id":"71692e64dd8abf44","parent_span_id":"","method":"GET","path":"/google/login","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.000057292}
=== RUN   TestOAuthHandler_Integration/GoogleCallback
{"level":"INFO","timestamp":"2025-06-26T01:18:54.368+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"d72e9e4c6d14cd2a0814ffafea49afa5","trace_id":"d72e9e4c6d14cd2a0814ffafea49afa5","span_id":"2bee67ef386b3541","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"d72e9e4c6d14cd2a0814ffafea49afa5","trace_id":"d72e9e4c6d14cd2a0814ffafea49afa5","span_id":"2bee67ef386b3541","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.368+0530","caller":"rest/oauth_handler.go:143","message":"Google OAuth callback received","request_id":"d72e9e4c6d14cd2a0814ffafea49afa5","trace_id":"d72e9e4c6d14cd2a0814ffafea49afa5","span_id":"2bee67ef386b3541","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","endpoint":"/oauth/google/callback","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.368+0530","caller":"rest/oauth_handler.go:174","message":"Google OAuth callback validation passed","request_id":"d72e9e4c6d14cd2a0814ffafea49afa5","trace_id":"d72e9e4c6d14cd2a0814ffafea49afa5","span_id":"2bee67ef386b3541","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","tenant_id":"tenant-123","code_prefix":"test-code..."}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.419+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"d72e9e4c6d14cd2a0814ffafea49afa5","trace_id":"d72e9e4c6d14cd2a0814ffafea49afa5","span_id":"2bee67ef386b3541","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"d72e9e4c6d14cd2a0814ffafea49afa5","trace_id":"d72e9e4c6d14cd2a0814ffafea49afa5","span_id":"2bee67ef386b3541","user_id":"google-user-123","tenant_id":"tenant-123","auth_method":"google_oauth","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.419+0530","caller":"logger/logger.go:227","message":"OAuth flow step completed","request_id":"d72e9e4c6d14cd2a0814ffafea49afa5","trace_id":"d72e9e4c6d14cd2a0814ffafea49afa5","span_id":"2bee67ef386b3541","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"d72e9e4c6d14cd2a0814ffafea49afa5","trace_id":"d72e9e4c6d14cd2a0814ffafea49afa5","span_id":"2bee67ef386b3541","provider":"google","step":"callback_success","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.419+0530","caller":"rest/oauth_handler.go:209","message":"Business event","request_id":"d72e9e4c6d14cd2a0814ffafea49afa5","trace_id":"d72e9e4c6d14cd2a0814ffafea49afa5","span_id":"2bee67ef386b3541","event_type":"oauth_login_completed","user_id":"google-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","provider":"google","duration_ms":51}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.419+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"d72e9e4c6d14cd2a0814ffafea49afa5","trace_id":"d72e9e4c6d14cd2a0814ffafea49afa5","span_id":"2bee67ef386b3541","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","request_id":"d72e9e4c6d14cd2a0814ffafea49afa5","trace_id":"d72e9e4c6d14cd2a0814ffafea49afa5","span_id":"2bee67ef386b3541","parent_span_id":"","method":"GET","path":"/google/callback","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.051264458}
=== RUN   TestOAuthHandler_Integration/ClientCredentials
{"level":"INFO","timestamp":"2025-06-26T01:18:54.419+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"a9602eb4516d44332835d9d5af74bc8b","trace_id":"a9602eb4516d44332835d9d5af74bc8b","span_id":"4412ea3bd6636bb8","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"a9602eb4516d44332835d9d5af74bc8b","trace_id":"a9602eb4516d44332835d9d5af74bc8b","span_id":"4412ea3bd6636bb8","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.419+0530","caller":"rest/oauth_handler.go:261","message":"Client credentials flow initiated","request_id":"a9602eb4516d44332835d9d5af74bc8b","trace_id":"a9602eb4516d44332835d9d5af74bc8b","span_id":"4412ea3bd6636bb8","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","endpoint":"/oauth/token","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.419+0530","caller":"rest/oauth_handler.go:277","message":"Client credentials validation passed","request_id":"a9602eb4516d44332835d9d5af74bc8b","trace_id":"a9602eb4516d44332835d9d5af74bc8b","span_id":"4412ea3bd6636bb8","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","client_id":"test-client-id","grant_type":"client_credentials","scope":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.440+0530","caller":"logger/logger.go:186","message":"Authentication successful","request_id":"a9602eb4516d44332835d9d5af74bc8b","trace_id":"a9602eb4516d44332835d9d5af74bc8b","span_id":"4412ea3bd6636bb8","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"a9602eb4516d44332835d9d5af74bc8b","trace_id":"a9602eb4516d44332835d9d5af74bc8b","span_id":"4412ea3bd6636bb8","user_id":"test-client-id","tenant_id":"","auth_method":"client_credentials","client_ip":"192.0.2.1:1234"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.440+0530","caller":"rest/oauth_handler.go:310","message":"Business event","request_id":"a9602eb4516d44332835d9d5af74bc8b","trace_id":"a9602eb4516d44332835d9d5af74bc8b","span_id":"4412ea3bd6636bb8","event_type":"client_credentials_success","user_id":"test-client-id","tenant_id":"","client_ip":"192.0.2.1:1234","duration_ms":21,"scope":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.440+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"a9602eb4516d44332835d9d5af74bc8b","trace_id":"a9602eb4516d44332835d9d5af74bc8b","span_id":"4412ea3bd6636bb8","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","request_id":"a9602eb4516d44332835d9d5af74bc8b","trace_id":"a9602eb4516d44332835d9d5af74bc8b","span_id":"4412ea3bd6636bb8","parent_span_id":"","method":"POST","path":"/token","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.021313542}
=== RUN   TestOAuthHandler_Integration/CreateOneTimeToken
{"level":"INFO","timestamp":"2025-06-26T01:18:54.440+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"77ae03eff7a23e6dc6c8984c084ccb6b","trace_id":"77ae03eff7a23e6dc6c8984c084ccb6b","span_id":"d881bd9a85afdd76","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"77ae03eff7a23e6dc6c8984c084ccb6b","trace_id":"77ae03eff7a23e6dc6c8984c084ccb6b","span_id":"d881bd9a85afdd76","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.440+0530","caller":"rest/oauth_handler.go:364","message":"One-time token creation initiated","request_id":"77ae03eff7a23e6dc6c8984c084ccb6b","trace_id":"77ae03eff7a23e6dc6c8984c084ccb6b","span_id":"d881bd9a85afdd76","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","endpoint":"/oauth/one-time","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.440+0530","caller":"rest/oauth_handler.go:380","message":"One-time token validation passed","request_id":"77ae03eff7a23e6dc6c8984c084ccb6b","trace_id":"77ae03eff7a23e6dc6c8984c084ccb6b","span_id":"d881bd9a85afdd76","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","url":"https://app.example.com/survey/123","session_id":"survey-session-456","expires_in":0,"max_uses":0}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.456+0530","caller":"rest/oauth_handler.go:421","message":"Business event","request_id":"77ae03eff7a23e6dc6c8984c084ccb6b","trace_id":"77ae03eff7a23e6dc6c8984c084ccb6b","span_id":"d881bd9a85afdd76","event_type":"one_time_token_created","user_id":"","tenant_id":"","client_ip":"192.0.2.1:1234","max_uses":0,"duration_ms":16,"session_id":"survey-session-456","expires_in":0}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.457+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"77ae03eff7a23e6dc6c8984c084ccb6b","trace_id":"77ae03eff7a23e6dc6c8984c084ccb6b","span_id":"d881bd9a85afdd76","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","request_id":"77ae03eff7a23e6dc6c8984c084ccb6b","trace_id":"77ae03eff7a23e6dc6c8984c084ccb6b","span_id":"d881bd9a85afdd76","parent_span_id":"","method":"POST","path":"/one-time","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":201,"duration":0.016267208}
=== RUN   TestOAuthHandler_Integration/VerifyOneTimeToken
{"level":"INFO","timestamp":"2025-06-26T01:18:54.457+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"5b095caa7b5811e0cafe950b148db3ba","trace_id":"5b095caa7b5811e0cafe950b148db3ba","span_id":"b2fb21e4cc4157ce","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"5b095caa7b5811e0cafe950b148db3ba","trace_id":"5b095caa7b5811e0cafe950b148db3ba","span_id":"b2fb21e4cc4157ce","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.457+0530","caller":"rest/oauth_handler.go:460","message":"One-time token verification initiated","request_id":"5b095caa7b5811e0cafe950b148db3ba","trace_id":"5b095caa7b5811e0cafe950b148db3ba","span_id":"b2fb21e4cc4157ce","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","endpoint":"/oauth/verify","method":"GET"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.457+0530","caller":"rest/oauth_handler.go:488","message":"One-time token verification validation passed","request_id":"5b095caa7b5811e0cafe950b148db3ba","trace_id":"5b095caa7b5811e0cafe950b148db3ba","span_id":"b2fb21e4cc4157ce","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","token_prefix":"one-time-t...","session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.468+0530","caller":"rest/oauth_handler.go:542","message":"Business event","request_id":"5b095caa7b5811e0cafe950b148db3ba","trace_id":"5b095caa7b5811e0cafe950b148db3ba","span_id":"b2fb21e4cc4157ce","event_type":"one_time_token_verified","user_id":"anonymous-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","is_valid":true,"duration_ms":11}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.468+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"5b095caa7b5811e0cafe950b148db3ba","trace_id":"5b095caa7b5811e0cafe950b148db3ba","span_id":"b2fb21e4cc4157ce","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","request_id":"5b095caa7b5811e0cafe950b148db3ba","trace_id":"5b095caa7b5811e0cafe950b148db3ba","span_id":"b2fb21e4cc4157ce","parent_span_id":"","method":"GET","path":"/verify","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.011230417}
=== RUN   TestOAuthHandler_Integration/RefreshSession
{"level":"INFO","timestamp":"2025-06-26T01:18:54.468+0530","caller":"logger/logger.go:147","message":"Request started","request_id":"c2e387f9e5e5bb939fe82d20aa719f74","trace_id":"c2e387f9e5e5bb939fe82d20aa719f74","span_id":"e3b0afc55568cc47","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"c2e387f9e5e5bb939fe82d20aa719f74","trace_id":"c2e387f9e5e5bb939fe82d20aa719f74","span_id":"e3b0afc55568cc47","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":""}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.468+0530","caller":"rest/oauth_handler.go:580","message":"Session refresh initiated","request_id":"c2e387f9e5e5bb939fe82d20aa719f74","trace_id":"c2e387f9e5e5bb939fe82d20aa719f74","span_id":"e3b0afc55568cc47","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","endpoint":"/oauth/refresh","method":"POST"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.468+0530","caller":"rest/oauth_handler.go:598","message":"Session refresh validation passed","request_id":"c2e387f9e5e5bb939fe82d20aa719f74","trace_id":"c2e387f9e5e5bb939fe82d20aa719f74","span_id":"e3b0afc55568cc47","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","token_prefix":"one-time-t...","session_id":"survey-session-456"}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.476+0530","caller":"rest/oauth_handler.go:637","message":"Business event","request_id":"c2e387f9e5e5bb939fe82d20aa719f74","trace_id":"c2e387f9e5e5bb939fe82d20aa719f74","span_id":"e3b0afc55568cc47","event_type":"session_refreshed","user_id":"anonymous-user-123","tenant_id":"tenant-123","client_ip":"192.0.2.1:1234","session_id":"survey-session-456","duration_ms":8}
{"level":"INFO","timestamp":"2025-06-26T01:18:54.476+0530","caller":"logger/logger.go:180","message":"Request completed","request_id":"c2e387f9e5e5bb939fe82d20aa719f74","trace_id":"c2e387f9e5e5bb939fe82d20aa719f74","span_id":"e3b0afc55568cc47","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","request_id":"c2e387f9e5e5bb939fe82d20aa719f74","trace_id":"c2e387f9e5e5bb939fe82d20aa719f74","span_id":"e3b0afc55568cc47","parent_span_id":"","method":"POST","path":"/refresh","client_ip":"192.0.2.1:1234","user_id":"","tenant_id":"","status":200,"duration":0.00828675}
--- PASS: TestOAuthHandler_Integration (0.11s)
    --- PASS: TestOAuthHandler_Integration/GoogleLogin (0.00s)
    --- PASS: TestOAuthHandler_Integration/GoogleCallback (0.05s)
    --- PASS: TestOAuthHandler_Integration/ClientCredentials (0.02s)
    --- PASS: TestOAuthHandler_Integration/CreateOneTimeToken (0.02s)
    --- PASS: TestOAuthHandler_Integration/VerifyOneTimeToken (0.01s)
    --- PASS: TestOAuthHandler_Integration/RefreshSession (0.01s)
FAIL
FAIL	auth-service/internal/handler/rest	0.830s
FAIL
